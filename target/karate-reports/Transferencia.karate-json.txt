{"failedCount":25,"prefixedPath":"classpath:Transferencia.feature","packageQualifiedName":"Transferencia","loopIndex":-1,"relativePath":"Transferencia.feature","scenarioResults":[{"sectionIndex":0,"stepResults":[{"result":{"nanos":1754026400,"millis":1754.0264,"status":"passed"},"step":{"background":true,"line":5,"prefix":"*","index":0,"text":"def tokenContext = callonce read('classpath:helpers\/generate-token.feature')"},"stepLog":"14:14:18.092 << lock released, cached callonce: read('classpath:helpers\/generate-token.feature')\n","callResults":[{"failedCount":0,"prefixedPath":"classpath:helpers\/generate-token.feature","packageQualifiedName":"helpers.generate-token","loopIndex":-1,"relativePath":"helpers\/generate-token.feature","scenarioResults":[{"sectionIndex":0,"stepResults":[{"result":{"nanos":30859800,"millis":30.8598,"status":"passed"},"step":{"background":true,"line":4,"prefix":"*","index":0,"text":"def projectDir = karate.properties['karate.project.dir'] ? karate.properties['karate.project.dir'] : java.lang.System.getProperty('user.dir')"},"stepLog":"14:14:15.864 key store key count for classpath:certificado\/clientcert.cbiblian.internal 1.pfx: 1\n14:14:16.373 >> lock acquired, begin callonce: read('classpath:helpers\/generate-token.feature')\n14:14:16.415 key store key count for classpath:certificado\/clientcert.cbiblian.internal 1.pfx: 1\n"},{"result":{"nanos":12817200,"millis":12.8172,"status":"passed"},"step":{"background":true,"line":5,"prefix":"*","index":1,"text":"def Paths = Java.type('java.nio.file.Paths')"}},{"result":{"nanos":8550200,"millis":8.5502,"status":"passed"},"step":{"background":true,"line":6,"prefix":"*","index":2,"text":"def tokenDirectory = Paths.get(projectDir, 'target')"}},{"result":{"nanos":13698800,"millis":13.6988,"status":"passed"},"step":{"background":true,"line":7,"prefix":"*","index":3,"text":"def tokenTextPath = tokenDirectory.resolve('token.txt').toString()"}},{"result":{"nanos":4233100,"millis":4.2331,"status":"passed"},"step":{"background":true,"line":8,"prefix":"*","index":4,"text":"def tokenJsonPath = tokenDirectory.resolve('token-data.json').toString()"}},{"result":{"nanos":2943100,"millis":2.9431,"status":"passed"},"step":{"background":true,"line":9,"prefix":"*","index":5,"text":"def tokenResponsePath = tokenDirectory.resolve('token-response.json').toString()"}},{"result":{"nanos":1126200,"millis":1.1262,"status":"passed"},"step":{"comments":["# Solicita el token con grant client_credentials utilizando las credenciales QA."],"line":13,"prefix":"*","index":0,"text":"def clientId = '0205cb'"}},{"result":{"nanos":1221900,"millis":1.2219,"status":"passed"},"step":{"line":14,"prefix":"*","index":1,"text":"def clientSecret = 'iXaIz03uhylB2nG6jxTLz2QdHs37GbXn'"}},{"result":{"nanos":909800,"millis":0.9098,"status":"passed"},"step":{"line":15,"prefix":"Given","index":2,"text":"url 'https:\/\/autenticacionqa.coonecta.com.ec\/auth\/realms\/PANAPAY\/protocol\/openid-connect\/token'"}},{"result":{"nanos":801500,"millis":0.8015,"status":"passed"},"step":{"line":16,"prefix":"And","index":3,"text":"header Content-Type = 'application\/x-www-form-urlencoded'"}},{"result":{"nanos":180088600,"millis":180.0886,"status":"passed"},"step":{"line":17,"prefix":"And","index":4,"text":"form field grant_type = 'client_credentials'"}},{"result":{"nanos":1539700,"millis":1.5397,"status":"passed"},"step":{"line":18,"prefix":"And","index":5,"text":"form field client_id = clientId"}},{"result":{"nanos":616300,"millis":0.6163,"status":"passed"},"step":{"line":19,"prefix":"And","index":6,"text":"form field client_secret = clientSecret"}},{"result":{"nanos":858897100,"millis":858.8971,"status":"passed"},"step":{"line":20,"prefix":"When","index":7,"text":"method post"},"stepLog":"14:14:16.920 request:\n1 > POST https:\/\/autenticacionqa.coonecta.com.ec\/auth\/realms\/PANAPAY\/protocol\/openid-connect\/token\n1 > Content-Type: application\/x-www-form-urlencoded\n1 > Content-Length: 93\n1 > Host: autenticacionqa.coonecta.com.ec\n1 > Connection: Keep-Alive\n1 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/17.0.12)\n1 > Accept-Encoding: gzip,deflate\ngrant_type=client_credentials&client_id=0205cb&client_secret=iXaIz03uhylB2nG6jxTLz2QdHs37GbXn\n\n14:14:17.547 response time in milliseconds: 620\n1 < 200\n1 < Date: Wed, 22 Oct 2025 19:14:10 GMT\n1 < Content-Type: application\/json\n1 < Content-Length: 1492\n1 < Connection: keep-alive\n1 < Cache-Control: no-store\n1 < Pragma: no-cache\n1 < Referrer-Policy: no-referrer\n1 < Strict-Transport-Security: max-age=31536000; includeSubDomains\n1 < X-Content-Type-Options: nosniff\n{\"access_token\":\"eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2dUJWTkN6VlViUFBlTFdReEM0WDAyYVM3UnM2UGRYV1dja1dfc0xZMHlFIn0.eyJleHAiOjE3NjExNjA3NTAsImlhdCI6MTc2MTE2MDQ1MCwianRpIjoidHJydGNjOjQ5Yjg0NDVjLTgzYTAtMjI4Ni02NDczLWE2ZGEzOTBhOWQ0YSIsImlzcyI6Imh0dHBzOi8vYXV0ZW50aWNhY2lvbnFhLmNvb25lY3RhLmNvbS5lYy9hdXRoL3JlYWxtcy9QQU5BUEFZIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6Ijk5OGMyZmUwLTJjOGYtNGQwNC1iZjExLWY1OWExZTM5ODg3MyIsInR5cCI6IkJlYXJlciIsImF6cCI6IjAyMDVjYiIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiLyoiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRlZmF1bHQtcm9sZXMtYWRtaW5wYW5hcGF5Iiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7IjAyMDVjYiI6eyJyb2xlcyI6WyJ1bWFfcHJvdGVjdGlvbiJdfSwiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJjbGllbnRIb3N0IjoiMTAuMTAuMTAuMTUxIiwicHJlZmVycmVkX3VzZXJuYW1lIjoic2VydmljZS1hY2NvdW50LTAyMDVjYiIsImNsaWVudEFkZHJlc3MiOiIxMC4xMC4xMC4xNTEiLCJjbGllbnRfaWQiOiIwMjA1Y2IifQ.bATUogohrEqy7Voa4mFnsBzOnGy6tnjZGh_lOYRn-0hWXMY_fz-280nTu2Vv68eO3HeoewtWlt45S_iLI2-ml3pqpAlt3DXWVmLvVHw6d7TICHBfQsa0jGXMexKnyar7EinrVhF3deSK25Ap_ajC_82EvVvXrVG-7p9F1dEdq39y2R72JympejF5uhY_z_jNmqJSsnLEZVOo3WMJn76u9tTcYVIldC5uWGFWbPGEhvWPx4ZGpsuq_wrPOGdRmyJDFJPJl7LnLGHK0DBhuVtJUq_NFQkMus2fTTf_mWhRnoqNU-wUCS-fxMs6QusGzIVd-C3O29J3rerHTrGg21LAsQ\",\"expires_in\":300,\"refresh_expires_in\":0,\"token_type\":\"Bearer\",\"not-before-policy\":0,\"scope\":\"profile email\"}\n\n"},{"result":{"nanos":89600,"millis":0.0896,"status":"passed"},"step":{"line":21,"prefix":"Then","index":8,"text":"status 200"}},{"result":{"nanos":6680400,"millis":6.6804,"status":"passed"},"step":{"line":22,"prefix":"*","index":9,"text":"def jsonResponse = response"}},{"result":{"nanos":30011100,"millis":30.0111,"status":"passed"},"step":{"line":23,"prefix":"*","index":10,"text":"def codecb = clientId.substring(0, 4)"}},{"result":{"nanos":18403400,"millis":18.4034,"status":"passed"},"step":{"line":24,"prefix":"*","index":11,"text":"def formattedDate = java.time.LocalDate.now().format(java.time.format.DateTimeFormatter.ofPattern('yyyyMMdd'))"}},{"result":{"nanos":59859000,"millis":59.859,"status":"passed"},"step":{"line":25,"prefix":"*","index":12,"text":"match jsonResponse.access_token != null"}},{"result":{"nanos":8561300,"millis":8.5613,"status":"passed"},"step":{"endLine":33,"line":26,"prefix":"*","docString":"{\n  currentDate: '#(formattedDate)',\n  coop_codecb: '#(codecb)',\n  auth_tokencb: '#(jsonResponse.access_token)'\n}","index":13,"text":"def tokenInfo ="}},{"result":{"nanos":3986400,"millis":3.9864,"status":"passed"},"step":{"line":34,"prefix":"*","index":14,"text":"set tokenInfo.responseStatus = responseStatus"}},{"result":{"nanos":3115100,"millis":3.1151,"status":"passed"},"step":{"line":35,"prefix":"*","index":15,"text":"set tokenInfo.rawResponse = jsonResponse"}},{"result":{"nanos":2084100,"millis":2.0841,"status":"passed"},"step":{"line":36,"prefix":"*","index":16,"text":"def Files = Java.type('java.nio.file.Files')"}},{"result":{"nanos":1783800,"millis":1.7838,"status":"passed"},"step":{"line":37,"prefix":"*","index":17,"text":"def StandardCharsets = Java.type('java.nio.charset.StandardCharsets')"}},{"result":{"nanos":1153300,"millis":1.1533,"status":"passed"},"step":{"line":38,"prefix":"*","index":18,"text":"def ObjectMapper = Java.type('com.fasterxml.jackson.databind.ObjectMapper')"}},{"result":{"nanos":30267700,"millis":30.2677,"status":"passed"},"step":{"line":39,"prefix":"*","index":19,"text":"def mapper = new ObjectMapper()"}},{"result":{"nanos":5218300,"millis":5.2183,"status":"passed"},"step":{"line":40,"prefix":"*","index":20,"text":"eval Files.createDirectories(tokenDirectory)"}},{"result":{"nanos":1417300,"millis":1.4173,"status":"passed"},"step":{"line":41,"prefix":"*","index":21,"text":"set tokenInfo.tokenPath = tokenTextPath"}},{"result":{"nanos":874000,"millis":0.874,"status":"passed"},"step":{"line":42,"prefix":"*","index":22,"text":"set tokenInfo.tokenJsonPath = tokenJsonPath"}},{"result":{"nanos":824100,"millis":0.8241,"status":"passed"},"step":{"line":43,"prefix":"*","index":23,"text":"set tokenInfo.tokenResponsePath = tokenResponsePath"}},{"result":{"nanos":23827900,"millis":23.8279,"status":"passed"},"step":{"line":44,"prefix":"*","index":24,"text":"eval Files.write(Paths.get(tokenTextPath), tokenInfo.auth_tokencb.getBytes(StandardCharsets.UTF_8))"}},{"result":{"nanos":142439100,"millis":142.4391,"status":"passed"},"step":{"line":45,"prefix":"*","index":25,"text":"eval Files.write(Paths.get(tokenJsonPath), mapper.writeValueAsBytes(tokenInfo))"}},{"result":{"nanos":15166500,"millis":15.1665,"status":"passed"},"step":{"line":46,"prefix":"*","index":26,"text":"eval Files.write(Paths.get(tokenResponsePath), mapper.writeValueAsBytes({ status: responseStatus, response: jsonResponse }))"}},{"result":{"nanos":9467700,"millis":9.4677,"status":"passed"},"step":{"line":47,"prefix":"*","index":27,"text":"karate.log('Token almacenado en:', tokenTextPath)"},"stepLog":"14:14:17.922 Token almacenado en: C:\\Users\\aromero\\OneDrive - RED TRANSACCIONAL COOPERATIVA RTC COONECTA\\Escritorio\\PRUEBA - TATA\\Karate-EJERCICIO2\\target\\token.txt \n"},{"result":{"nanos":1655800,"millis":1.6558,"status":"passed"},"step":{"line":48,"prefix":"*","index":28,"text":"karate.log('Detalle crudo almacenado en:', tokenResponsePath)"},"stepLog":"14:14:17.922 Detalle crudo almacenado en: C:\\Users\\aromero\\OneDrive - RED TRANSACCIONAL COOPERATIVA RTC COONECTA\\Escritorio\\PRUEBA - TATA\\Karate-EJERCICIO2\\target\\token-response.json \n"},{"result":{"nanos":492200,"millis":0.4922,"status":"passed"},"step":{"line":49,"prefix":"*","index":29,"text":"def result = tokenInfo"}}],"executorName":"main","line":11,"name":"Solicitar token con client_credentials y preparar datos compartidos","description":"","durationMillis":1485.6814,"startTime":1761160456426,"failed":false,"refId":"[1:11]","endTime":1761160457928,"exampleIndex":-1},{"sectionIndex":1,"stepResults":[{"result":{"nanos":3873600,"millis":3.8736,"status":"passed"},"step":{"background":true,"line":4,"prefix":"*","index":0,"text":"def projectDir = karate.properties['karate.project.dir'] ? karate.properties['karate.project.dir'] : java.lang.System.getProperty('user.dir')"},"stepLog":"14:14:17.944 key store key count for classpath:certificado\/clientcert.cbiblian.internal 1.pfx: 1\n"},{"result":{"nanos":1118000,"millis":1.118,"status":"passed"},"step":{"background":true,"line":5,"prefix":"*","index":1,"text":"def Paths = Java.type('java.nio.file.Paths')"}},{"result":{"nanos":648500,"millis":0.6485,"status":"passed"},"step":{"background":true,"line":6,"prefix":"*","index":2,"text":"def tokenDirectory = Paths.get(projectDir, 'target')"}},{"result":{"nanos":469600,"millis":0.4696,"status":"passed"},"step":{"background":true,"line":7,"prefix":"*","index":3,"text":"def tokenTextPath = tokenDirectory.resolve('token.txt').toString()"}},{"result":{"nanos":466600,"millis":0.4666,"status":"passed"},"step":{"background":true,"line":8,"prefix":"*","index":4,"text":"def tokenJsonPath = tokenDirectory.resolve('token-data.json').toString()"}},{"result":{"nanos":429700,"millis":0.4297,"status":"passed"},"step":{"background":true,"line":9,"prefix":"*","index":5,"text":"def tokenResponsePath = tokenDirectory.resolve('token-response.json').toString()"}},{"result":{"nanos":33700200,"millis":33.7002,"status":"passed"},"step":{"line":52,"prefix":"*","index":0,"text":"def savedToken = read('file:' + tokenJsonPath)"}},{"result":{"nanos":3405600,"millis":3.4056,"status":"passed"},"step":{"line":53,"prefix":"*","index":1,"text":"match savedToken.auth_tokencb != null"}},{"result":{"nanos":10885700,"millis":10.8857,"status":"passed"},"step":{"line":54,"prefix":"*","index":2,"text":"match savedToken.responseStatus == 200"}},{"result":{"nanos":6398400,"millis":6.3984,"status":"passed"},"step":{"line":55,"prefix":"*","index":3,"text":"def today = java.time.LocalDate.now().format(java.time.format.DateTimeFormatter.ofPattern('yyyyMMdd'))"}},{"result":{"nanos":1061000,"millis":1.061,"status":"passed"},"step":{"line":56,"prefix":"*","index":4,"text":"match savedToken.currentDate == today"}},{"result":{"nanos":1330300,"millis":1.3303,"status":"passed"},"step":{"line":57,"prefix":"*","index":5,"text":"match savedToken.coop_codecb == '0205'"}},{"result":{"nanos":3285800,"millis":3.2858,"status":"passed"},"step":{"line":58,"prefix":"*","index":6,"text":"def responseEnvelope = read('file:' + tokenResponsePath)"}},{"result":{"nanos":1875300,"millis":1.8753,"status":"passed"},"step":{"line":59,"prefix":"*","index":7,"text":"match responseEnvelope.status == savedToken.responseStatus"}}],"executorName":"main","line":51,"name":"Validar estructura persistida del token","description":"","durationMillis":68.9483,"startTime":1761160457955,"failed":false,"refId":"[2:51]","endTime":1761160458026,"exampleIndex":-1},{"sectionIndex":2,"stepResults":[{"result":{"nanos":5381100,"millis":5.3811,"status":"passed"},"step":{"background":true,"line":4,"prefix":"*","index":0,"text":"def projectDir = karate.properties['karate.project.dir'] ? karate.properties['karate.project.dir'] : java.lang.System.getProperty('user.dir')"},"stepLog":"14:14:18.043 key store key count for classpath:certificado\/clientcert.cbiblian.internal 1.pfx: 1\n"},{"result":{"nanos":1063200,"millis":1.0632,"status":"passed"},"step":{"background":true,"line":5,"prefix":"*","index":1,"text":"def Paths = Java.type('java.nio.file.Paths')"}},{"result":{"nanos":1156300,"millis":1.1563,"status":"passed"},"step":{"background":true,"line":6,"prefix":"*","index":2,"text":"def tokenDirectory = Paths.get(projectDir, 'target')"}},{"result":{"nanos":843200,"millis":0.8432,"status":"passed"},"step":{"background":true,"line":7,"prefix":"*","index":3,"text":"def tokenTextPath = tokenDirectory.resolve('token.txt').toString()"}},{"result":{"nanos":848400,"millis":0.8484,"status":"passed"},"step":{"background":true,"line":8,"prefix":"*","index":4,"text":"def tokenJsonPath = tokenDirectory.resolve('token-data.json').toString()"}},{"result":{"nanos":729800,"millis":0.7298,"status":"passed"},"step":{"background":true,"line":9,"prefix":"*","index":5,"text":"def tokenResponsePath = tokenDirectory.resolve('token-response.json').toString()"}},{"result":{"nanos":14678600,"millis":14.6786,"status":"passed"},"step":{"line":62,"prefix":"*","index":0,"text":"def rawToken = karate.readAsString('file:' + tokenTextPath).trim()"}},{"result":{"nanos":15978300,"millis":15.9783,"status":"passed"},"step":{"line":63,"prefix":"*","index":1,"text":"assert rawToken.length() > 20"}},{"result":{"nanos":3327200,"millis":3.3272,"status":"passed"},"step":{"line":64,"prefix":"*","index":2,"text":"def savedToken = read('file:' + tokenJsonPath)"}},{"result":{"nanos":737100,"millis":0.7371,"status":"passed"},"step":{"line":65,"prefix":"*","index":3,"text":"match savedToken.auth_tokencb == rawToken"}},{"result":{"nanos":448500,"millis":0.4485,"status":"passed"},"step":{"line":66,"prefix":"*","index":4,"text":"match savedToken.tokenPath == tokenTextPath"}},{"result":{"nanos":321700,"millis":0.3217,"status":"passed"},"step":{"line":67,"prefix":"*","index":5,"text":"def tokenInfo = savedToken"}},{"result":{"nanos":262600,"millis":0.2626,"status":"passed"},"step":{"line":68,"prefix":"*","index":6,"text":"def result = tokenInfo"}}],"executorName":"main","line":61,"name":"Verificar consistencia de archivos auxiliares","description":"","durationMillis":45.776,"startTime":1761160458043,"failed":false,"refId":"[3:61]","endTime":1761160458092,"exampleIndex":-1}],"callDepth":1,"name":"Generar y almacenar token OAuth PANAPAY","description":"","resultDate":"2025-10-22 02:15:30 p. m.","durationMillis":1600.4057,"passedCount":3}]},{"result":{"nanos":2956600,"millis":2.9566,"status":"passed"},"step":{"background":true,"line":6,"prefix":"*","index":1,"text":"def tokenData = tokenContext.tokenInfo"}},{"result":{"nanos":3801400,"millis":3.8014,"status":"passed"},"step":{"background":true,"line":7,"prefix":"*","index":2,"text":"def transferenciaBaseUrl = karate.properties['transfer.baseUrl'] || 'https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral'"}},{"result":{"nanos":210200,"millis":0.2102,"status":"passed"},"step":{"background":true,"line":8,"prefix":"*","index":3,"text":"url transferenciaBaseUrl"}},{"result":{"nanos":704600,"millis":0.7046,"status":"passed"},"step":{"background":true,"line":9,"prefix":"*","index":4,"text":"def authHeaders = { 'Content-Type': 'application\/json' }"}},{"result":{"nanos":3719000,"millis":3.719,"status":"passed"},"step":{"background":true,"line":10,"prefix":"*","index":5,"text":"set authHeaders.Authorization = 'Bearer ' + tokenData.auth_tokencb"}},{"result":{"nanos":374000,"millis":0.374,"status":"passed"},"step":{"background":true,"line":11,"prefix":"*","index":6,"text":"configure headers = authHeaders"}},{"result":{"nanos":758900,"millis":0.7589,"status":"passed"},"step":{"endLine":24,"background":true,"line":12,"prefix":"*","docString":"{\n  \"0205\": {\n    \"CTA_AHORROS\": \"EC5002051000000000020501052673\",\n    \"CTA_CORRIENTE\": \"EC0402051000000000020101002318\"\n  },\n  \"0303\": {\n    \"CTA_AHORROS\": \"EC5003031000000000030301051111\",\n    \"CTA_CORRIENTE\": \"EC0403031000000000030101002222\"\n  }\n}","index":7,"text":"def accountCatalog ="}},{"result":{"nanos":27060600,"millis":27.0606,"status":"passed"},"step":{"endLine":39,"background":true,"line":25,"prefix":"*","docString":"function(value){\n  var list;\n  if (!value && value !== 0){\n    list = [200];\n  } else {\n    list = Array.isArray(value) ? value.slice(0) : [value];\n  }\n  if (list.indexOf(200) === -1){\n    list.push(200);\n  }\n  return list;\n}","index":8,"text":"def normalizeStatus ="}},{"result":{"nanos":82296500,"millis":82.2965,"status":"passed"},"step":{"endLine":110,"background":true,"line":40,"prefix":"*","docString":"function(overrides){\n  overrides = overrides || {};\n  var token = karate.get('tokenData');\n  var catalog = karate.get('accountCatalog');\n  var LocalDateTime = Java.type('java.time.LocalDateTime');\n  var DateTimeFormatter = Java.type('java.time.format.DateTimeFormatter');\n  var timestamp = LocalDateTime.now().format(DateTimeFormatter.ofPattern(\"yyyy-MM-dd'T'HH:mm:ss\"));\n  var randomDigits = function(length){\n    var digits = '';\n    for (var i = 0; i < length; i++){\n      digits += Math.floor(Math.random() * 10);\n    }\n    return digits;\n  };\n  var coopCode = overrides.instgAgtFinInstId || token.coop_codecb || '0205';\n  var debtorType = overrides.debtorAccountType || 'CTA_AHORROS';\n  var creditorType = overrides.creditorAccountType || 'CTA_CORRIENTE';\n  var creditorEntity = overrides.creditorEntity || overrides.instdAgtFinInstId || coopCode;\n  var debtorAccounts = catalog[coopCode] || catalog['0205'];\n  var creditorAccounts = catalog[creditorEntity] || catalog['0303'];\n  var debtorIban = overrides.debtorIban || (debtorAccounts ? (debtorAccounts[debtorType] || debtorAccounts['CTA_AHORROS']) : 'EC5002051000000000020501052673');\n  var creditorIban = overrides.creditorIban || (creditorAccounts ? (creditorAccounts[creditorType] || creditorAccounts['CTA_CORRIENTE']) : 'EC0403031000000000030101002222');\n  if (overrides.sameIban){\n    creditorIban = debtorIban;\n  }\n  var msgId = overrides.msgId || (coopCode + token.currentDate + randomDigits(11));\n  var endToEndId = overrides.endToEndId || (coopCode + token.currentDate + randomDigits(5));\n  var amountValue = overrides.amount != null ? overrides.amount : 1.00;\n  var payload = {\n    GrpHdr: {\n      msgId: msgId,\n      creDtTm: timestamp,\n      nbOfTxs: overrides.nbOfTxs || 1,\n      sttlmInf: { sttlmMtd: overrides.settlementMethod || 'INGA' },\n      instgAgt: { finInstnId: coopCode },\n      InstdAgt: { FinInstnId: overrides.instdAgtFinInstId || creditorEntity },\n      Mge: { Type: overrides.messageType || 'acmt.998.321.01' },\n      ChnlId: overrides.channel || 'APP'\n    },\n    CdtTrfTxInf: {\n      PmtId: { EndToEndId: endToEndId },\n      IntrBkSttlmAmt: { Amt: amountValue, Ccy: overrides.currency || 'USD' },\n      DbtrAcctId: { IBAN: debtorIban },\n      CdtrAcctId: { IBAN: creditorIban },\n      Prtry: {\n        CustRef: overrides.customerReference || 'QA22',\n        ChanRef: overrides.channelReference || (overrides.channel === 'QR' ? 'QRPANAPAY' : 'TERM001'),\n        AgtRef: overrides.agentReference || 'AGT0002'\n      }\n    }\n  };\n  if (overrides.prtryOverrides){\n    Object.keys(overrides.prtryOverrides).forEach(function(key){\n      payload.CdtTrfTxInf.Prtry[key] = overrides.prtryOverrides[key];\n    });\n  }\n  if (overrides.overrideHeaders){\n    payload.GrpHdr.instgAgt = overrides.overrideHeaders.instgAgt || payload.GrpHdr.instgAgt;\n    payload.GrpHdr.InstdAgt = overrides.overrideHeaders.instdAgt || payload.GrpHdr.InstdAgt;\n  }\n  return payload;\n}","index":9,"text":"def buildPayload ="}},{"result":{"nanos":13180700,"millis":13.1807,"status":"passed"},"step":{"endLine":150,"background":true,"line":111,"prefix":"*","docString":"function(body, expectation){\n  expectation = expectation || {};\n  var txInfo = (body && body.CdtTrfTxInf) ? body.CdtTrfTxInf : {};\n  var outcome = expectation.outcome || 'success';\n  var requireTxOk = expectation.requireTxOk === true;\n  var requireTxReject = expectation.requireTxReject === true;\n  var expectedTxStatus = expectation.expectedTxStatus;\n  if (expectedTxStatus != null){\n    karate.match(txInfo.TxSts, expectedTxStatus);\n  } else if (outcome === 'success' && requireTxOk){\n    karate.match(txInfo.TxSts, 'Ok');\n  } else if (outcome === 'reject' && requireTxReject){\n    karate.match(txInfo.TxSts, '#? _ && _ != \"Ok\"');\n  } else {\n    if (txInfo && txInfo.TxSts){\n      karate.log('TxSts recibido:', txInfo.TxSts, '- no se valida estrictamente.');\n    } else {\n      karate.log('Sin TxSts en la respuesta, continuando sin validacion.');\n    }\n  }\n  if (outcome === 'pending'){\n    karate.match(txInfo.TxSts, '#? _ == \"PENDING\" || _ == \"PROC\"');\n  }\n  if (expectation.reasonCode){\n    var reasonNode = txInfo.Rsn || {};\n    karate.match(reasonNode.RsnCd, expectation.reasonCode);\n  }\n  if (expectation.expectedEndToEndId){\n    karate.match(txInfo.PmtId.EndToEndId, expectation.expectedEndToEndId);\n  }\n  if (expectation.expectedMsgId){\n    var grpHdr = (body && body.GrpHdr) ? body.GrpHdr : {};\n    karate.match(grpHdr.msgId, expectation.expectedMsgId);\n  }\n}","index":10,"text":"def verifyTransferOutcome ="}},{"result":{"nanos":1907300,"millis":1.9073,"status":"passed"},"step":{"endLine":156,"background":true,"line":151,"prefix":"*","docString":"function(name, payload, responseBody, status){\n  karate.log('[Transfer]', name, '| status:', status, '| msgId:', payload.GrpHdr.msgId, '| endToEnd:', payload.CdtTrfTxInf.PmtId.EndToEndId);\n}","index":11,"text":"def logTransferSummary ="}},{"result":{"nanos":50757200,"millis":50.7572,"status":"passed"},"step":{"line":159,"prefix":"*","index":0,"text":"def payload = buildPayload()"}},{"result":{"nanos":1131000,"millis":1.131,"status":"passed"},"step":{"line":160,"prefix":"*","index":1,"text":"def expectation = { httpStatus: 200, outcome: 'success', expectedEndToEndId: payload.CdtTrfTxInf.PmtId.EndToEndId }"}},{"result":{"nanos":66358600,"millis":66.3586,"status":"passed"},"step":{"line":161,"prefix":"*","index":2,"text":"def normalizedStatus = normalizeStatus(expectation.httpStatus)"}},{"result":{"nanos":2901300,"millis":2.9013,"status":"passed"},"step":{"line":162,"prefix":"Given","index":3,"text":"path 'finan', 'transferencia'"}},{"result":{"nanos":687400,"millis":0.6874,"status":"passed"},"step":{"line":163,"prefix":"And","index":4,"text":"request payload"}},{"result":{"nanos":10680167600,"millis":10680.1676,"status":"passed"},"step":{"line":164,"prefix":"When","index":5,"text":"method post"},"stepLog":"14:14:18.372 request:\n1 > POST https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral\/finan\/transferencia\n1 > Content-Type: application\/json; charset=UTF-8\n1 > Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2dUJWTkN6VlViUFBlTFdReEM0WDAyYVM3UnM2UGRYV1dja1dfc0xZMHlFIn0.eyJleHAiOjE3NjExNjA3NTAsImlhdCI6MTc2MTE2MDQ1MCwianRpIjoidHJydGNjOjQ5Yjg0NDVjLTgzYTAtMjI4Ni02NDczLWE2ZGEzOTBhOWQ0YSIsImlzcyI6Imh0dHBzOi8vYXV0ZW50aWNhY2lvbnFhLmNvb25lY3RhLmNvbS5lYy9hdXRoL3JlYWxtcy9QQU5BUEFZIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6Ijk5OGMyZmUwLTJjOGYtNGQwNC1iZjExLWY1OWExZTM5ODg3MyIsInR5cCI6IkJlYXJlciIsImF6cCI6IjAyMDVjYiIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiLyoiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRlZmF1bHQtcm9sZXMtYWRtaW5wYW5hcGF5Iiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7IjAyMDVjYiI6eyJyb2xlcyI6WyJ1bWFfcHJvdGVjdGlvbiJdfSwiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJjbGllbnRIb3N0IjoiMTAuMTAuMTAuMTUxIiwicHJlZmVycmVkX3VzZXJuYW1lIjoic2VydmljZS1hY2NvdW50LTAyMDVjYiIsImNsaWVudEFkZHJlc3MiOiIxMC4xMC4xMC4xNTEiLCJjbGllbnRfaWQiOiIwMjA1Y2IifQ.bATUogohrEqy7Voa4mFnsBzOnGy6tnjZGh_lOYRn-0hWXMY_fz-280nTu2Vv68eO3HeoewtWlt45S_iLI2-ml3pqpAlt3DXWVmLvVHw6d7TICHBfQsa0jGXMexKnyar7EinrVhF3deSK25Ap_ajC_82EvVvXrVG-7p9F1dEdq39y2R72JympejF5uhY_z_jNmqJSsnLEZVOo3WMJn76u9tTcYVIldC5uWGFWbPGEhvWPx4ZGpsuq_wrPOGdRmyJDFJPJl7LnLGHK0DBhuVtJUq_NFQkMus2fTTf_mWhRnoqNU-wUCS-fxMs6QusGzIVd-C3O29J3rerHTrGg21LAsQ\n1 > Content-Length: 509\n1 > Host: apipanapayqa.coonecta.com.ec\n1 > Connection: Keep-Alive\n1 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/17.0.12)\n1 > Accept-Encoding: gzip,deflate\n{\"GrpHdr\":{\"msgId\":\"02052025102271886075182\",\"creDtTm\":\"2025-10-22T14:14:18\",\"nbOfTxs\":1,\"sttlmInf\":{\"sttlmMtd\":\"INGA\"},\"instgAgt\":{\"finInstnId\":\"0205\"},\"InstdAgt\":{\"FinInstnId\":\"0205\"},\"Mge\":{\"Type\":\"acmt.998.321.01\"},\"ChnlId\":\"APP\"},\"CdtTrfTxInf\":{\"PmtId\":{\"EndToEndId\":\"02052025102208648\"},\"IntrBkSttlmAmt\":{\"Amt\":1,\"Ccy\":\"USD\"},\"DbtrAcctId\":{\"IBAN\":\"EC5002051000000000020501052673\"},\"CdtrAcctId\":{\"IBAN\":\"EC0402051000000000020101002318\"},\"Prtry\":{\"CustRef\":\"QA22\",\"ChanRef\":\"TERM001\",\"AgtRef\":\"AGT0002\"}}}\n\n14:14:29.038 response time in milliseconds: 10564\n1 < 200\n1 < Date: Wed, 22 Oct 2025 19:14:20 GMT\n1 < Content-Type: application\/json; charset=utf-8\n1 < Transfer-Encoding: chunked\n1 < Connection: keep-alive\n1 < Server: Kestrel\n1 < Set-Cookie: ARRAffinity=135f536e0d078a815c3b83fda3468ab8a3a2abc604a35eefb28648d3961cfa9b;Path=\/;HttpOnly;Secure;Domain=app-apipanapay-qa.azurewebsites.net\n1 < Set-Cookie: ARRAffinitySameSite=135f536e0d078a815c3b83fda3468ab8a3a2abc604a35eefb28648d3961cfa9b;Path=\/;HttpOnly;SameSite=None;Secure;Domain=app-apipanapay-qa.azurewebsites.net\n1 < Vary: Accept-Encoding\n1 < Request-Context: appId=cid-v1:a7a77847-2713-450f-9030-b350a2d54a28\n1 < X-Powered-By: ASP.NET\n1 < X-ARR-ClientCert: -----BEGIN%20CERTIFICATE-----%0AMIIEHDCCAgSgAwIBAgIUZIZBO0fb7VZ4KXrs01S4RYbWyJ8wDQYJKoZIhvcNAQEL%0ABQAwJTEjMCEGA1UEAwwacm9vdGNlcnQuY2JpYmxpYW4uaW50ZXJuYWwwHhcNMjUw%0AODEzMTMyNTU5WhcNMjgwODEyMTMyNTU5WjAnMSUwIwYDVQQDDBxjbGllbnRjZXJ0%0ALmNiaWJsaWFuLmludGVybmFsMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKC%0AAQEAskUDap6NmyYq8RT6F7z3DpZGQiflNQTvUT84TmxsKXEBRAkgINnkJqgKkd7f%0ASEybzqglQTbr4s41lCiPsy3X66qYjU2L%2Bojhni%2BOCVOX7n3JBYovL%2FqfMP3%2FkhZP%0AQIlK%2FQWPcrnl39fYkGOQv%2BYqoCGEPzGkib2m1Ma5Q1HOCKh1ErMjqTLGy%2ByJj6JY%0AiZvMx3YrJSvjUS0uKpNwxPtGyiexRfKsmR%2FHqPzRHa0iY%2B752KSgUedwJPv1Wod%2B%0AY9BMAMIdU25UtkUEsaOYtorGWDaZSn2Bl0LYmP87kjcYypnHx0jtPtUCXfVHrE6u%0AZnDRFYsZbeXylY3mJkyOL2DzZwIDAQABo0IwQDAdBgNVHQ4EFgQURPhJwTAcUWUp%0ArOqQO68P%2FbJoqjMwHwYDVR0jBBgwFoAU7GdlxoSeEXucEXhjadHRC9xzS0UwDQYJ%0AKoZIhvcNAQELBQADggIBAGTnlyF2n%2F6s9phYbO8V17niO0BXB62ToX6gPhcw9f3y%0AhMui6RnrM1oiHlBWqZquCqYJ5ETvYJE1RqvoqtGysxCnIj0OTJHV4WtF3SHsd1Tu%0ATg%2B%2FUnGivtBTDQxj9sbAtCaSYRBqPByP8jvSTDgXR1mgOrEGjr2PZdZSoKLj4OHi%0A9UCMJw7pJsyA4lbroKshQTYv5Ks5SqtJpdp0%2BUX0UUlbPJqXiadfbKdoXvEgcwbP%0ACqR9v7kGYmNxfaGLNGVrV%2BnLawIDmdYXJE%2F4WJh6sHfiZxEsE%2BB4PoKADrb1Eapt%0AnSdHUgRfc0i5f2lcmErnU8nCMO5TWdHFOgpYwTS8w17FhNFZpaSmyZKM7uHcUs7y%0AUbuiQtdXocfSSMf%2FeycBEU%2FHAVIWQEqY%2BbJdC0q%2FR%2BsESeBtXd4IEIxR0QfgscGk%0AJyCSFC8z%2FvCgrRsH5rePqKO7%2FLAsDTP4GIQNFNfF4Wh6bsPXuJmvvoMcnmy%2F58Wo%0AE0XaG8UPHVAeyEmhncdM32E7SJbR91aRr2CkV23OoUz%2BwKG2%2FuObHmAkuMkCbbcz%0AJQoC7DZg5FGw%2BZR7v1DIBct5QNJQ8bG%2FXGRxjWC6dU7jrGhOF1X%2B2YYcdx9XnwyM%0A9YPxUy5bVfMhIiKP2wEso5fjOZ4RTvnB5R6zD3maJK%2FtZAXVhtyqXSkBYFi4MvEs%0A-----END%20CERTIFICATE-----%0A\n{\"GrpHdr\":{\"MsgId\":\"000020251022020354\",\"CreDtTm\":\"2025-10-22T14:14:17\",\"NbOfTxs\":1,\"SttlmInf\":{\"SttlmMtd\":\"INGA\"},\"InstgAgt\":{\"FinInstnId\":\"0205\"},\"InstdAgt\":{\"FinInstnId\":\"0205\"},\"Mge\":{\"Type\":\"acmt.998.322.001\"},\"ChnlId\":\"APP\"},\"CdtTrfTxInf\":{\"OrgnGrpInf\":{\"OrgnlMsgId\":\"02052025102271886075182\",\"OrgnlMgeType\":\"acmt.998.321.01\",\"OrgnlCreDtTm\":\"2025-10-22T14:14:18\"},\"PmtId\":{\"EndToEndId\":\"02052025102208648\",\"TxId\":\"18535\"},\"TxSts\":\"Ok\",\"Rsn\":{\"RsnCd\":\"0000\",\"AddtlInf\":\"Transacción Exitosa\"},\"Dbtr\":{\"AuthCode\":\"020520251022141419624766\"},\"Cdtr\":{\"AuthCode\":\"020520251022141420061137\"},\"SttlmDt\":\"2025-10-22\"}}\n\n"},{"result":{"nanos":0,"errorMessage":"no step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:165","millis":0.0,"status":"failed"},"step":{"line":165,"prefix":"Then","index":6,"text":"match responseStatus in normalizedStatus"},"stepLog":"14:14:29.042 classpath:Transferencia.feature:165\nThen match responseStatus in normalizedStatus\nno step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:165\n"},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":166,"prefix":"*","index":7,"text":"eval verifyTransferOutcome(response, expectation)"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":167,"prefix":"*","index":8,"text":"eval logTransferSummary('Transferencia exitosa con credenciales validas', payload, response, responseStatus)"}}],"line":158,"description":"","durationMillis":12692.9993,"failed":true,"error":"no step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:165","tags":["transferencia"],"executorName":"main","name":"Transferencia exitosa con credenciales validas","startTime":1761160455332,"refId":"[1:158]","endTime":1761160469042,"exampleIndex":-1},{"sectionIndex":1,"stepResults":[{"result":{"nanos":8218800,"millis":8.2188,"status":"passed"},"step":{"background":true,"line":5,"prefix":"*","index":0,"text":"def tokenContext = callonce read('classpath:helpers\/generate-token.feature')"},"stepLog":"14:14:29.148 key store key count for classpath:certificado\/clientcert.cbiblian.internal 1.pfx: 1\n"},{"result":{"nanos":2314300,"millis":2.3143,"status":"passed"},"step":{"background":true,"line":6,"prefix":"*","index":1,"text":"def tokenData = tokenContext.tokenInfo"}},{"result":{"nanos":2427900,"millis":2.4279,"status":"passed"},"step":{"background":true,"line":7,"prefix":"*","index":2,"text":"def transferenciaBaseUrl = karate.properties['transfer.baseUrl'] || 'https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral'"}},{"result":{"nanos":189700,"millis":0.1897,"status":"passed"},"step":{"background":true,"line":8,"prefix":"*","index":3,"text":"url transferenciaBaseUrl"}},{"result":{"nanos":704000,"millis":0.704,"status":"passed"},"step":{"background":true,"line":9,"prefix":"*","index":4,"text":"def authHeaders = { 'Content-Type': 'application\/json' }"}},{"result":{"nanos":3366300,"millis":3.3663,"status":"passed"},"step":{"background":true,"line":10,"prefix":"*","index":5,"text":"set authHeaders.Authorization = 'Bearer ' + tokenData.auth_tokencb"}},{"result":{"nanos":252700,"millis":0.2527,"status":"passed"},"step":{"background":true,"line":11,"prefix":"*","index":6,"text":"configure headers = authHeaders"}},{"result":{"nanos":679600,"millis":0.6796,"status":"passed"},"step":{"endLine":24,"background":true,"line":12,"prefix":"*","docString":"{\n  \"0205\": {\n    \"CTA_AHORROS\": \"EC5002051000000000020501052673\",\n    \"CTA_CORRIENTE\": \"EC0402051000000000020101002318\"\n  },\n  \"0303\": {\n    \"CTA_AHORROS\": \"EC5003031000000000030301051111\",\n    \"CTA_CORRIENTE\": \"EC0403031000000000030101002222\"\n  }\n}","index":7,"text":"def accountCatalog ="}},{"result":{"nanos":3089200,"millis":3.0892,"status":"passed"},"step":{"endLine":39,"background":true,"line":25,"prefix":"*","docString":"function(value){\n  var list;\n  if (!value && value !== 0){\n    list = [200];\n  } else {\n    list = Array.isArray(value) ? value.slice(0) : [value];\n  }\n  if (list.indexOf(200) === -1){\n    list.push(200);\n  }\n  return list;\n}","index":8,"text":"def normalizeStatus ="}},{"result":{"nanos":723300,"millis":0.7233,"status":"passed"},"step":{"endLine":110,"background":true,"line":40,"prefix":"*","docString":"function(overrides){\n  overrides = overrides || {};\n  var token = karate.get('tokenData');\n  var catalog = karate.get('accountCatalog');\n  var LocalDateTime = Java.type('java.time.LocalDateTime');\n  var DateTimeFormatter = Java.type('java.time.format.DateTimeFormatter');\n  var timestamp = LocalDateTime.now().format(DateTimeFormatter.ofPattern(\"yyyy-MM-dd'T'HH:mm:ss\"));\n  var randomDigits = function(length){\n    var digits = '';\n    for (var i = 0; i < length; i++){\n      digits += Math.floor(Math.random() * 10);\n    }\n    return digits;\n  };\n  var coopCode = overrides.instgAgtFinInstId || token.coop_codecb || '0205';\n  var debtorType = overrides.debtorAccountType || 'CTA_AHORROS';\n  var creditorType = overrides.creditorAccountType || 'CTA_CORRIENTE';\n  var creditorEntity = overrides.creditorEntity || overrides.instdAgtFinInstId || coopCode;\n  var debtorAccounts = catalog[coopCode] || catalog['0205'];\n  var creditorAccounts = catalog[creditorEntity] || catalog['0303'];\n  var debtorIban = overrides.debtorIban || (debtorAccounts ? (debtorAccounts[debtorType] || debtorAccounts['CTA_AHORROS']) : 'EC5002051000000000020501052673');\n  var creditorIban = overrides.creditorIban || (creditorAccounts ? (creditorAccounts[creditorType] || creditorAccounts['CTA_CORRIENTE']) : 'EC0403031000000000030101002222');\n  if (overrides.sameIban){\n    creditorIban = debtorIban;\n  }\n  var msgId = overrides.msgId || (coopCode + token.currentDate + randomDigits(11));\n  var endToEndId = overrides.endToEndId || (coopCode + token.currentDate + randomDigits(5));\n  var amountValue = overrides.amount != null ? overrides.amount : 1.00;\n  var payload = {\n    GrpHdr: {\n      msgId: msgId,\n      creDtTm: timestamp,\n      nbOfTxs: overrides.nbOfTxs || 1,\n      sttlmInf: { sttlmMtd: overrides.settlementMethod || 'INGA' },\n      instgAgt: { finInstnId: coopCode },\n      InstdAgt: { FinInstnId: overrides.instdAgtFinInstId || creditorEntity },\n      Mge: { Type: overrides.messageType || 'acmt.998.321.01' },\n      ChnlId: overrides.channel || 'APP'\n    },\n    CdtTrfTxInf: {\n      PmtId: { EndToEndId: endToEndId },\n      IntrBkSttlmAmt: { Amt: amountValue, Ccy: overrides.currency || 'USD' },\n      DbtrAcctId: { IBAN: debtorIban },\n      CdtrAcctId: { IBAN: creditorIban },\n      Prtry: {\n        CustRef: overrides.customerReference || 'QA22',\n        ChanRef: overrides.channelReference || (overrides.channel === 'QR' ? 'QRPANAPAY' : 'TERM001'),\n        AgtRef: overrides.agentReference || 'AGT0002'\n      }\n    }\n  };\n  if (overrides.prtryOverrides){\n    Object.keys(overrides.prtryOverrides).forEach(function(key){\n      payload.CdtTrfTxInf.Prtry[key] = overrides.prtryOverrides[key];\n    });\n  }\n  if (overrides.overrideHeaders){\n    payload.GrpHdr.instgAgt = overrides.overrideHeaders.instgAgt || payload.GrpHdr.instgAgt;\n    payload.GrpHdr.InstdAgt = overrides.overrideHeaders.instdAgt || payload.GrpHdr.InstdAgt;\n  }\n  return payload;\n}","index":9,"text":"def buildPayload ="}},{"result":{"nanos":5346400,"millis":5.3464,"status":"passed"},"step":{"endLine":150,"background":true,"line":111,"prefix":"*","docString":"function(body, expectation){\n  expectation = expectation || {};\n  var txInfo = (body && body.CdtTrfTxInf) ? body.CdtTrfTxInf : {};\n  var outcome = expectation.outcome || 'success';\n  var requireTxOk = expectation.requireTxOk === true;\n  var requireTxReject = expectation.requireTxReject === true;\n  var expectedTxStatus = expectation.expectedTxStatus;\n  if (expectedTxStatus != null){\n    karate.match(txInfo.TxSts, expectedTxStatus);\n  } else if (outcome === 'success' && requireTxOk){\n    karate.match(txInfo.TxSts, 'Ok');\n  } else if (outcome === 'reject' && requireTxReject){\n    karate.match(txInfo.TxSts, '#? _ && _ != \"Ok\"');\n  } else {\n    if (txInfo && txInfo.TxSts){\n      karate.log('TxSts recibido:', txInfo.TxSts, '- no se valida estrictamente.');\n    } else {\n      karate.log('Sin TxSts en la respuesta, continuando sin validacion.');\n    }\n  }\n  if (outcome === 'pending'){\n    karate.match(txInfo.TxSts, '#? _ == \"PENDING\" || _ == \"PROC\"');\n  }\n  if (expectation.reasonCode){\n    var reasonNode = txInfo.Rsn || {};\n    karate.match(reasonNode.RsnCd, expectation.reasonCode);\n  }\n  if (expectation.expectedEndToEndId){\n    karate.match(txInfo.PmtId.EndToEndId, expectation.expectedEndToEndId);\n  }\n  if (expectation.expectedMsgId){\n    var grpHdr = (body && body.GrpHdr) ? body.GrpHdr : {};\n    karate.match(grpHdr.msgId, expectation.expectedMsgId);\n  }\n}","index":10,"text":"def verifyTransferOutcome ="}},{"result":{"nanos":1390300,"millis":1.3903,"status":"passed"},"step":{"endLine":156,"background":true,"line":151,"prefix":"*","docString":"function(name, payload, responseBody, status){\n  karate.log('[Transfer]', name, '| status:', status, '| msgId:', payload.GrpHdr.msgId, '| endToEnd:', payload.CdtTrfTxInf.PmtId.EndToEndId);\n}","index":11,"text":"def logTransferSummary ="}},{"result":{"nanos":11052700,"millis":11.0527,"status":"passed"},"step":{"line":170,"prefix":"*","index":0,"text":"def payload = buildPayload({ channel: 'QR', debtorAccountType: 'CTA_AHORROS', creditorAccountType: 'CTA_CORRIENTE', channelReference: 'QR-APP' })"}},{"result":{"nanos":1056500,"millis":1.0565,"status":"passed"},"step":{"line":171,"prefix":"*","index":1,"text":"def expectation = { httpStatus: 200, outcome: 'success', expectedEndToEndId: payload.CdtTrfTxInf.PmtId.EndToEndId }"}},{"result":{"nanos":2154700,"millis":2.1547,"status":"passed"},"step":{"line":172,"prefix":"*","index":2,"text":"def normalizedStatus = normalizeStatus(expectation.httpStatus)"}},{"result":{"nanos":816100,"millis":0.8161,"status":"passed"},"step":{"line":173,"prefix":"Given","index":3,"text":"path 'finan', 'transferencia'"}},{"result":{"nanos":264000,"millis":0.264,"status":"passed"},"step":{"line":174,"prefix":"And","index":4,"text":"request payload"}},{"result":{"nanos":875180400,"millis":875.1804,"status":"passed"},"step":{"line":175,"prefix":"When","index":5,"text":"method post"},"stepLog":"14:14:29.208 request:\n1 > POST https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral\/finan\/transferencia\n1 > Content-Type: application\/json; charset=UTF-8\n1 > Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2dUJWTkN6VlViUFBlTFdReEM0WDAyYVM3UnM2UGRYV1dja1dfc0xZMHlFIn0.eyJleHAiOjE3NjExNjA3NTAsImlhdCI6MTc2MTE2MDQ1MCwianRpIjoidHJydGNjOjQ5Yjg0NDVjLTgzYTAtMjI4Ni02NDczLWE2ZGEzOTBhOWQ0YSIsImlzcyI6Imh0dHBzOi8vYXV0ZW50aWNhY2lvbnFhLmNvb25lY3RhLmNvbS5lYy9hdXRoL3JlYWxtcy9QQU5BUEFZIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6Ijk5OGMyZmUwLTJjOGYtNGQwNC1iZjExLWY1OWExZTM5ODg3MyIsInR5cCI6IkJlYXJlciIsImF6cCI6IjAyMDVjYiIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiLyoiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRlZmF1bHQtcm9sZXMtYWRtaW5wYW5hcGF5Iiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7IjAyMDVjYiI6eyJyb2xlcyI6WyJ1bWFfcHJvdGVjdGlvbiJdfSwiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJjbGllbnRIb3N0IjoiMTAuMTAuMTAuMTUxIiwicHJlZmVycmVkX3VzZXJuYW1lIjoic2VydmljZS1hY2NvdW50LTAyMDVjYiIsImNsaWVudEFkZHJlc3MiOiIxMC4xMC4xMC4xNTEiLCJjbGllbnRfaWQiOiIwMjA1Y2IifQ.bATUogohrEqy7Voa4mFnsBzOnGy6tnjZGh_lOYRn-0hWXMY_fz-280nTu2Vv68eO3HeoewtWlt45S_iLI2-ml3pqpAlt3DXWVmLvVHw6d7TICHBfQsa0jGXMexKnyar7EinrVhF3deSK25Ap_ajC_82EvVvXrVG-7p9F1dEdq39y2R72JympejF5uhY_z_jNmqJSsnLEZVOo3WMJn76u9tTcYVIldC5uWGFWbPGEhvWPx4ZGpsuq_wrPOGdRmyJDFJPJl7LnLGHK0DBhuVtJUq_NFQkMus2fTTf_mWhRnoqNU-wUCS-fxMs6QusGzIVd-C3O29J3rerHTrGg21LAsQ\n1 > Content-Length: 507\n1 > Host: apipanapayqa.coonecta.com.ec\n1 > Connection: Keep-Alive\n1 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/17.0.12)\n1 > Accept-Encoding: gzip,deflate\n{\"GrpHdr\":{\"msgId\":\"02052025102230268759719\",\"creDtTm\":\"2025-10-22T14:14:29\",\"nbOfTxs\":1,\"sttlmInf\":{\"sttlmMtd\":\"INGA\"},\"instgAgt\":{\"finInstnId\":\"0205\"},\"InstdAgt\":{\"FinInstnId\":\"0205\"},\"Mge\":{\"Type\":\"acmt.998.321.01\"},\"ChnlId\":\"QR\"},\"CdtTrfTxInf\":{\"PmtId\":{\"EndToEndId\":\"02052025102267472\"},\"IntrBkSttlmAmt\":{\"Amt\":1,\"Ccy\":\"USD\"},\"DbtrAcctId\":{\"IBAN\":\"EC5002051000000000020501052673\"},\"CdtrAcctId\":{\"IBAN\":\"EC0402051000000000020101002318\"},\"Prtry\":{\"CustRef\":\"QA22\",\"ChanRef\":\"QR-APP\",\"AgtRef\":\"AGT0002\"}}}\n\n14:14:30.077 response time in milliseconds: 867\n1 < 400\n1 < Date: Wed, 22 Oct 2025 19:14:21 GMT\n1 < Content-Type: application\/json; charset=utf-8\n1 < Transfer-Encoding: chunked\n1 < Connection: keep-alive\n1 < Server: Kestrel\n1 < Set-Cookie: ARRAffinity=135f536e0d078a815c3b83fda3468ab8a3a2abc604a35eefb28648d3961cfa9b;Path=\/;HttpOnly;Secure;Domain=app-apipanapay-qa.azurewebsites.net\n1 < Set-Cookie: ARRAffinitySameSite=135f536e0d078a815c3b83fda3468ab8a3a2abc604a35eefb28648d3961cfa9b;Path=\/;HttpOnly;SameSite=None;Secure;Domain=app-apipanapay-qa.azurewebsites.net\n1 < Request-Context: appId=cid-v1:a7a77847-2713-450f-9030-b350a2d54a28\n1 < X-Powered-By: ASP.NET\n1 < X-ARR-ClientCert: -----BEGIN%20CERTIFICATE-----%0AMIIEHDCCAgSgAwIBAgIUZIZBO0fb7VZ4KXrs01S4RYbWyJ8wDQYJKoZIhvcNAQEL%0ABQAwJTEjMCEGA1UEAwwacm9vdGNlcnQuY2JpYmxpYW4uaW50ZXJuYWwwHhcNMjUw%0AODEzMTMyNTU5WhcNMjgwODEyMTMyNTU5WjAnMSUwIwYDVQQDDBxjbGllbnRjZXJ0%0ALmNiaWJsaWFuLmludGVybmFsMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKC%0AAQEAskUDap6NmyYq8RT6F7z3DpZGQiflNQTvUT84TmxsKXEBRAkgINnkJqgKkd7f%0ASEybzqglQTbr4s41lCiPsy3X66qYjU2L%2Bojhni%2BOCVOX7n3JBYovL%2FqfMP3%2FkhZP%0AQIlK%2FQWPcrnl39fYkGOQv%2BYqoCGEPzGkib2m1Ma5Q1HOCKh1ErMjqTLGy%2ByJj6JY%0AiZvMx3YrJSvjUS0uKpNwxPtGyiexRfKsmR%2FHqPzRHa0iY%2B752KSgUedwJPv1Wod%2B%0AY9BMAMIdU25UtkUEsaOYtorGWDaZSn2Bl0LYmP87kjcYypnHx0jtPtUCXfVHrE6u%0AZnDRFYsZbeXylY3mJkyOL2DzZwIDAQABo0IwQDAdBgNVHQ4EFgQURPhJwTAcUWUp%0ArOqQO68P%2FbJoqjMwHwYDVR0jBBgwFoAU7GdlxoSeEXucEXhjadHRC9xzS0UwDQYJ%0AKoZIhvcNAQELBQADggIBAGTnlyF2n%2F6s9phYbO8V17niO0BXB62ToX6gPhcw9f3y%0AhMui6RnrM1oiHlBWqZquCqYJ5ETvYJE1RqvoqtGysxCnIj0OTJHV4WtF3SHsd1Tu%0ATg%2B%2FUnGivtBTDQxj9sbAtCaSYRBqPByP8jvSTDgXR1mgOrEGjr2PZdZSoKLj4OHi%0A9UCMJw7pJsyA4lbroKshQTYv5Ks5SqtJpdp0%2BUX0UUlbPJqXiadfbKdoXvEgcwbP%0ACqR9v7kGYmNxfaGLNGVrV%2BnLawIDmdYXJE%2F4WJh6sHfiZxEsE%2BB4PoKADrb1Eapt%0AnSdHUgRfc0i5f2lcmErnU8nCMO5TWdHFOgpYwTS8w17FhNFZpaSmyZKM7uHcUs7y%0AUbuiQtdXocfSSMf%2FeycBEU%2FHAVIWQEqY%2BbJdC0q%2FR%2BsESeBtXd4IEIxR0QfgscGk%0AJyCSFC8z%2FvCgrRsH5rePqKO7%2FLAsDTP4GIQNFNfF4Wh6bsPXuJmvvoMcnmy%2F58Wo%0AE0XaG8UPHVAeyEmhncdM32E7SJbR91aRr2CkV23OoUz%2BwKG2%2FuObHmAkuMkCbbcz%0AJQoC7DZg5FGw%2BZR7v1DIBct5QNJQ8bG%2FXGRxjWC6dU7jrGhOF1X%2B2YYcdx9XnwyM%0A9YPxUy5bVfMhIiKP2wEso5fjOZ4RTvnB5R6zD3maJK%2FtZAXVhtyqXSkBYFi4MvEs%0A-----END%20CERTIFICATE-----%0A\n{\"GrpHdr\":{\"MsgId\":\"000020251022020355\",\"CreDtTm\":\"2025-10-22T14:14:22\",\"NbOfTxs\":1,\"SttlmInf\":{\"SttlmMtd\":\"INGA\"},\"InstgAgt\":{\"FinInstnId\":\"0205\"},\"InstdAgt\":{\"FinInstnId\":\"0205\"},\"Mge\":{\"Type\":\"acmt.998.322.001\"},\"ChnlId\":\"QR\"},\"CdtTrfTxInf\":{\"OrgnGrpInf\":{\"OrgnlMsgId\":\"02052025102230268759719\",\"OrgnlMgeType\":\"acmt.998.321.01\",\"OrgnlCreDtTm\":\"2025-10-22T14:14:29\"},\"TxSts\":\"ERR\",\"Rsn\":{\"RsnCd\":\"9000\",\"AddtlInf\":\"El canal de origen de la transacción enviado no es correcto.\"},\"SttlmDt\":\"2025-10-22\"}}\n\n"},{"result":{"nanos":0,"errorMessage":"no step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:176","millis":0.0,"status":"failed"},"step":{"line":176,"prefix":"Then","index":6,"text":"match responseStatus in normalizedStatus"},"stepLog":"14:14:30.079 classpath:Transferencia.feature:176\nThen match responseStatus in normalizedStatus\nno step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:176\n"},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":177,"prefix":"*","index":7,"text":"eval verifyTransferOutcome(response, expectation)"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":178,"prefix":"*","index":8,"text":"eval logTransferSummary('QR misma entidad', payload, response, responseStatus)"}}],"line":169,"description":"","durationMillis":919.2269,"failed":true,"error":"no step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:176","tags":["transferencia"],"executorName":"main","name":"Transferencia exitosa mediante QR entre dos clientes de la misma entidad (ordenante CTA Ahorro, receptor CTA Corriente)","startTime":1761160469135,"refId":"[2:169]","endTime":1761160470079,"exampleIndex":-1},{"sectionIndex":2,"stepResults":[{"result":{"nanos":6479600,"millis":6.4796,"status":"passed"},"step":{"background":true,"line":5,"prefix":"*","index":0,"text":"def tokenContext = callonce read('classpath:helpers\/generate-token.feature')"},"stepLog":"14:14:30.108 key store key count for classpath:certificado\/clientcert.cbiblian.internal 1.pfx: 1\n"},{"result":{"nanos":614100,"millis":0.6141,"status":"passed"},"step":{"background":true,"line":6,"prefix":"*","index":1,"text":"def tokenData = tokenContext.tokenInfo"}},{"result":{"nanos":838600,"millis":0.8386,"status":"passed"},"step":{"background":true,"line":7,"prefix":"*","index":2,"text":"def transferenciaBaseUrl = karate.properties['transfer.baseUrl'] || 'https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral'"}},{"result":{"nanos":188900,"millis":0.1889,"status":"passed"},"step":{"background":true,"line":8,"prefix":"*","index":3,"text":"url transferenciaBaseUrl"}},{"result":{"nanos":938300,"millis":0.9383,"status":"passed"},"step":{"background":true,"line":9,"prefix":"*","index":4,"text":"def authHeaders = { 'Content-Type': 'application\/json' }"}},{"result":{"nanos":2052300,"millis":2.0523,"status":"passed"},"step":{"background":true,"line":10,"prefix":"*","index":5,"text":"set authHeaders.Authorization = 'Bearer ' + tokenData.auth_tokencb"}},{"result":{"nanos":174500,"millis":0.1745,"status":"passed"},"step":{"background":true,"line":11,"prefix":"*","index":6,"text":"configure headers = authHeaders"}},{"result":{"nanos":453900,"millis":0.4539,"status":"passed"},"step":{"endLine":24,"background":true,"line":12,"prefix":"*","docString":"{\n  \"0205\": {\n    \"CTA_AHORROS\": \"EC5002051000000000020501052673\",\n    \"CTA_CORRIENTE\": \"EC0402051000000000020101002318\"\n  },\n  \"0303\": {\n    \"CTA_AHORROS\": \"EC5003031000000000030301051111\",\n    \"CTA_CORRIENTE\": \"EC0403031000000000030101002222\"\n  }\n}","index":7,"text":"def accountCatalog ="}},{"result":{"nanos":570300,"millis":0.5703,"status":"passed"},"step":{"endLine":39,"background":true,"line":25,"prefix":"*","docString":"function(value){\n  var list;\n  if (!value && value !== 0){\n    list = [200];\n  } else {\n    list = Array.isArray(value) ? value.slice(0) : [value];\n  }\n  if (list.indexOf(200) === -1){\n    list.push(200);\n  }\n  return list;\n}","index":8,"text":"def normalizeStatus ="}},{"result":{"nanos":587900,"millis":0.5879,"status":"passed"},"step":{"endLine":110,"background":true,"line":40,"prefix":"*","docString":"function(overrides){\n  overrides = overrides || {};\n  var token = karate.get('tokenData');\n  var catalog = karate.get('accountCatalog');\n  var LocalDateTime = Java.type('java.time.LocalDateTime');\n  var DateTimeFormatter = Java.type('java.time.format.DateTimeFormatter');\n  var timestamp = LocalDateTime.now().format(DateTimeFormatter.ofPattern(\"yyyy-MM-dd'T'HH:mm:ss\"));\n  var randomDigits = function(length){\n    var digits = '';\n    for (var i = 0; i < length; i++){\n      digits += Math.floor(Math.random() * 10);\n    }\n    return digits;\n  };\n  var coopCode = overrides.instgAgtFinInstId || token.coop_codecb || '0205';\n  var debtorType = overrides.debtorAccountType || 'CTA_AHORROS';\n  var creditorType = overrides.creditorAccountType || 'CTA_CORRIENTE';\n  var creditorEntity = overrides.creditorEntity || overrides.instdAgtFinInstId || coopCode;\n  var debtorAccounts = catalog[coopCode] || catalog['0205'];\n  var creditorAccounts = catalog[creditorEntity] || catalog['0303'];\n  var debtorIban = overrides.debtorIban || (debtorAccounts ? (debtorAccounts[debtorType] || debtorAccounts['CTA_AHORROS']) : 'EC5002051000000000020501052673');\n  var creditorIban = overrides.creditorIban || (creditorAccounts ? (creditorAccounts[creditorType] || creditorAccounts['CTA_CORRIENTE']) : 'EC0403031000000000030101002222');\n  if (overrides.sameIban){\n    creditorIban = debtorIban;\n  }\n  var msgId = overrides.msgId || (coopCode + token.currentDate + randomDigits(11));\n  var endToEndId = overrides.endToEndId || (coopCode + token.currentDate + randomDigits(5));\n  var amountValue = overrides.amount != null ? overrides.amount : 1.00;\n  var payload = {\n    GrpHdr: {\n      msgId: msgId,\n      creDtTm: timestamp,\n      nbOfTxs: overrides.nbOfTxs || 1,\n      sttlmInf: { sttlmMtd: overrides.settlementMethod || 'INGA' },\n      instgAgt: { finInstnId: coopCode },\n      InstdAgt: { FinInstnId: overrides.instdAgtFinInstId || creditorEntity },\n      Mge: { Type: overrides.messageType || 'acmt.998.321.01' },\n      ChnlId: overrides.channel || 'APP'\n    },\n    CdtTrfTxInf: {\n      PmtId: { EndToEndId: endToEndId },\n      IntrBkSttlmAmt: { Amt: amountValue, Ccy: overrides.currency || 'USD' },\n      DbtrAcctId: { IBAN: debtorIban },\n      CdtrAcctId: { IBAN: creditorIban },\n      Prtry: {\n        CustRef: overrides.customerReference || 'QA22',\n        ChanRef: overrides.channelReference || (overrides.channel === 'QR' ? 'QRPANAPAY' : 'TERM001'),\n        AgtRef: overrides.agentReference || 'AGT0002'\n      }\n    }\n  };\n  if (overrides.prtryOverrides){\n    Object.keys(overrides.prtryOverrides).forEach(function(key){\n      payload.CdtTrfTxInf.Prtry[key] = overrides.prtryOverrides[key];\n    });\n  }\n  if (overrides.overrideHeaders){\n    payload.GrpHdr.instgAgt = overrides.overrideHeaders.instgAgt || payload.GrpHdr.instgAgt;\n    payload.GrpHdr.InstdAgt = overrides.overrideHeaders.instdAgt || payload.GrpHdr.InstdAgt;\n  }\n  return payload;\n}","index":9,"text":"def buildPayload ="}},{"result":{"nanos":457300,"millis":0.4573,"status":"passed"},"step":{"endLine":150,"background":true,"line":111,"prefix":"*","docString":"function(body, expectation){\n  expectation = expectation || {};\n  var txInfo = (body && body.CdtTrfTxInf) ? body.CdtTrfTxInf : {};\n  var outcome = expectation.outcome || 'success';\n  var requireTxOk = expectation.requireTxOk === true;\n  var requireTxReject = expectation.requireTxReject === true;\n  var expectedTxStatus = expectation.expectedTxStatus;\n  if (expectedTxStatus != null){\n    karate.match(txInfo.TxSts, expectedTxStatus);\n  } else if (outcome === 'success' && requireTxOk){\n    karate.match(txInfo.TxSts, 'Ok');\n  } else if (outcome === 'reject' && requireTxReject){\n    karate.match(txInfo.TxSts, '#? _ && _ != \"Ok\"');\n  } else {\n    if (txInfo && txInfo.TxSts){\n      karate.log('TxSts recibido:', txInfo.TxSts, '- no se valida estrictamente.');\n    } else {\n      karate.log('Sin TxSts en la respuesta, continuando sin validacion.');\n    }\n  }\n  if (outcome === 'pending'){\n    karate.match(txInfo.TxSts, '#? _ == \"PENDING\" || _ == \"PROC\"');\n  }\n  if (expectation.reasonCode){\n    var reasonNode = txInfo.Rsn || {};\n    karate.match(reasonNode.RsnCd, expectation.reasonCode);\n  }\n  if (expectation.expectedEndToEndId){\n    karate.match(txInfo.PmtId.EndToEndId, expectation.expectedEndToEndId);\n  }\n  if (expectation.expectedMsgId){\n    var grpHdr = (body && body.GrpHdr) ? body.GrpHdr : {};\n    karate.match(grpHdr.msgId, expectation.expectedMsgId);\n  }\n}","index":10,"text":"def verifyTransferOutcome ="}},{"result":{"nanos":1177500,"millis":1.1775,"status":"passed"},"step":{"endLine":156,"background":true,"line":151,"prefix":"*","docString":"function(name, payload, responseBody, status){\n  karate.log('[Transfer]', name, '| status:', status, '| msgId:', payload.GrpHdr.msgId, '| endToEnd:', payload.CdtTrfTxInf.PmtId.EndToEndId);\n}","index":11,"text":"def logTransferSummary ="}},{"result":{"nanos":11471800,"millis":11.4718,"status":"passed"},"step":{"line":181,"prefix":"*","index":0,"text":"def payload = buildPayload({ debtorAccountType: 'CTA_CORRIENTE', creditorAccountType: 'CTA_CORRIENTE' })"}},{"result":{"nanos":779700,"millis":0.7797,"status":"passed"},"step":{"line":182,"prefix":"*","index":1,"text":"def expectation = { httpStatus: 200, outcome: 'success', expectedEndToEndId: payload.CdtTrfTxInf.PmtId.EndToEndId }"}},{"result":{"nanos":1337500,"millis":1.3375,"status":"passed"},"step":{"line":183,"prefix":"*","index":2,"text":"def normalizedStatus = normalizeStatus(expectation.httpStatus)"}},{"result":{"nanos":422000,"millis":0.422,"status":"passed"},"step":{"line":184,"prefix":"Given","index":3,"text":"path 'finan', 'transferencia'"}},{"result":{"nanos":188100,"millis":0.1881,"status":"passed"},"step":{"line":185,"prefix":"And","index":4,"text":"request payload"}},{"result":{"nanos":1611370700,"millis":1611.3707,"status":"passed"},"step":{"line":186,"prefix":"When","index":5,"text":"method post"},"stepLog":"14:14:30.149 request:\n1 > POST https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral\/finan\/transferencia\n1 > Content-Type: application\/json; charset=UTF-8\n1 > Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2dUJWTkN6VlViUFBlTFdReEM0WDAyYVM3UnM2UGRYV1dja1dfc0xZMHlFIn0.eyJleHAiOjE3NjExNjA3NTAsImlhdCI6MTc2MTE2MDQ1MCwianRpIjoidHJydGNjOjQ5Yjg0NDVjLTgzYTAtMjI4Ni02NDczLWE2ZGEzOTBhOWQ0YSIsImlzcyI6Imh0dHBzOi8vYXV0ZW50aWNhY2lvbnFhLmNvb25lY3RhLmNvbS5lYy9hdXRoL3JlYWxtcy9QQU5BUEFZIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6Ijk5OGMyZmUwLTJjOGYtNGQwNC1iZjExLWY1OWExZTM5ODg3MyIsInR5cCI6IkJlYXJlciIsImF6cCI6IjAyMDVjYiIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiLyoiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRlZmF1bHQtcm9sZXMtYWRtaW5wYW5hcGF5Iiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7IjAyMDVjYiI6eyJyb2xlcyI6WyJ1bWFfcHJvdGVjdGlvbiJdfSwiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJjbGllbnRIb3N0IjoiMTAuMTAuMTAuMTUxIiwicHJlZmVycmVkX3VzZXJuYW1lIjoic2VydmljZS1hY2NvdW50LTAyMDVjYiIsImNsaWVudEFkZHJlc3MiOiIxMC4xMC4xMC4xNTEiLCJjbGllbnRfaWQiOiIwMjA1Y2IifQ.bATUogohrEqy7Voa4mFnsBzOnGy6tnjZGh_lOYRn-0hWXMY_fz-280nTu2Vv68eO3HeoewtWlt45S_iLI2-ml3pqpAlt3DXWVmLvVHw6d7TICHBfQsa0jGXMexKnyar7EinrVhF3deSK25Ap_ajC_82EvVvXrVG-7p9F1dEdq39y2R72JympejF5uhY_z_jNmqJSsnLEZVOo3WMJn76u9tTcYVIldC5uWGFWbPGEhvWPx4ZGpsuq_wrPOGdRmyJDFJPJl7LnLGHK0DBhuVtJUq_NFQkMus2fTTf_mWhRnoqNU-wUCS-fxMs6QusGzIVd-C3O29J3rerHTrGg21LAsQ\n1 > Content-Length: 509\n1 > Host: apipanapayqa.coonecta.com.ec\n1 > Connection: Keep-Alive\n1 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/17.0.12)\n1 > Accept-Encoding: gzip,deflate\n{\"GrpHdr\":{\"msgId\":\"02052025102276025926486\",\"creDtTm\":\"2025-10-22T14:14:30\",\"nbOfTxs\":1,\"sttlmInf\":{\"sttlmMtd\":\"INGA\"},\"instgAgt\":{\"finInstnId\":\"0205\"},\"InstdAgt\":{\"FinInstnId\":\"0205\"},\"Mge\":{\"Type\":\"acmt.998.321.01\"},\"ChnlId\":\"APP\"},\"CdtTrfTxInf\":{\"PmtId\":{\"EndToEndId\":\"02052025102265146\"},\"IntrBkSttlmAmt\":{\"Amt\":1,\"Ccy\":\"USD\"},\"DbtrAcctId\":{\"IBAN\":\"EC0402051000000000020101002318\"},\"CdtrAcctId\":{\"IBAN\":\"EC0402051000000000020101002318\"},\"Prtry\":{\"CustRef\":\"QA22\",\"ChanRef\":\"TERM001\",\"AgtRef\":\"AGT0002\"}}}\n\n14:14:31.749 response time in milliseconds: 1600\n1 < 400\n1 < Date: Wed, 22 Oct 2025 19:14:22 GMT\n1 < Content-Type: application\/json; charset=utf-8\n1 < Transfer-Encoding: chunked\n1 < Connection: keep-alive\n1 < Server: Kestrel\n1 < Set-Cookie: ARRAffinity=135f536e0d078a815c3b83fda3468ab8a3a2abc604a35eefb28648d3961cfa9b;Path=\/;HttpOnly;Secure;Domain=app-apipanapay-qa.azurewebsites.net\n1 < Set-Cookie: ARRAffinitySameSite=135f536e0d078a815c3b83fda3468ab8a3a2abc604a35eefb28648d3961cfa9b;Path=\/;HttpOnly;SameSite=None;Secure;Domain=app-apipanapay-qa.azurewebsites.net\n1 < Request-Context: appId=cid-v1:a7a77847-2713-450f-9030-b350a2d54a28\n1 < X-Powered-By: ASP.NET\n1 < X-ARR-ClientCert: -----BEGIN%20CERTIFICATE-----%0AMIIEHDCCAgSgAwIBAgIUZIZBO0fb7VZ4KXrs01S4RYbWyJ8wDQYJKoZIhvcNAQEL%0ABQAwJTEjMCEGA1UEAwwacm9vdGNlcnQuY2JpYmxpYW4uaW50ZXJuYWwwHhcNMjUw%0AODEzMTMyNTU5WhcNMjgwODEyMTMyNTU5WjAnMSUwIwYDVQQDDBxjbGllbnRjZXJ0%0ALmNiaWJsaWFuLmludGVybmFsMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKC%0AAQEAskUDap6NmyYq8RT6F7z3DpZGQiflNQTvUT84TmxsKXEBRAkgINnkJqgKkd7f%0ASEybzqglQTbr4s41lCiPsy3X66qYjU2L%2Bojhni%2BOCVOX7n3JBYovL%2FqfMP3%2FkhZP%0AQIlK%2FQWPcrnl39fYkGOQv%2BYqoCGEPzGkib2m1Ma5Q1HOCKh1ErMjqTLGy%2ByJj6JY%0AiZvMx3YrJSvjUS0uKpNwxPtGyiexRfKsmR%2FHqPzRHa0iY%2B752KSgUedwJPv1Wod%2B%0AY9BMAMIdU25UtkUEsaOYtorGWDaZSn2Bl0LYmP87kjcYypnHx0jtPtUCXfVHrE6u%0AZnDRFYsZbeXylY3mJkyOL2DzZwIDAQABo0IwQDAdBgNVHQ4EFgQURPhJwTAcUWUp%0ArOqQO68P%2FbJoqjMwHwYDVR0jBBgwFoAU7GdlxoSeEXucEXhjadHRC9xzS0UwDQYJ%0AKoZIhvcNAQELBQADggIBAGTnlyF2n%2F6s9phYbO8V17niO0BXB62ToX6gPhcw9f3y%0AhMui6RnrM1oiHlBWqZquCqYJ5ETvYJE1RqvoqtGysxCnIj0OTJHV4WtF3SHsd1Tu%0ATg%2B%2FUnGivtBTDQxj9sbAtCaSYRBqPByP8jvSTDgXR1mgOrEGjr2PZdZSoKLj4OHi%0A9UCMJw7pJsyA4lbroKshQTYv5Ks5SqtJpdp0%2BUX0UUlbPJqXiadfbKdoXvEgcwbP%0ACqR9v7kGYmNxfaGLNGVrV%2BnLawIDmdYXJE%2F4WJh6sHfiZxEsE%2BB4PoKADrb1Eapt%0AnSdHUgRfc0i5f2lcmErnU8nCMO5TWdHFOgpYwTS8w17FhNFZpaSmyZKM7uHcUs7y%0AUbuiQtdXocfSSMf%2FeycBEU%2FHAVIWQEqY%2BbJdC0q%2FR%2BsESeBtXd4IEIxR0QfgscGk%0AJyCSFC8z%2FvCgrRsH5rePqKO7%2FLAsDTP4GIQNFNfF4Wh6bsPXuJmvvoMcnmy%2F58Wo%0AE0XaG8UPHVAeyEmhncdM32E7SJbR91aRr2CkV23OoUz%2BwKG2%2FuObHmAkuMkCbbcz%0AJQoC7DZg5FGw%2BZR7v1DIBct5QNJQ8bG%2FXGRxjWC6dU7jrGhOF1X%2B2YYcdx9XnwyM%0A9YPxUy5bVfMhIiKP2wEso5fjOZ4RTvnB5R6zD3maJK%2FtZAXVhtyqXSkBYFi4MvEs%0A-----END%20CERTIFICATE-----%0A\n{\"GrpHdr\":{\"MsgId\":\"000020251022020356\",\"CreDtTm\":\"2025-10-22T14:14:23\",\"NbOfTxs\":1,\"SttlmInf\":{\"SttlmMtd\":\"INGA\"},\"InstgAgt\":{\"FinInstnId\":\"0205\"},\"InstdAgt\":{\"FinInstnId\":\"0205\"},\"Mge\":{\"Type\":\"acmt.998.322.001\"},\"ChnlId\":\"APP\"},\"CdtTrfTxInf\":{\"OrgnGrpInf\":{\"OrgnlMsgId\":\"02052025102276025926486\",\"OrgnlMgeType\":\"acmt.998.321.01\",\"OrgnlCreDtTm\":\"2025-10-22T14:14:30\"},\"TxSts\":\"ERR\",\"Rsn\":{\"RsnCd\":\"6005\",\"AddtlInf\":\"Ambos IBAN son iguales.\"},\"SttlmDt\":\"2025-10-22\"}}\n\n"},{"result":{"nanos":0,"errorMessage":"no step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:187","millis":0.0,"status":"failed"},"step":{"line":187,"prefix":"Then","index":6,"text":"match responseStatus in normalizedStatus"},"stepLog":"14:14:31.757 classpath:Transferencia.feature:187\nThen match responseStatus in normalizedStatus\nno step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:187\n"},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":188,"prefix":"*","index":7,"text":"eval verifyTransferOutcome(response, expectation)"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":189,"prefix":"*","index":8,"text":"eval logTransferSummary('Corriente vs Corriente misma entidad', payload, response, responseStatus)"}}],"line":180,"description":"","durationMillis":1640.103,"failed":true,"error":"no step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:187","tags":["transferencia"],"executorName":"main","name":"Transferencia exitosa entre dos clientes de la misma entidad (ordenante CTA Corriente, receptor CTA Corriente)","startTime":1761160470100,"refId":"[3:180]","endTime":1761160471757,"exampleIndex":-1},{"sectionIndex":3,"stepResults":[{"result":{"nanos":4114800,"millis":4.1148,"status":"passed"},"step":{"background":true,"line":5,"prefix":"*","index":0,"text":"def tokenContext = callonce read('classpath:helpers\/generate-token.feature')"},"stepLog":"14:14:31.781 key store key count for classpath:certificado\/clientcert.cbiblian.internal 1.pfx: 1\n"},{"result":{"nanos":442500,"millis":0.4425,"status":"passed"},"step":{"background":true,"line":6,"prefix":"*","index":1,"text":"def tokenData = tokenContext.tokenInfo"}},{"result":{"nanos":562600,"millis":0.5626,"status":"passed"},"step":{"background":true,"line":7,"prefix":"*","index":2,"text":"def transferenciaBaseUrl = karate.properties['transfer.baseUrl'] || 'https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral'"}},{"result":{"nanos":195000,"millis":0.195,"status":"passed"},"step":{"background":true,"line":8,"prefix":"*","index":3,"text":"url transferenciaBaseUrl"}},{"result":{"nanos":513800,"millis":0.5138,"status":"passed"},"step":{"background":true,"line":9,"prefix":"*","index":4,"text":"def authHeaders = { 'Content-Type': 'application\/json' }"}},{"result":{"nanos":3084000,"millis":3.084,"status":"passed"},"step":{"background":true,"line":10,"prefix":"*","index":5,"text":"set authHeaders.Authorization = 'Bearer ' + tokenData.auth_tokencb"}},{"result":{"nanos":713000,"millis":0.713,"status":"passed"},"step":{"background":true,"line":11,"prefix":"*","index":6,"text":"configure headers = authHeaders"}},{"result":{"nanos":1621400,"millis":1.6214,"status":"passed"},"step":{"endLine":24,"background":true,"line":12,"prefix":"*","docString":"{\n  \"0205\": {\n    \"CTA_AHORROS\": \"EC5002051000000000020501052673\",\n    \"CTA_CORRIENTE\": \"EC0402051000000000020101002318\"\n  },\n  \"0303\": {\n    \"CTA_AHORROS\": \"EC5003031000000000030301051111\",\n    \"CTA_CORRIENTE\": \"EC0403031000000000030101002222\"\n  }\n}","index":7,"text":"def accountCatalog ="}},{"result":{"nanos":972900,"millis":0.9729,"status":"passed"},"step":{"endLine":39,"background":true,"line":25,"prefix":"*","docString":"function(value){\n  var list;\n  if (!value && value !== 0){\n    list = [200];\n  } else {\n    list = Array.isArray(value) ? value.slice(0) : [value];\n  }\n  if (list.indexOf(200) === -1){\n    list.push(200);\n  }\n  return list;\n}","index":8,"text":"def normalizeStatus ="}},{"result":{"nanos":428000,"millis":0.428,"status":"passed"},"step":{"endLine":110,"background":true,"line":40,"prefix":"*","docString":"function(overrides){\n  overrides = overrides || {};\n  var token = karate.get('tokenData');\n  var catalog = karate.get('accountCatalog');\n  var LocalDateTime = Java.type('java.time.LocalDateTime');\n  var DateTimeFormatter = Java.type('java.time.format.DateTimeFormatter');\n  var timestamp = LocalDateTime.now().format(DateTimeFormatter.ofPattern(\"yyyy-MM-dd'T'HH:mm:ss\"));\n  var randomDigits = function(length){\n    var digits = '';\n    for (var i = 0; i < length; i++){\n      digits += Math.floor(Math.random() * 10);\n    }\n    return digits;\n  };\n  var coopCode = overrides.instgAgtFinInstId || token.coop_codecb || '0205';\n  var debtorType = overrides.debtorAccountType || 'CTA_AHORROS';\n  var creditorType = overrides.creditorAccountType || 'CTA_CORRIENTE';\n  var creditorEntity = overrides.creditorEntity || overrides.instdAgtFinInstId || coopCode;\n  var debtorAccounts = catalog[coopCode] || catalog['0205'];\n  var creditorAccounts = catalog[creditorEntity] || catalog['0303'];\n  var debtorIban = overrides.debtorIban || (debtorAccounts ? (debtorAccounts[debtorType] || debtorAccounts['CTA_AHORROS']) : 'EC5002051000000000020501052673');\n  var creditorIban = overrides.creditorIban || (creditorAccounts ? (creditorAccounts[creditorType] || creditorAccounts['CTA_CORRIENTE']) : 'EC0403031000000000030101002222');\n  if (overrides.sameIban){\n    creditorIban = debtorIban;\n  }\n  var msgId = overrides.msgId || (coopCode + token.currentDate + randomDigits(11));\n  var endToEndId = overrides.endToEndId || (coopCode + token.currentDate + randomDigits(5));\n  var amountValue = overrides.amount != null ? overrides.amount : 1.00;\n  var payload = {\n    GrpHdr: {\n      msgId: msgId,\n      creDtTm: timestamp,\n      nbOfTxs: overrides.nbOfTxs || 1,\n      sttlmInf: { sttlmMtd: overrides.settlementMethod || 'INGA' },\n      instgAgt: { finInstnId: coopCode },\n      InstdAgt: { FinInstnId: overrides.instdAgtFinInstId || creditorEntity },\n      Mge: { Type: overrides.messageType || 'acmt.998.321.01' },\n      ChnlId: overrides.channel || 'APP'\n    },\n    CdtTrfTxInf: {\n      PmtId: { EndToEndId: endToEndId },\n      IntrBkSttlmAmt: { Amt: amountValue, Ccy: overrides.currency || 'USD' },\n      DbtrAcctId: { IBAN: debtorIban },\n      CdtrAcctId: { IBAN: creditorIban },\n      Prtry: {\n        CustRef: overrides.customerReference || 'QA22',\n        ChanRef: overrides.channelReference || (overrides.channel === 'QR' ? 'QRPANAPAY' : 'TERM001'),\n        AgtRef: overrides.agentReference || 'AGT0002'\n      }\n    }\n  };\n  if (overrides.prtryOverrides){\n    Object.keys(overrides.prtryOverrides).forEach(function(key){\n      payload.CdtTrfTxInf.Prtry[key] = overrides.prtryOverrides[key];\n    });\n  }\n  if (overrides.overrideHeaders){\n    payload.GrpHdr.instgAgt = overrides.overrideHeaders.instgAgt || payload.GrpHdr.instgAgt;\n    payload.GrpHdr.InstdAgt = overrides.overrideHeaders.instdAgt || payload.GrpHdr.InstdAgt;\n  }\n  return payload;\n}","index":9,"text":"def buildPayload ="}},{"result":{"nanos":244600,"millis":0.2446,"status":"passed"},"step":{"endLine":150,"background":true,"line":111,"prefix":"*","docString":"function(body, expectation){\n  expectation = expectation || {};\n  var txInfo = (body && body.CdtTrfTxInf) ? body.CdtTrfTxInf : {};\n  var outcome = expectation.outcome || 'success';\n  var requireTxOk = expectation.requireTxOk === true;\n  var requireTxReject = expectation.requireTxReject === true;\n  var expectedTxStatus = expectation.expectedTxStatus;\n  if (expectedTxStatus != null){\n    karate.match(txInfo.TxSts, expectedTxStatus);\n  } else if (outcome === 'success' && requireTxOk){\n    karate.match(txInfo.TxSts, 'Ok');\n  } else if (outcome === 'reject' && requireTxReject){\n    karate.match(txInfo.TxSts, '#? _ && _ != \"Ok\"');\n  } else {\n    if (txInfo && txInfo.TxSts){\n      karate.log('TxSts recibido:', txInfo.TxSts, '- no se valida estrictamente.');\n    } else {\n      karate.log('Sin TxSts en la respuesta, continuando sin validacion.');\n    }\n  }\n  if (outcome === 'pending'){\n    karate.match(txInfo.TxSts, '#? _ == \"PENDING\" || _ == \"PROC\"');\n  }\n  if (expectation.reasonCode){\n    var reasonNode = txInfo.Rsn || {};\n    karate.match(reasonNode.RsnCd, expectation.reasonCode);\n  }\n  if (expectation.expectedEndToEndId){\n    karate.match(txInfo.PmtId.EndToEndId, expectation.expectedEndToEndId);\n  }\n  if (expectation.expectedMsgId){\n    var grpHdr = (body && body.GrpHdr) ? body.GrpHdr : {};\n    karate.match(grpHdr.msgId, expectation.expectedMsgId);\n  }\n}","index":10,"text":"def verifyTransferOutcome ="}},{"result":{"nanos":192800,"millis":0.1928,"status":"passed"},"step":{"endLine":156,"background":true,"line":151,"prefix":"*","docString":"function(name, payload, responseBody, status){\n  karate.log('[Transfer]', name, '| status:', status, '| msgId:', payload.GrpHdr.msgId, '| endToEnd:', payload.CdtTrfTxInf.PmtId.EndToEndId);\n}","index":11,"text":"def logTransferSummary ="}},{"result":{"nanos":7596800,"millis":7.5968,"status":"passed"},"step":{"line":192,"prefix":"*","index":0,"text":"def payload = buildPayload({ debtorAccountType: 'CTA_CORRIENTE', creditorAccountType: 'CTA_CORRIENTE', creditorEntity: '0303' })"}},{"result":{"nanos":902500,"millis":0.9025,"status":"passed"},"step":{"line":193,"prefix":"*","index":1,"text":"def expectation = { httpStatus: 200, outcome: 'success', expectedEndToEndId: payload.CdtTrfTxInf.PmtId.EndToEndId }"}},{"result":{"nanos":1066300,"millis":1.0663,"status":"passed"},"step":{"line":194,"prefix":"*","index":2,"text":"def normalizedStatus = normalizeStatus(expectation.httpStatus)"}},{"result":{"nanos":302500,"millis":0.3025,"status":"passed"},"step":{"line":195,"prefix":"Given","index":3,"text":"path 'finan', 'transferencia'"}},{"result":{"nanos":416600,"millis":0.4166,"status":"passed"},"step":{"line":196,"prefix":"And","index":4,"text":"request payload"}},{"result":{"nanos":1991202600,"millis":1991.2026,"status":"passed"},"step":{"line":197,"prefix":"When","index":5,"text":"method post"},"stepLog":"14:14:31.819 request:\n1 > POST https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral\/finan\/transferencia\n1 > Content-Type: application\/json; charset=UTF-8\n1 > Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2dUJWTkN6VlViUFBlTFdReEM0WDAyYVM3UnM2UGRYV1dja1dfc0xZMHlFIn0.eyJleHAiOjE3NjExNjA3NTAsImlhdCI6MTc2MTE2MDQ1MCwianRpIjoidHJydGNjOjQ5Yjg0NDVjLTgzYTAtMjI4Ni02NDczLWE2ZGEzOTBhOWQ0YSIsImlzcyI6Imh0dHBzOi8vYXV0ZW50aWNhY2lvbnFhLmNvb25lY3RhLmNvbS5lYy9hdXRoL3JlYWxtcy9QQU5BUEFZIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6Ijk5OGMyZmUwLTJjOGYtNGQwNC1iZjExLWY1OWExZTM5ODg3MyIsInR5cCI6IkJlYXJlciIsImF6cCI6IjAyMDVjYiIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiLyoiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRlZmF1bHQtcm9sZXMtYWRtaW5wYW5hcGF5Iiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7IjAyMDVjYiI6eyJyb2xlcyI6WyJ1bWFfcHJvdGVjdGlvbiJdfSwiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJjbGllbnRIb3N0IjoiMTAuMTAuMTAuMTUxIiwicHJlZmVycmVkX3VzZXJuYW1lIjoic2VydmljZS1hY2NvdW50LTAyMDVjYiIsImNsaWVudEFkZHJlc3MiOiIxMC4xMC4xMC4xNTEiLCJjbGllbnRfaWQiOiIwMjA1Y2IifQ.bATUogohrEqy7Voa4mFnsBzOnGy6tnjZGh_lOYRn-0hWXMY_fz-280nTu2Vv68eO3HeoewtWlt45S_iLI2-ml3pqpAlt3DXWVmLvVHw6d7TICHBfQsa0jGXMexKnyar7EinrVhF3deSK25Ap_ajC_82EvVvXrVG-7p9F1dEdq39y2R72JympejF5uhY_z_jNmqJSsnLEZVOo3WMJn76u9tTcYVIldC5uWGFWbPGEhvWPx4ZGpsuq_wrPOGdRmyJDFJPJl7LnLGHK0DBhuVtJUq_NFQkMus2fTTf_mWhRnoqNU-wUCS-fxMs6QusGzIVd-C3O29J3rerHTrGg21LAsQ\n1 > Content-Length: 509\n1 > Host: apipanapayqa.coonecta.com.ec\n1 > Connection: Keep-Alive\n1 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/17.0.12)\n1 > Accept-Encoding: gzip,deflate\n{\"GrpHdr\":{\"msgId\":\"02052025102254033468134\",\"creDtTm\":\"2025-10-22T14:14:31\",\"nbOfTxs\":1,\"sttlmInf\":{\"sttlmMtd\":\"INGA\"},\"instgAgt\":{\"finInstnId\":\"0205\"},\"InstdAgt\":{\"FinInstnId\":\"0303\"},\"Mge\":{\"Type\":\"acmt.998.321.01\"},\"ChnlId\":\"APP\"},\"CdtTrfTxInf\":{\"PmtId\":{\"EndToEndId\":\"02052025102286479\"},\"IntrBkSttlmAmt\":{\"Amt\":1,\"Ccy\":\"USD\"},\"DbtrAcctId\":{\"IBAN\":\"EC0402051000000000020101002318\"},\"CdtrAcctId\":{\"IBAN\":\"EC0403031000000000030101002222\"},\"Prtry\":{\"CustRef\":\"QA22\",\"ChanRef\":\"TERM001\",\"AgtRef\":\"AGT0002\"}}}\n\n14:14:33.807 response time in milliseconds: 1983\n1 < 400\n1 < Date: Wed, 22 Oct 2025 19:14:26 GMT\n1 < Content-Type: application\/json; charset=utf-8\n1 < Transfer-Encoding: chunked\n1 < Connection: keep-alive\n1 < Server: Kestrel\n1 < Set-Cookie: ARRAffinity=135f536e0d078a815c3b83fda3468ab8a3a2abc604a35eefb28648d3961cfa9b;Path=\/;HttpOnly;Secure;Domain=app-apipanapay-qa.azurewebsites.net\n1 < Set-Cookie: ARRAffinitySameSite=135f536e0d078a815c3b83fda3468ab8a3a2abc604a35eefb28648d3961cfa9b;Path=\/;HttpOnly;SameSite=None;Secure;Domain=app-apipanapay-qa.azurewebsites.net\n1 < Request-Context: appId=cid-v1:a7a77847-2713-450f-9030-b350a2d54a28\n1 < X-Powered-By: ASP.NET\n1 < X-ARR-ClientCert: -----BEGIN%20CERTIFICATE-----%0AMIIEHDCCAgSgAwIBAgIUZIZBO0fb7VZ4KXrs01S4RYbWyJ8wDQYJKoZIhvcNAQEL%0ABQAwJTEjMCEGA1UEAwwacm9vdGNlcnQuY2JpYmxpYW4uaW50ZXJuYWwwHhcNMjUw%0AODEzMTMyNTU5WhcNMjgwODEyMTMyNTU5WjAnMSUwIwYDVQQDDBxjbGllbnRjZXJ0%0ALmNiaWJsaWFuLmludGVybmFsMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKC%0AAQEAskUDap6NmyYq8RT6F7z3DpZGQiflNQTvUT84TmxsKXEBRAkgINnkJqgKkd7f%0ASEybzqglQTbr4s41lCiPsy3X66qYjU2L%2Bojhni%2BOCVOX7n3JBYovL%2FqfMP3%2FkhZP%0AQIlK%2FQWPcrnl39fYkGOQv%2BYqoCGEPzGkib2m1Ma5Q1HOCKh1ErMjqTLGy%2ByJj6JY%0AiZvMx3YrJSvjUS0uKpNwxPtGyiexRfKsmR%2FHqPzRHa0iY%2B752KSgUedwJPv1Wod%2B%0AY9BMAMIdU25UtkUEsaOYtorGWDaZSn2Bl0LYmP87kjcYypnHx0jtPtUCXfVHrE6u%0AZnDRFYsZbeXylY3mJkyOL2DzZwIDAQABo0IwQDAdBgNVHQ4EFgQURPhJwTAcUWUp%0ArOqQO68P%2FbJoqjMwHwYDVR0jBBgwFoAU7GdlxoSeEXucEXhjadHRC9xzS0UwDQYJ%0AKoZIhvcNAQELBQADggIBAGTnlyF2n%2F6s9phYbO8V17niO0BXB62ToX6gPhcw9f3y%0AhMui6RnrM1oiHlBWqZquCqYJ5ETvYJE1RqvoqtGysxCnIj0OTJHV4WtF3SHsd1Tu%0ATg%2B%2FUnGivtBTDQxj9sbAtCaSYRBqPByP8jvSTDgXR1mgOrEGjr2PZdZSoKLj4OHi%0A9UCMJw7pJsyA4lbroKshQTYv5Ks5SqtJpdp0%2BUX0UUlbPJqXiadfbKdoXvEgcwbP%0ACqR9v7kGYmNxfaGLNGVrV%2BnLawIDmdYXJE%2F4WJh6sHfiZxEsE%2BB4PoKADrb1Eapt%0AnSdHUgRfc0i5f2lcmErnU8nCMO5TWdHFOgpYwTS8w17FhNFZpaSmyZKM7uHcUs7y%0AUbuiQtdXocfSSMf%2FeycBEU%2FHAVIWQEqY%2BbJdC0q%2FR%2BsESeBtXd4IEIxR0QfgscGk%0AJyCSFC8z%2FvCgrRsH5rePqKO7%2FLAsDTP4GIQNFNfF4Wh6bsPXuJmvvoMcnmy%2F58Wo%0AE0XaG8UPHVAeyEmhncdM32E7SJbR91aRr2CkV23OoUz%2BwKG2%2FuObHmAkuMkCbbcz%0AJQoC7DZg5FGw%2BZR7v1DIBct5QNJQ8bG%2FXGRxjWC6dU7jrGhOF1X%2B2YYcdx9XnwyM%0A9YPxUy5bVfMhIiKP2wEso5fjOZ4RTvnB5R6zD3maJK%2FtZAXVhtyqXSkBYFi4MvEs%0A-----END%20CERTIFICATE-----%0A\n{\"GrpHdr\":{\"MsgId\":\"000020251022020357\",\"CreDtTm\":\"2025-10-22T14:14:25\",\"NbOfTxs\":1,\"SttlmInf\":{\"SttlmMtd\":\"INGA\"},\"InstgAgt\":{\"FinInstnId\":\"0205\"},\"InstdAgt\":{\"FinInstnId\":\"0303\"},\"Mge\":{\"Type\":\"acmt.998.322.001\"},\"ChnlId\":\"APP\"},\"CdtTrfTxInf\":{\"OrgnGrpInf\":{\"OrgnlMsgId\":\"02052025102254033468134\",\"OrgnlMgeType\":\"acmt.998.321.01\",\"OrgnlCreDtTm\":\"2025-10-22T14:14:31\"},\"TxSts\":\"ERR\",\"Rsn\":{\"RsnCd\":\"AB09\",\"AddtlInf\":\"No se encontró la Entidad Financiera receptora.\"},\"SttlmDt\":\"2025-10-22\"}}\n\n"},{"result":{"nanos":0,"errorMessage":"no step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:198","millis":0.0,"status":"failed"},"step":{"line":198,"prefix":"Then","index":6,"text":"match responseStatus in normalizedStatus"},"stepLog":"14:14:33.807 classpath:Transferencia.feature:198\nThen match responseStatus in normalizedStatus\nno step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:198\n"},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":199,"prefix":"*","index":7,"text":"eval verifyTransferOutcome(response, expectation)"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":200,"prefix":"*","index":8,"text":"eval logTransferSummary('Inter-IFI Corriente', payload, response, responseStatus)"}}],"line":191,"description":"","durationMillis":2014.5727,"failed":true,"error":"no step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:198","tags":["transferencia"],"executorName":"main","name":"Transferencia exitosa entre dos clientes de diferentes entidades (ordenante local CTA Corriente, receptor intraredes CTA Corriente)","startTime":1761160471779,"refId":"[4:191]","endTime":1761160473807,"exampleIndex":-1},{"sectionIndex":4,"stepResults":[{"result":{"nanos":4307400,"millis":4.3074,"status":"passed"},"step":{"background":true,"line":5,"prefix":"*","index":0,"text":"def tokenContext = callonce read('classpath:helpers\/generate-token.feature')"},"stepLog":"14:14:33.835 key store key count for classpath:certificado\/clientcert.cbiblian.internal 1.pfx: 1\n"},{"result":{"nanos":412100,"millis":0.4121,"status":"passed"},"step":{"background":true,"line":6,"prefix":"*","index":1,"text":"def tokenData = tokenContext.tokenInfo"}},{"result":{"nanos":500100,"millis":0.5001,"status":"passed"},"step":{"background":true,"line":7,"prefix":"*","index":2,"text":"def transferenciaBaseUrl = karate.properties['transfer.baseUrl'] || 'https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral'"}},{"result":{"nanos":2924500,"millis":2.9245,"status":"passed"},"step":{"background":true,"line":8,"prefix":"*","index":3,"text":"url transferenciaBaseUrl"}},{"result":{"nanos":932700,"millis":0.9327,"status":"passed"},"step":{"background":true,"line":9,"prefix":"*","index":4,"text":"def authHeaders = { 'Content-Type': 'application\/json' }"}},{"result":{"nanos":2313600,"millis":2.3136,"status":"passed"},"step":{"background":true,"line":10,"prefix":"*","index":5,"text":"set authHeaders.Authorization = 'Bearer ' + tokenData.auth_tokencb"}},{"result":{"nanos":195200,"millis":0.1952,"status":"passed"},"step":{"background":true,"line":11,"prefix":"*","index":6,"text":"configure headers = authHeaders"}},{"result":{"nanos":514600,"millis":0.5146,"status":"passed"},"step":{"endLine":24,"background":true,"line":12,"prefix":"*","docString":"{\n  \"0205\": {\n    \"CTA_AHORROS\": \"EC5002051000000000020501052673\",\n    \"CTA_CORRIENTE\": \"EC0402051000000000020101002318\"\n  },\n  \"0303\": {\n    \"CTA_AHORROS\": \"EC5003031000000000030301051111\",\n    \"CTA_CORRIENTE\": \"EC0403031000000000030101002222\"\n  }\n}","index":7,"text":"def accountCatalog ="}},{"result":{"nanos":653200,"millis":0.6532,"status":"passed"},"step":{"endLine":39,"background":true,"line":25,"prefix":"*","docString":"function(value){\n  var list;\n  if (!value && value !== 0){\n    list = [200];\n  } else {\n    list = Array.isArray(value) ? value.slice(0) : [value];\n  }\n  if (list.indexOf(200) === -1){\n    list.push(200);\n  }\n  return list;\n}","index":8,"text":"def normalizeStatus ="}},{"result":{"nanos":704100,"millis":0.7041,"status":"passed"},"step":{"endLine":110,"background":true,"line":40,"prefix":"*","docString":"function(overrides){\n  overrides = overrides || {};\n  var token = karate.get('tokenData');\n  var catalog = karate.get('accountCatalog');\n  var LocalDateTime = Java.type('java.time.LocalDateTime');\n  var DateTimeFormatter = Java.type('java.time.format.DateTimeFormatter');\n  var timestamp = LocalDateTime.now().format(DateTimeFormatter.ofPattern(\"yyyy-MM-dd'T'HH:mm:ss\"));\n  var randomDigits = function(length){\n    var digits = '';\n    for (var i = 0; i < length; i++){\n      digits += Math.floor(Math.random() * 10);\n    }\n    return digits;\n  };\n  var coopCode = overrides.instgAgtFinInstId || token.coop_codecb || '0205';\n  var debtorType = overrides.debtorAccountType || 'CTA_AHORROS';\n  var creditorType = overrides.creditorAccountType || 'CTA_CORRIENTE';\n  var creditorEntity = overrides.creditorEntity || overrides.instdAgtFinInstId || coopCode;\n  var debtorAccounts = catalog[coopCode] || catalog['0205'];\n  var creditorAccounts = catalog[creditorEntity] || catalog['0303'];\n  var debtorIban = overrides.debtorIban || (debtorAccounts ? (debtorAccounts[debtorType] || debtorAccounts['CTA_AHORROS']) : 'EC5002051000000000020501052673');\n  var creditorIban = overrides.creditorIban || (creditorAccounts ? (creditorAccounts[creditorType] || creditorAccounts['CTA_CORRIENTE']) : 'EC0403031000000000030101002222');\n  if (overrides.sameIban){\n    creditorIban = debtorIban;\n  }\n  var msgId = overrides.msgId || (coopCode + token.currentDate + randomDigits(11));\n  var endToEndId = overrides.endToEndId || (coopCode + token.currentDate + randomDigits(5));\n  var amountValue = overrides.amount != null ? overrides.amount : 1.00;\n  var payload = {\n    GrpHdr: {\n      msgId: msgId,\n      creDtTm: timestamp,\n      nbOfTxs: overrides.nbOfTxs || 1,\n      sttlmInf: { sttlmMtd: overrides.settlementMethod || 'INGA' },\n      instgAgt: { finInstnId: coopCode },\n      InstdAgt: { FinInstnId: overrides.instdAgtFinInstId || creditorEntity },\n      Mge: { Type: overrides.messageType || 'acmt.998.321.01' },\n      ChnlId: overrides.channel || 'APP'\n    },\n    CdtTrfTxInf: {\n      PmtId: { EndToEndId: endToEndId },\n      IntrBkSttlmAmt: { Amt: amountValue, Ccy: overrides.currency || 'USD' },\n      DbtrAcctId: { IBAN: debtorIban },\n      CdtrAcctId: { IBAN: creditorIban },\n      Prtry: {\n        CustRef: overrides.customerReference || 'QA22',\n        ChanRef: overrides.channelReference || (overrides.channel === 'QR' ? 'QRPANAPAY' : 'TERM001'),\n        AgtRef: overrides.agentReference || 'AGT0002'\n      }\n    }\n  };\n  if (overrides.prtryOverrides){\n    Object.keys(overrides.prtryOverrides).forEach(function(key){\n      payload.CdtTrfTxInf.Prtry[key] = overrides.prtryOverrides[key];\n    });\n  }\n  if (overrides.overrideHeaders){\n    payload.GrpHdr.instgAgt = overrides.overrideHeaders.instgAgt || payload.GrpHdr.instgAgt;\n    payload.GrpHdr.InstdAgt = overrides.overrideHeaders.instdAgt || payload.GrpHdr.InstdAgt;\n  }\n  return payload;\n}","index":9,"text":"def buildPayload ="}},{"result":{"nanos":309800,"millis":0.3098,"status":"passed"},"step":{"endLine":150,"background":true,"line":111,"prefix":"*","docString":"function(body, expectation){\n  expectation = expectation || {};\n  var txInfo = (body && body.CdtTrfTxInf) ? body.CdtTrfTxInf : {};\n  var outcome = expectation.outcome || 'success';\n  var requireTxOk = expectation.requireTxOk === true;\n  var requireTxReject = expectation.requireTxReject === true;\n  var expectedTxStatus = expectation.expectedTxStatus;\n  if (expectedTxStatus != null){\n    karate.match(txInfo.TxSts, expectedTxStatus);\n  } else if (outcome === 'success' && requireTxOk){\n    karate.match(txInfo.TxSts, 'Ok');\n  } else if (outcome === 'reject' && requireTxReject){\n    karate.match(txInfo.TxSts, '#? _ && _ != \"Ok\"');\n  } else {\n    if (txInfo && txInfo.TxSts){\n      karate.log('TxSts recibido:', txInfo.TxSts, '- no se valida estrictamente.');\n    } else {\n      karate.log('Sin TxSts en la respuesta, continuando sin validacion.');\n    }\n  }\n  if (outcome === 'pending'){\n    karate.match(txInfo.TxSts, '#? _ == \"PENDING\" || _ == \"PROC\"');\n  }\n  if (expectation.reasonCode){\n    var reasonNode = txInfo.Rsn || {};\n    karate.match(reasonNode.RsnCd, expectation.reasonCode);\n  }\n  if (expectation.expectedEndToEndId){\n    karate.match(txInfo.PmtId.EndToEndId, expectation.expectedEndToEndId);\n  }\n  if (expectation.expectedMsgId){\n    var grpHdr = (body && body.GrpHdr) ? body.GrpHdr : {};\n    karate.match(grpHdr.msgId, expectation.expectedMsgId);\n  }\n}","index":10,"text":"def verifyTransferOutcome ="}},{"result":{"nanos":182000,"millis":0.182,"status":"passed"},"step":{"endLine":156,"background":true,"line":151,"prefix":"*","docString":"function(name, payload, responseBody, status){\n  karate.log('[Transfer]', name, '| status:', status, '| msgId:', payload.GrpHdr.msgId, '| endToEnd:', payload.CdtTrfTxInf.PmtId.EndToEndId);\n}","index":11,"text":"def logTransferSummary ="}},{"result":{"nanos":9128400,"millis":9.1284,"status":"passed"},"step":{"line":203,"prefix":"*","index":0,"text":"def payload = buildPayload({ sameIban: true })"}},{"result":{"nanos":568500,"millis":0.5685,"status":"passed"},"step":{"line":204,"prefix":"*","index":1,"text":"def expectation = { httpStatus: [400, 409, 422], outcome: 'reject' }"}},{"result":{"nanos":44083900,"millis":44.0839,"status":"passed"},"step":{"line":205,"prefix":"*","index":2,"text":"def normalizedStatus = normalizeStatus(expectation.httpStatus)"}},{"result":{"nanos":270000,"millis":0.27,"status":"passed"},"step":{"line":206,"prefix":"Given","index":3,"text":"path 'finan', 'transferencia'"}},{"result":{"nanos":93000,"millis":0.093,"status":"passed"},"step":{"line":207,"prefix":"And","index":4,"text":"request payload"}},{"result":{"nanos":1679625600,"millis":1679.6256,"status":"passed"},"step":{"line":208,"prefix":"When","index":5,"text":"method post"},"stepLog":"14:14:33.912 request:\n1 > POST https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral\/finan\/transferencia\n1 > Content-Type: application\/json; charset=UTF-8\n1 > Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2dUJWTkN6VlViUFBlTFdReEM0WDAyYVM3UnM2UGRYV1dja1dfc0xZMHlFIn0.eyJleHAiOjE3NjExNjA3NTAsImlhdCI6MTc2MTE2MDQ1MCwianRpIjoidHJydGNjOjQ5Yjg0NDVjLTgzYTAtMjI4Ni02NDczLWE2ZGEzOTBhOWQ0YSIsImlzcyI6Imh0dHBzOi8vYXV0ZW50aWNhY2lvbnFhLmNvb25lY3RhLmNvbS5lYy9hdXRoL3JlYWxtcy9QQU5BUEFZIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6Ijk5OGMyZmUwLTJjOGYtNGQwNC1iZjExLWY1OWExZTM5ODg3MyIsInR5cCI6IkJlYXJlciIsImF6cCI6IjAyMDVjYiIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiLyoiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRlZmF1bHQtcm9sZXMtYWRtaW5wYW5hcGF5Iiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7IjAyMDVjYiI6eyJyb2xlcyI6WyJ1bWFfcHJvdGVjdGlvbiJdfSwiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJjbGllbnRIb3N0IjoiMTAuMTAuMTAuMTUxIiwicHJlZmVycmVkX3VzZXJuYW1lIjoic2VydmljZS1hY2NvdW50LTAyMDVjYiIsImNsaWVudEFkZHJlc3MiOiIxMC4xMC4xMC4xNTEiLCJjbGllbnRfaWQiOiIwMjA1Y2IifQ.bATUogohrEqy7Voa4mFnsBzOnGy6tnjZGh_lOYRn-0hWXMY_fz-280nTu2Vv68eO3HeoewtWlt45S_iLI2-ml3pqpAlt3DXWVmLvVHw6d7TICHBfQsa0jGXMexKnyar7EinrVhF3deSK25Ap_ajC_82EvVvXrVG-7p9F1dEdq39y2R72JympejF5uhY_z_jNmqJSsnLEZVOo3WMJn76u9tTcYVIldC5uWGFWbPGEhvWPx4ZGpsuq_wrPOGdRmyJDFJPJl7LnLGHK0DBhuVtJUq_NFQkMus2fTTf_mWhRnoqNU-wUCS-fxMs6QusGzIVd-C3O29J3rerHTrGg21LAsQ\n1 > Content-Length: 509\n1 > Host: apipanapayqa.coonecta.com.ec\n1 > Connection: Keep-Alive\n1 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/17.0.12)\n1 > Accept-Encoding: gzip,deflate\n{\"GrpHdr\":{\"msgId\":\"02052025102257623160483\",\"creDtTm\":\"2025-10-22T14:14:33\",\"nbOfTxs\":1,\"sttlmInf\":{\"sttlmMtd\":\"INGA\"},\"instgAgt\":{\"finInstnId\":\"0205\"},\"InstdAgt\":{\"FinInstnId\":\"0205\"},\"Mge\":{\"Type\":\"acmt.998.321.01\"},\"ChnlId\":\"APP\"},\"CdtTrfTxInf\":{\"PmtId\":{\"EndToEndId\":\"02052025102284731\"},\"IntrBkSttlmAmt\":{\"Amt\":1,\"Ccy\":\"USD\"},\"DbtrAcctId\":{\"IBAN\":\"EC5002051000000000020501052673\"},\"CdtrAcctId\":{\"IBAN\":\"EC5002051000000000020501052673\"},\"Prtry\":{\"CustRef\":\"QA22\",\"ChanRef\":\"TERM001\",\"AgtRef\":\"AGT0002\"}}}\n\n14:14:35.590 response time in milliseconds: 1676\n1 < 400\n1 < Date: Wed, 22 Oct 2025 19:14:26 GMT\n1 < Content-Type: application\/json; charset=utf-8\n1 < Transfer-Encoding: chunked\n1 < Connection: keep-alive\n1 < Server: Kestrel\n1 < Set-Cookie: ARRAffinity=135f536e0d078a815c3b83fda3468ab8a3a2abc604a35eefb28648d3961cfa9b;Path=\/;HttpOnly;Secure;Domain=app-apipanapay-qa.azurewebsites.net\n1 < Set-Cookie: ARRAffinitySameSite=135f536e0d078a815c3b83fda3468ab8a3a2abc604a35eefb28648d3961cfa9b;Path=\/;HttpOnly;SameSite=None;Secure;Domain=app-apipanapay-qa.azurewebsites.net\n1 < Request-Context: appId=cid-v1:a7a77847-2713-450f-9030-b350a2d54a28\n1 < X-Powered-By: ASP.NET\n1 < X-ARR-ClientCert: -----BEGIN%20CERTIFICATE-----%0AMIIEHDCCAgSgAwIBAgIUZIZBO0fb7VZ4KXrs01S4RYbWyJ8wDQYJKoZIhvcNAQEL%0ABQAwJTEjMCEGA1UEAwwacm9vdGNlcnQuY2JpYmxpYW4uaW50ZXJuYWwwHhcNMjUw%0AODEzMTMyNTU5WhcNMjgwODEyMTMyNTU5WjAnMSUwIwYDVQQDDBxjbGllbnRjZXJ0%0ALmNiaWJsaWFuLmludGVybmFsMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKC%0AAQEAskUDap6NmyYq8RT6F7z3DpZGQiflNQTvUT84TmxsKXEBRAkgINnkJqgKkd7f%0ASEybzqglQTbr4s41lCiPsy3X66qYjU2L%2Bojhni%2BOCVOX7n3JBYovL%2FqfMP3%2FkhZP%0AQIlK%2FQWPcrnl39fYkGOQv%2BYqoCGEPzGkib2m1Ma5Q1HOCKh1ErMjqTLGy%2ByJj6JY%0AiZvMx3YrJSvjUS0uKpNwxPtGyiexRfKsmR%2FHqPzRHa0iY%2B752KSgUedwJPv1Wod%2B%0AY9BMAMIdU25UtkUEsaOYtorGWDaZSn2Bl0LYmP87kjcYypnHx0jtPtUCXfVHrE6u%0AZnDRFYsZbeXylY3mJkyOL2DzZwIDAQABo0IwQDAdBgNVHQ4EFgQURPhJwTAcUWUp%0ArOqQO68P%2FbJoqjMwHwYDVR0jBBgwFoAU7GdlxoSeEXucEXhjadHRC9xzS0UwDQYJ%0AKoZIhvcNAQELBQADggIBAGTnlyF2n%2F6s9phYbO8V17niO0BXB62ToX6gPhcw9f3y%0AhMui6RnrM1oiHlBWqZquCqYJ5ETvYJE1RqvoqtGysxCnIj0OTJHV4WtF3SHsd1Tu%0ATg%2B%2FUnGivtBTDQxj9sbAtCaSYRBqPByP8jvSTDgXR1mgOrEGjr2PZdZSoKLj4OHi%0A9UCMJw7pJsyA4lbroKshQTYv5Ks5SqtJpdp0%2BUX0UUlbPJqXiadfbKdoXvEgcwbP%0ACqR9v7kGYmNxfaGLNGVrV%2BnLawIDmdYXJE%2F4WJh6sHfiZxEsE%2BB4PoKADrb1Eapt%0AnSdHUgRfc0i5f2lcmErnU8nCMO5TWdHFOgpYwTS8w17FhNFZpaSmyZKM7uHcUs7y%0AUbuiQtdXocfSSMf%2FeycBEU%2FHAVIWQEqY%2BbJdC0q%2FR%2BsESeBtXd4IEIxR0QfgscGk%0AJyCSFC8z%2FvCgrRsH5rePqKO7%2FLAsDTP4GIQNFNfF4Wh6bsPXuJmvvoMcnmy%2F58Wo%0AE0XaG8UPHVAeyEmhncdM32E7SJbR91aRr2CkV23OoUz%2BwKG2%2FuObHmAkuMkCbbcz%0AJQoC7DZg5FGw%2BZR7v1DIBct5QNJQ8bG%2FXGRxjWC6dU7jrGhOF1X%2B2YYcdx9XnwyM%0A9YPxUy5bVfMhIiKP2wEso5fjOZ4RTvnB5R6zD3maJK%2FtZAXVhtyqXSkBYFi4MvEs%0A-----END%20CERTIFICATE-----%0A\n{\"GrpHdr\":{\"MsgId\":\"000020251022020358\",\"CreDtTm\":\"2025-10-22T14:14:27\",\"NbOfTxs\":1,\"SttlmInf\":{\"SttlmMtd\":\"INGA\"},\"InstgAgt\":{\"FinInstnId\":\"0205\"},\"InstdAgt\":{\"FinInstnId\":\"0205\"},\"Mge\":{\"Type\":\"acmt.998.322.001\"},\"ChnlId\":\"APP\"},\"CdtTrfTxInf\":{\"OrgnGrpInf\":{\"OrgnlMsgId\":\"02052025102257623160483\",\"OrgnlMgeType\":\"acmt.998.321.01\",\"OrgnlCreDtTm\":\"2025-10-22T14:14:33\"},\"TxSts\":\"ERR\",\"Rsn\":{\"RsnCd\":\"6005\",\"AddtlInf\":\"Ambos IBAN son iguales.\"},\"SttlmDt\":\"2025-10-22\"}}\n\n"},{"result":{"nanos":0,"errorMessage":"no step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:209","millis":0.0,"status":"failed"},"step":{"line":209,"prefix":"Then","index":6,"text":"match responseStatus in normalizedStatus"},"stepLog":"14:14:35.590 classpath:Transferencia.feature:209\nThen match responseStatus in normalizedStatus\nno step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:209\n"},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":210,"prefix":"*","index":7,"text":"eval verifyTransferOutcome(response, expectation)"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":211,"prefix":"*","index":8,"text":"eval logTransferSummary('Fallo por IBAN duplicado', payload, response, responseStatus)"}}],"line":202,"description":"","durationMillis":1747.7187,"failed":true,"error":"no step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:209","tags":["transferencia"],"executorName":"main","name":"Transferencia no exitosa, el codigo IBAN es el mismo del ordenante y receptor","startTime":1761160473827,"refId":"[5:202]","endTime":1761160475590,"exampleIndex":-1},{"sectionIndex":5,"stepResults":[{"result":{"nanos":3663000,"millis":3.663,"status":"passed"},"step":{"background":true,"line":5,"prefix":"*","index":0,"text":"def tokenContext = callonce read('classpath:helpers\/generate-token.feature')"},"stepLog":"14:14:35.612 key store key count for classpath:certificado\/clientcert.cbiblian.internal 1.pfx: 1\n"},{"result":{"nanos":306800,"millis":0.3068,"status":"passed"},"step":{"background":true,"line":6,"prefix":"*","index":1,"text":"def tokenData = tokenContext.tokenInfo"}},{"result":{"nanos":909300,"millis":0.9093,"status":"passed"},"step":{"background":true,"line":7,"prefix":"*","index":2,"text":"def transferenciaBaseUrl = karate.properties['transfer.baseUrl'] || 'https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral'"}},{"result":{"nanos":90400,"millis":0.0904,"status":"passed"},"step":{"background":true,"line":8,"prefix":"*","index":3,"text":"url transferenciaBaseUrl"}},{"result":{"nanos":431400,"millis":0.4314,"status":"passed"},"step":{"background":true,"line":9,"prefix":"*","index":4,"text":"def authHeaders = { 'Content-Type': 'application\/json' }"}},{"result":{"nanos":843500,"millis":0.8435,"status":"passed"},"step":{"background":true,"line":10,"prefix":"*","index":5,"text":"set authHeaders.Authorization = 'Bearer ' + tokenData.auth_tokencb"}},{"result":{"nanos":70000,"millis":0.07,"status":"passed"},"step":{"background":true,"line":11,"prefix":"*","index":6,"text":"configure headers = authHeaders"}},{"result":{"nanos":191800,"millis":0.1918,"status":"passed"},"step":{"endLine":24,"background":true,"line":12,"prefix":"*","docString":"{\n  \"0205\": {\n    \"CTA_AHORROS\": \"EC5002051000000000020501052673\",\n    \"CTA_CORRIENTE\": \"EC0402051000000000020101002318\"\n  },\n  \"0303\": {\n    \"CTA_AHORROS\": \"EC5003031000000000030301051111\",\n    \"CTA_CORRIENTE\": \"EC0403031000000000030101002222\"\n  }\n}","index":7,"text":"def accountCatalog ="}},{"result":{"nanos":259100,"millis":0.2591,"status":"passed"},"step":{"endLine":39,"background":true,"line":25,"prefix":"*","docString":"function(value){\n  var list;\n  if (!value && value !== 0){\n    list = [200];\n  } else {\n    list = Array.isArray(value) ? value.slice(0) : [value];\n  }\n  if (list.indexOf(200) === -1){\n    list.push(200);\n  }\n  return list;\n}","index":8,"text":"def normalizeStatus ="}},{"result":{"nanos":268700,"millis":0.2687,"status":"passed"},"step":{"endLine":110,"background":true,"line":40,"prefix":"*","docString":"function(overrides){\n  overrides = overrides || {};\n  var token = karate.get('tokenData');\n  var catalog = karate.get('accountCatalog');\n  var LocalDateTime = Java.type('java.time.LocalDateTime');\n  var DateTimeFormatter = Java.type('java.time.format.DateTimeFormatter');\n  var timestamp = LocalDateTime.now().format(DateTimeFormatter.ofPattern(\"yyyy-MM-dd'T'HH:mm:ss\"));\n  var randomDigits = function(length){\n    var digits = '';\n    for (var i = 0; i < length; i++){\n      digits += Math.floor(Math.random() * 10);\n    }\n    return digits;\n  };\n  var coopCode = overrides.instgAgtFinInstId || token.coop_codecb || '0205';\n  var debtorType = overrides.debtorAccountType || 'CTA_AHORROS';\n  var creditorType = overrides.creditorAccountType || 'CTA_CORRIENTE';\n  var creditorEntity = overrides.creditorEntity || overrides.instdAgtFinInstId || coopCode;\n  var debtorAccounts = catalog[coopCode] || catalog['0205'];\n  var creditorAccounts = catalog[creditorEntity] || catalog['0303'];\n  var debtorIban = overrides.debtorIban || (debtorAccounts ? (debtorAccounts[debtorType] || debtorAccounts['CTA_AHORROS']) : 'EC5002051000000000020501052673');\n  var creditorIban = overrides.creditorIban || (creditorAccounts ? (creditorAccounts[creditorType] || creditorAccounts['CTA_CORRIENTE']) : 'EC0403031000000000030101002222');\n  if (overrides.sameIban){\n    creditorIban = debtorIban;\n  }\n  var msgId = overrides.msgId || (coopCode + token.currentDate + randomDigits(11));\n  var endToEndId = overrides.endToEndId || (coopCode + token.currentDate + randomDigits(5));\n  var amountValue = overrides.amount != null ? overrides.amount : 1.00;\n  var payload = {\n    GrpHdr: {\n      msgId: msgId,\n      creDtTm: timestamp,\n      nbOfTxs: overrides.nbOfTxs || 1,\n      sttlmInf: { sttlmMtd: overrides.settlementMethod || 'INGA' },\n      instgAgt: { finInstnId: coopCode },\n      InstdAgt: { FinInstnId: overrides.instdAgtFinInstId || creditorEntity },\n      Mge: { Type: overrides.messageType || 'acmt.998.321.01' },\n      ChnlId: overrides.channel || 'APP'\n    },\n    CdtTrfTxInf: {\n      PmtId: { EndToEndId: endToEndId },\n      IntrBkSttlmAmt: { Amt: amountValue, Ccy: overrides.currency || 'USD' },\n      DbtrAcctId: { IBAN: debtorIban },\n      CdtrAcctId: { IBAN: creditorIban },\n      Prtry: {\n        CustRef: overrides.customerReference || 'QA22',\n        ChanRef: overrides.channelReference || (overrides.channel === 'QR' ? 'QRPANAPAY' : 'TERM001'),\n        AgtRef: overrides.agentReference || 'AGT0002'\n      }\n    }\n  };\n  if (overrides.prtryOverrides){\n    Object.keys(overrides.prtryOverrides).forEach(function(key){\n      payload.CdtTrfTxInf.Prtry[key] = overrides.prtryOverrides[key];\n    });\n  }\n  if (overrides.overrideHeaders){\n    payload.GrpHdr.instgAgt = overrides.overrideHeaders.instgAgt || payload.GrpHdr.instgAgt;\n    payload.GrpHdr.InstdAgt = overrides.overrideHeaders.instdAgt || payload.GrpHdr.InstdAgt;\n  }\n  return payload;\n}","index":9,"text":"def buildPayload ="}},{"result":{"nanos":203600,"millis":0.2036,"status":"passed"},"step":{"endLine":150,"background":true,"line":111,"prefix":"*","docString":"function(body, expectation){\n  expectation = expectation || {};\n  var txInfo = (body && body.CdtTrfTxInf) ? body.CdtTrfTxInf : {};\n  var outcome = expectation.outcome || 'success';\n  var requireTxOk = expectation.requireTxOk === true;\n  var requireTxReject = expectation.requireTxReject === true;\n  var expectedTxStatus = expectation.expectedTxStatus;\n  if (expectedTxStatus != null){\n    karate.match(txInfo.TxSts, expectedTxStatus);\n  } else if (outcome === 'success' && requireTxOk){\n    karate.match(txInfo.TxSts, 'Ok');\n  } else if (outcome === 'reject' && requireTxReject){\n    karate.match(txInfo.TxSts, '#? _ && _ != \"Ok\"');\n  } else {\n    if (txInfo && txInfo.TxSts){\n      karate.log('TxSts recibido:', txInfo.TxSts, '- no se valida estrictamente.');\n    } else {\n      karate.log('Sin TxSts en la respuesta, continuando sin validacion.');\n    }\n  }\n  if (outcome === 'pending'){\n    karate.match(txInfo.TxSts, '#? _ == \"PENDING\" || _ == \"PROC\"');\n  }\n  if (expectation.reasonCode){\n    var reasonNode = txInfo.Rsn || {};\n    karate.match(reasonNode.RsnCd, expectation.reasonCode);\n  }\n  if (expectation.expectedEndToEndId){\n    karate.match(txInfo.PmtId.EndToEndId, expectation.expectedEndToEndId);\n  }\n  if (expectation.expectedMsgId){\n    var grpHdr = (body && body.GrpHdr) ? body.GrpHdr : {};\n    karate.match(grpHdr.msgId, expectation.expectedMsgId);\n  }\n}","index":10,"text":"def verifyTransferOutcome ="}},{"result":{"nanos":165400,"millis":0.1654,"status":"passed"},"step":{"endLine":156,"background":true,"line":151,"prefix":"*","docString":"function(name, payload, responseBody, status){\n  karate.log('[Transfer]', name, '| status:', status, '| msgId:', payload.GrpHdr.msgId, '| endToEnd:', payload.CdtTrfTxInf.PmtId.EndToEndId);\n}","index":11,"text":"def logTransferSummary ="}},{"result":{"nanos":6033600,"millis":6.0336,"status":"passed"},"step":{"line":214,"prefix":"*","index":0,"text":"def payloadInicial = buildPayload()"}},{"result":{"nanos":1022200,"millis":1.0222,"status":"passed"},"step":{"line":215,"prefix":"*","index":1,"text":"def successExpectation = { httpStatus: 200, outcome: 'success', expectedEndToEndId: payloadInicial.CdtTrfTxInf.PmtId.EndToEndId }"}},{"result":{"nanos":2601300,"millis":2.6013,"status":"passed"},"step":{"line":216,"prefix":"*","index":2,"text":"def statusOk = normalizeStatus(successExpectation.httpStatus)"}},{"result":{"nanos":353000,"millis":0.353,"status":"passed"},"step":{"line":217,"prefix":"Given","index":3,"text":"path 'finan', 'transferencia'"}},{"result":{"nanos":114100,"millis":0.1141,"status":"passed"},"step":{"line":218,"prefix":"And","index":4,"text":"request payloadInicial"}},{"result":{"nanos":3581825100,"millis":3581.8251,"status":"passed"},"step":{"line":219,"prefix":"When","index":5,"text":"method post"},"stepLog":"14:14:35.640 request:\n1 > POST https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral\/finan\/transferencia\n1 > Content-Type: application\/json; charset=UTF-8\n1 > Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2dUJWTkN6VlViUFBlTFdReEM0WDAyYVM3UnM2UGRYV1dja1dfc0xZMHlFIn0.eyJleHAiOjE3NjExNjA3NTAsImlhdCI6MTc2MTE2MDQ1MCwianRpIjoidHJydGNjOjQ5Yjg0NDVjLTgzYTAtMjI4Ni02NDczLWE2ZGEzOTBhOWQ0YSIsImlzcyI6Imh0dHBzOi8vYXV0ZW50aWNhY2lvbnFhLmNvb25lY3RhLmNvbS5lYy9hdXRoL3JlYWxtcy9QQU5BUEFZIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6Ijk5OGMyZmUwLTJjOGYtNGQwNC1iZjExLWY1OWExZTM5ODg3MyIsInR5cCI6IkJlYXJlciIsImF6cCI6IjAyMDVjYiIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiLyoiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRlZmF1bHQtcm9sZXMtYWRtaW5wYW5hcGF5Iiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7IjAyMDVjYiI6eyJyb2xlcyI6WyJ1bWFfcHJvdGVjdGlvbiJdfSwiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJjbGllbnRIb3N0IjoiMTAuMTAuMTAuMTUxIiwicHJlZmVycmVkX3VzZXJuYW1lIjoic2VydmljZS1hY2NvdW50LTAyMDVjYiIsImNsaWVudEFkZHJlc3MiOiIxMC4xMC4xMC4xNTEiLCJjbGllbnRfaWQiOiIwMjA1Y2IifQ.bATUogohrEqy7Voa4mFnsBzOnGy6tnjZGh_lOYRn-0hWXMY_fz-280nTu2Vv68eO3HeoewtWlt45S_iLI2-ml3pqpAlt3DXWVmLvVHw6d7TICHBfQsa0jGXMexKnyar7EinrVhF3deSK25Ap_ajC_82EvVvXrVG-7p9F1dEdq39y2R72JympejF5uhY_z_jNmqJSsnLEZVOo3WMJn76u9tTcYVIldC5uWGFWbPGEhvWPx4ZGpsuq_wrPOGdRmyJDFJPJl7LnLGHK0DBhuVtJUq_NFQkMus2fTTf_mWhRnoqNU-wUCS-fxMs6QusGzIVd-C3O29J3rerHTrGg21LAsQ\n1 > Content-Length: 509\n1 > Host: apipanapayqa.coonecta.com.ec\n1 > Connection: Keep-Alive\n1 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/17.0.12)\n1 > Accept-Encoding: gzip,deflate\n{\"GrpHdr\":{\"msgId\":\"02052025102238008759834\",\"creDtTm\":\"2025-10-22T14:14:35\",\"nbOfTxs\":1,\"sttlmInf\":{\"sttlmMtd\":\"INGA\"},\"instgAgt\":{\"finInstnId\":\"0205\"},\"InstdAgt\":{\"FinInstnId\":\"0205\"},\"Mge\":{\"Type\":\"acmt.998.321.01\"},\"ChnlId\":\"APP\"},\"CdtTrfTxInf\":{\"PmtId\":{\"EndToEndId\":\"02052025102244963\"},\"IntrBkSttlmAmt\":{\"Amt\":1,\"Ccy\":\"USD\"},\"DbtrAcctId\":{\"IBAN\":\"EC5002051000000000020501052673\"},\"CdtrAcctId\":{\"IBAN\":\"EC0402051000000000020101002318\"},\"Prtry\":{\"CustRef\":\"QA22\",\"ChanRef\":\"TERM001\",\"AgtRef\":\"AGT0002\"}}}\n\n14:14:39.215 response time in milliseconds: 3369\n1 < 200\n1 < Date: Wed, 22 Oct 2025 19:14:31 GMT\n1 < Content-Type: application\/json; charset=utf-8\n1 < Transfer-Encoding: chunked\n1 < Connection: keep-alive\n1 < Server: Kestrel\n1 < Set-Cookie: ARRAffinity=135f536e0d078a815c3b83fda3468ab8a3a2abc604a35eefb28648d3961cfa9b;Path=\/;HttpOnly;Secure;Domain=app-apipanapay-qa.azurewebsites.net\n1 < Set-Cookie: ARRAffinitySameSite=135f536e0d078a815c3b83fda3468ab8a3a2abc604a35eefb28648d3961cfa9b;Path=\/;HttpOnly;SameSite=None;Secure;Domain=app-apipanapay-qa.azurewebsites.net\n1 < Vary: Accept-Encoding\n1 < Request-Context: appId=cid-v1:a7a77847-2713-450f-9030-b350a2d54a28\n1 < X-Powered-By: ASP.NET\n1 < X-ARR-ClientCert: -----BEGIN%20CERTIFICATE-----%0AMIIEHDCCAgSgAwIBAgIUZIZBO0fb7VZ4KXrs01S4RYbWyJ8wDQYJKoZIhvcNAQEL%0ABQAwJTEjMCEGA1UEAwwacm9vdGNlcnQuY2JpYmxpYW4uaW50ZXJuYWwwHhcNMjUw%0AODEzMTMyNTU5WhcNMjgwODEyMTMyNTU5WjAnMSUwIwYDVQQDDBxjbGllbnRjZXJ0%0ALmNiaWJsaWFuLmludGVybmFsMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKC%0AAQEAskUDap6NmyYq8RT6F7z3DpZGQiflNQTvUT84TmxsKXEBRAkgINnkJqgKkd7f%0ASEybzqglQTbr4s41lCiPsy3X66qYjU2L%2Bojhni%2BOCVOX7n3JBYovL%2FqfMP3%2FkhZP%0AQIlK%2FQWPcrnl39fYkGOQv%2BYqoCGEPzGkib2m1Ma5Q1HOCKh1ErMjqTLGy%2ByJj6JY%0AiZvMx3YrJSvjUS0uKpNwxPtGyiexRfKsmR%2FHqPzRHa0iY%2B752KSgUedwJPv1Wod%2B%0AY9BMAMIdU25UtkUEsaOYtorGWDaZSn2Bl0LYmP87kjcYypnHx0jtPtUCXfVHrE6u%0AZnDRFYsZbeXylY3mJkyOL2DzZwIDAQABo0IwQDAdBgNVHQ4EFgQURPhJwTAcUWUp%0ArOqQO68P%2FbJoqjMwHwYDVR0jBBgwFoAU7GdlxoSeEXucEXhjadHRC9xzS0UwDQYJ%0AKoZIhvcNAQELBQADggIBAGTnlyF2n%2F6s9phYbO8V17niO0BXB62ToX6gPhcw9f3y%0AhMui6RnrM1oiHlBWqZquCqYJ5ETvYJE1RqvoqtGysxCnIj0OTJHV4WtF3SHsd1Tu%0ATg%2B%2FUnGivtBTDQxj9sbAtCaSYRBqPByP8jvSTDgXR1mgOrEGjr2PZdZSoKLj4OHi%0A9UCMJw7pJsyA4lbroKshQTYv5Ks5SqtJpdp0%2BUX0UUlbPJqXiadfbKdoXvEgcwbP%0ACqR9v7kGYmNxfaGLNGVrV%2BnLawIDmdYXJE%2F4WJh6sHfiZxEsE%2BB4PoKADrb1Eapt%0AnSdHUgRfc0i5f2lcmErnU8nCMO5TWdHFOgpYwTS8w17FhNFZpaSmyZKM7uHcUs7y%0AUbuiQtdXocfSSMf%2FeycBEU%2FHAVIWQEqY%2BbJdC0q%2FR%2BsESeBtXd4IEIxR0QfgscGk%0AJyCSFC8z%2FvCgrRsH5rePqKO7%2FLAsDTP4GIQNFNfF4Wh6bsPXuJmvvoMcnmy%2F58Wo%0AE0XaG8UPHVAeyEmhncdM32E7SJbR91aRr2CkV23OoUz%2BwKG2%2FuObHmAkuMkCbbcz%0AJQoC7DZg5FGw%2BZR7v1DIBct5QNJQ8bG%2FXGRxjWC6dU7jrGhOF1X%2B2YYcdx9XnwyM%0A9YPxUy5bVfMhIiKP2wEso5fjOZ4RTvnB5R6zD3maJK%2FtZAXVhtyqXSkBYFi4MvEs%0A-----END%20CERTIFICATE-----%0A\n{\"GrpHdr\":{\"MsgId\":\"000020251022020359\",\"CreDtTm\":\"2025-10-22T14:14:28\",\"NbOfTxs\":1,\"SttlmInf\":{\"SttlmMtd\":\"INGA\"},\"InstgAgt\":{\"FinInstnId\":\"0205\"},\"InstdAgt\":{\"FinInstnId\":\"0205\"},\"Mge\":{\"Type\":\"acmt.998.322.001\"},\"ChnlId\":\"APP\"},\"CdtTrfTxInf\":{\"OrgnGrpInf\":{\"OrgnlMsgId\":\"02052025102238008759834\",\"OrgnlMgeType\":\"acmt.998.321.01\",\"OrgnlCreDtTm\":\"2025-10-22T14:14:35\"},\"PmtId\":{\"EndToEndId\":\"02052025102244963\",\"TxId\":\"18536\"},\"TxSts\":\"Ok\",\"Rsn\":{\"RsnCd\":\"0000\",\"AddtlInf\":\"Transacción Exitosa\"},\"Dbtr\":{\"AuthCode\":\"020520251022141430140139\"},\"Cdtr\":{\"AuthCode\":\"020520251022141430608155\"},\"SttlmDt\":\"2025-10-22\"}}\n\n"},{"result":{"nanos":0,"errorMessage":"no step-definition method match found for: match responseStatus in statusOk\nclasspath:Transferencia.feature:220","millis":0.0,"status":"failed"},"step":{"line":220,"prefix":"Then","index":6,"text":"match responseStatus in statusOk"},"stepLog":"14:14:39.215 classpath:Transferencia.feature:220\nThen match responseStatus in statusOk\nno step-definition method match found for: match responseStatus in statusOk\nclasspath:Transferencia.feature:220\n"},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":221,"prefix":"*","index":7,"text":"eval verifyTransferOutcome(response, successExpectation)"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":222,"prefix":"*","index":8,"text":"eval logTransferSummary('EndToEnd base', payloadInicial, response, responseStatus)"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":223,"prefix":"*","index":9,"text":"def duplicateEndToEnd = payloadInicial.CdtTrfTxInf.PmtId.EndToEndId"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":224,"prefix":"*","index":10,"text":"def payloadDuplicado = buildPayload({ endToEndId: duplicateEndToEnd })"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":225,"prefix":"*","index":11,"text":"def expectation = { httpStatus: [409, 400], outcome: 'reject', expectedEndToEndId: duplicateEndToEnd }"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":226,"prefix":"*","index":12,"text":"def normalizedStatus = normalizeStatus(expectation.httpStatus)"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":227,"prefix":"Given","index":13,"text":"path 'finan', 'transferencia'"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":228,"prefix":"And","index":14,"text":"request payloadDuplicado"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":229,"prefix":"When","index":15,"text":"method post"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":230,"prefix":"Then","index":16,"text":"match responseStatus in normalizedStatus"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":231,"prefix":"*","index":17,"text":"eval verifyTransferOutcome(response, expectation)"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":232,"prefix":"*","index":18,"text":"eval logTransferSummary('Fallo por EndToEnd repetido', payloadDuplicado, response, responseStatus)"}}],"line":213,"description":"","durationMillis":3599.3523,"failed":true,"error":"no step-definition method match found for: match responseStatus in statusOk\nclasspath:Transferencia.feature:220","tags":["transferencia"],"executorName":"main","name":"Transferencia no exitosa, el codigo EndToEnd es el mismo del ordenante y receptor","startTime":1761160475607,"refId":"[6:213]","endTime":1761160479215,"exampleIndex":-1},{"sectionIndex":6,"stepResults":[{"result":{"nanos":3668800,"millis":3.6688,"status":"passed"},"step":{"background":true,"line":5,"prefix":"*","index":0,"text":"def tokenContext = callonce read('classpath:helpers\/generate-token.feature')"},"stepLog":"14:14:39.238 key store key count for classpath:certificado\/clientcert.cbiblian.internal 1.pfx: 1\n"},{"result":{"nanos":424100,"millis":0.4241,"status":"passed"},"step":{"background":true,"line":6,"prefix":"*","index":1,"text":"def tokenData = tokenContext.tokenInfo"}},{"result":{"nanos":541300,"millis":0.5413,"status":"passed"},"step":{"background":true,"line":7,"prefix":"*","index":2,"text":"def transferenciaBaseUrl = karate.properties['transfer.baseUrl'] || 'https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral'"}},{"result":{"nanos":103900,"millis":0.1039,"status":"passed"},"step":{"background":true,"line":8,"prefix":"*","index":3,"text":"url transferenciaBaseUrl"}},{"result":{"nanos":430100,"millis":0.4301,"status":"passed"},"step":{"background":true,"line":9,"prefix":"*","index":4,"text":"def authHeaders = { 'Content-Type': 'application\/json' }"}},{"result":{"nanos":1231600,"millis":1.2316,"status":"passed"},"step":{"background":true,"line":10,"prefix":"*","index":5,"text":"set authHeaders.Authorization = 'Bearer ' + tokenData.auth_tokencb"}},{"result":{"nanos":169500,"millis":0.1695,"status":"passed"},"step":{"background":true,"line":11,"prefix":"*","index":6,"text":"configure headers = authHeaders"}},{"result":{"nanos":366200,"millis":0.3662,"status":"passed"},"step":{"endLine":24,"background":true,"line":12,"prefix":"*","docString":"{\n  \"0205\": {\n    \"CTA_AHORROS\": \"EC5002051000000000020501052673\",\n    \"CTA_CORRIENTE\": \"EC0402051000000000020101002318\"\n  },\n  \"0303\": {\n    \"CTA_AHORROS\": \"EC5003031000000000030301051111\",\n    \"CTA_CORRIENTE\": \"EC0403031000000000030101002222\"\n  }\n}","index":7,"text":"def accountCatalog ="}},{"result":{"nanos":445200,"millis":0.4452,"status":"passed"},"step":{"endLine":39,"background":true,"line":25,"prefix":"*","docString":"function(value){\n  var list;\n  if (!value && value !== 0){\n    list = [200];\n  } else {\n    list = Array.isArray(value) ? value.slice(0) : [value];\n  }\n  if (list.indexOf(200) === -1){\n    list.push(200);\n  }\n  return list;\n}","index":8,"text":"def normalizeStatus ="}},{"result":{"nanos":687500,"millis":0.6875,"status":"passed"},"step":{"endLine":110,"background":true,"line":40,"prefix":"*","docString":"function(overrides){\n  overrides = overrides || {};\n  var token = karate.get('tokenData');\n  var catalog = karate.get('accountCatalog');\n  var LocalDateTime = Java.type('java.time.LocalDateTime');\n  var DateTimeFormatter = Java.type('java.time.format.DateTimeFormatter');\n  var timestamp = LocalDateTime.now().format(DateTimeFormatter.ofPattern(\"yyyy-MM-dd'T'HH:mm:ss\"));\n  var randomDigits = function(length){\n    var digits = '';\n    for (var i = 0; i < length; i++){\n      digits += Math.floor(Math.random() * 10);\n    }\n    return digits;\n  };\n  var coopCode = overrides.instgAgtFinInstId || token.coop_codecb || '0205';\n  var debtorType = overrides.debtorAccountType || 'CTA_AHORROS';\n  var creditorType = overrides.creditorAccountType || 'CTA_CORRIENTE';\n  var creditorEntity = overrides.creditorEntity || overrides.instdAgtFinInstId || coopCode;\n  var debtorAccounts = catalog[coopCode] || catalog['0205'];\n  var creditorAccounts = catalog[creditorEntity] || catalog['0303'];\n  var debtorIban = overrides.debtorIban || (debtorAccounts ? (debtorAccounts[debtorType] || debtorAccounts['CTA_AHORROS']) : 'EC5002051000000000020501052673');\n  var creditorIban = overrides.creditorIban || (creditorAccounts ? (creditorAccounts[creditorType] || creditorAccounts['CTA_CORRIENTE']) : 'EC0403031000000000030101002222');\n  if (overrides.sameIban){\n    creditorIban = debtorIban;\n  }\n  var msgId = overrides.msgId || (coopCode + token.currentDate + randomDigits(11));\n  var endToEndId = overrides.endToEndId || (coopCode + token.currentDate + randomDigits(5));\n  var amountValue = overrides.amount != null ? overrides.amount : 1.00;\n  var payload = {\n    GrpHdr: {\n      msgId: msgId,\n      creDtTm: timestamp,\n      nbOfTxs: overrides.nbOfTxs || 1,\n      sttlmInf: { sttlmMtd: overrides.settlementMethod || 'INGA' },\n      instgAgt: { finInstnId: coopCode },\n      InstdAgt: { FinInstnId: overrides.instdAgtFinInstId || creditorEntity },\n      Mge: { Type: overrides.messageType || 'acmt.998.321.01' },\n      ChnlId: overrides.channel || 'APP'\n    },\n    CdtTrfTxInf: {\n      PmtId: { EndToEndId: endToEndId },\n      IntrBkSttlmAmt: { Amt: amountValue, Ccy: overrides.currency || 'USD' },\n      DbtrAcctId: { IBAN: debtorIban },\n      CdtrAcctId: { IBAN: creditorIban },\n      Prtry: {\n        CustRef: overrides.customerReference || 'QA22',\n        ChanRef: overrides.channelReference || (overrides.channel === 'QR' ? 'QRPANAPAY' : 'TERM001'),\n        AgtRef: overrides.agentReference || 'AGT0002'\n      }\n    }\n  };\n  if (overrides.prtryOverrides){\n    Object.keys(overrides.prtryOverrides).forEach(function(key){\n      payload.CdtTrfTxInf.Prtry[key] = overrides.prtryOverrides[key];\n    });\n  }\n  if (overrides.overrideHeaders){\n    payload.GrpHdr.instgAgt = overrides.overrideHeaders.instgAgt || payload.GrpHdr.instgAgt;\n    payload.GrpHdr.InstdAgt = overrides.overrideHeaders.instdAgt || payload.GrpHdr.InstdAgt;\n  }\n  return payload;\n}","index":9,"text":"def buildPayload ="}},{"result":{"nanos":587600,"millis":0.5876,"status":"passed"},"step":{"endLine":150,"background":true,"line":111,"prefix":"*","docString":"function(body, expectation){\n  expectation = expectation || {};\n  var txInfo = (body && body.CdtTrfTxInf) ? body.CdtTrfTxInf : {};\n  var outcome = expectation.outcome || 'success';\n  var requireTxOk = expectation.requireTxOk === true;\n  var requireTxReject = expectation.requireTxReject === true;\n  var expectedTxStatus = expectation.expectedTxStatus;\n  if (expectedTxStatus != null){\n    karate.match(txInfo.TxSts, expectedTxStatus);\n  } else if (outcome === 'success' && requireTxOk){\n    karate.match(txInfo.TxSts, 'Ok');\n  } else if (outcome === 'reject' && requireTxReject){\n    karate.match(txInfo.TxSts, '#? _ && _ != \"Ok\"');\n  } else {\n    if (txInfo && txInfo.TxSts){\n      karate.log('TxSts recibido:', txInfo.TxSts, '- no se valida estrictamente.');\n    } else {\n      karate.log('Sin TxSts en la respuesta, continuando sin validacion.');\n    }\n  }\n  if (outcome === 'pending'){\n    karate.match(txInfo.TxSts, '#? _ == \"PENDING\" || _ == \"PROC\"');\n  }\n  if (expectation.reasonCode){\n    var reasonNode = txInfo.Rsn || {};\n    karate.match(reasonNode.RsnCd, expectation.reasonCode);\n  }\n  if (expectation.expectedEndToEndId){\n    karate.match(txInfo.PmtId.EndToEndId, expectation.expectedEndToEndId);\n  }\n  if (expectation.expectedMsgId){\n    var grpHdr = (body && body.GrpHdr) ? body.GrpHdr : {};\n    karate.match(grpHdr.msgId, expectation.expectedMsgId);\n  }\n}","index":10,"text":"def verifyTransferOutcome ="}},{"result":{"nanos":293400,"millis":0.2934,"status":"passed"},"step":{"endLine":156,"background":true,"line":151,"prefix":"*","docString":"function(name, payload, responseBody, status){\n  karate.log('[Transfer]', name, '| status:', status, '| msgId:', payload.GrpHdr.msgId, '| endToEnd:', payload.CdtTrfTxInf.PmtId.EndToEndId);\n}","index":11,"text":"def logTransferSummary ="}},{"result":{"nanos":8173900,"millis":8.1739,"status":"passed"},"step":{"line":235,"prefix":"*","index":0,"text":"def payloadBase = buildPayload()"}},{"result":{"nanos":1108300,"millis":1.1083,"status":"passed"},"step":{"line":236,"prefix":"*","index":1,"text":"def okExpectation = { httpStatus: 200, outcome: 'success', expectedMsgId: payloadBase.GrpHdr.msgId }"}},{"result":{"nanos":3227000,"millis":3.227,"status":"passed"},"step":{"line":237,"prefix":"*","index":2,"text":"def okStatus = normalizeStatus(okExpectation.httpStatus)"}},{"result":{"nanos":430200,"millis":0.4302,"status":"passed"},"step":{"line":238,"prefix":"Given","index":3,"text":"path 'finan', 'transferencia'"}},{"result":{"nanos":356800,"millis":0.3568,"status":"passed"},"step":{"line":239,"prefix":"And","index":4,"text":"request payloadBase"}},{"result":{"nanos":3476929100,"millis":3476.9291,"status":"passed"},"step":{"line":240,"prefix":"When","index":5,"text":"method post"},"stepLog":"14:14:39.264 request:\n1 > POST https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral\/finan\/transferencia\n1 > Content-Type: application\/json; charset=UTF-8\n1 > Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2dUJWTkN6VlViUFBlTFdReEM0WDAyYVM3UnM2UGRYV1dja1dfc0xZMHlFIn0.eyJleHAiOjE3NjExNjA3NTAsImlhdCI6MTc2MTE2MDQ1MCwianRpIjoidHJydGNjOjQ5Yjg0NDVjLTgzYTAtMjI4Ni02NDczLWE2ZGEzOTBhOWQ0YSIsImlzcyI6Imh0dHBzOi8vYXV0ZW50aWNhY2lvbnFhLmNvb25lY3RhLmNvbS5lYy9hdXRoL3JlYWxtcy9QQU5BUEFZIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6Ijk5OGMyZmUwLTJjOGYtNGQwNC1iZjExLWY1OWExZTM5ODg3MyIsInR5cCI6IkJlYXJlciIsImF6cCI6IjAyMDVjYiIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiLyoiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRlZmF1bHQtcm9sZXMtYWRtaW5wYW5hcGF5Iiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7IjAyMDVjYiI6eyJyb2xlcyI6WyJ1bWFfcHJvdGVjdGlvbiJdfSwiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJjbGllbnRIb3N0IjoiMTAuMTAuMTAuMTUxIiwicHJlZmVycmVkX3VzZXJuYW1lIjoic2VydmljZS1hY2NvdW50LTAyMDVjYiIsImNsaWVudEFkZHJlc3MiOiIxMC4xMC4xMC4xNTEiLCJjbGllbnRfaWQiOiIwMjA1Y2IifQ.bATUogohrEqy7Voa4mFnsBzOnGy6tnjZGh_lOYRn-0hWXMY_fz-280nTu2Vv68eO3HeoewtWlt45S_iLI2-ml3pqpAlt3DXWVmLvVHw6d7TICHBfQsa0jGXMexKnyar7EinrVhF3deSK25Ap_ajC_82EvVvXrVG-7p9F1dEdq39y2R72JympejF5uhY_z_jNmqJSsnLEZVOo3WMJn76u9tTcYVIldC5uWGFWbPGEhvWPx4ZGpsuq_wrPOGdRmyJDFJPJl7LnLGHK0DBhuVtJUq_NFQkMus2fTTf_mWhRnoqNU-wUCS-fxMs6QusGzIVd-C3O29J3rerHTrGg21LAsQ\n1 > Content-Length: 509\n1 > Host: apipanapayqa.coonecta.com.ec\n1 > Connection: Keep-Alive\n1 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/17.0.12)\n1 > Accept-Encoding: gzip,deflate\n{\"GrpHdr\":{\"msgId\":\"02052025102257438954004\",\"creDtTm\":\"2025-10-22T14:14:39\",\"nbOfTxs\":1,\"sttlmInf\":{\"sttlmMtd\":\"INGA\"},\"instgAgt\":{\"finInstnId\":\"0205\"},\"InstdAgt\":{\"FinInstnId\":\"0205\"},\"Mge\":{\"Type\":\"acmt.998.321.01\"},\"ChnlId\":\"APP\"},\"CdtTrfTxInf\":{\"PmtId\":{\"EndToEndId\":\"02052025102294747\"},\"IntrBkSttlmAmt\":{\"Amt\":1,\"Ccy\":\"USD\"},\"DbtrAcctId\":{\"IBAN\":\"EC5002051000000000020501052673\"},\"CdtrAcctId\":{\"IBAN\":\"EC0402051000000000020101002318\"},\"Prtry\":{\"CustRef\":\"QA22\",\"ChanRef\":\"TERM001\",\"AgtRef\":\"AGT0002\"}}}\n\n14:14:42.738 response time in milliseconds: 3387\n1 < 200\n1 < Date: Wed, 22 Oct 2025 19:14:33 GMT\n1 < Content-Type: application\/json; charset=utf-8\n1 < Transfer-Encoding: chunked\n1 < Connection: keep-alive\n1 < Server: Kestrel\n1 < Set-Cookie: ARRAffinity=135f536e0d078a815c3b83fda3468ab8a3a2abc604a35eefb28648d3961cfa9b;Path=\/;HttpOnly;Secure;Domain=app-apipanapay-qa.azurewebsites.net\n1 < Set-Cookie: ARRAffinitySameSite=135f536e0d078a815c3b83fda3468ab8a3a2abc604a35eefb28648d3961cfa9b;Path=\/;HttpOnly;SameSite=None;Secure;Domain=app-apipanapay-qa.azurewebsites.net\n1 < Vary: Accept-Encoding\n1 < Request-Context: appId=cid-v1:a7a77847-2713-450f-9030-b350a2d54a28\n1 < X-Powered-By: ASP.NET\n1 < X-ARR-ClientCert: -----BEGIN%20CERTIFICATE-----%0AMIIEHDCCAgSgAwIBAgIUZIZBO0fb7VZ4KXrs01S4RYbWyJ8wDQYJKoZIhvcNAQEL%0ABQAwJTEjMCEGA1UEAwwacm9vdGNlcnQuY2JpYmxpYW4uaW50ZXJuYWwwHhcNMjUw%0AODEzMTMyNTU5WhcNMjgwODEyMTMyNTU5WjAnMSUwIwYDVQQDDBxjbGllbnRjZXJ0%0ALmNiaWJsaWFuLmludGVybmFsMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKC%0AAQEAskUDap6NmyYq8RT6F7z3DpZGQiflNQTvUT84TmxsKXEBRAkgINnkJqgKkd7f%0ASEybzqglQTbr4s41lCiPsy3X66qYjU2L%2Bojhni%2BOCVOX7n3JBYovL%2FqfMP3%2FkhZP%0AQIlK%2FQWPcrnl39fYkGOQv%2BYqoCGEPzGkib2m1Ma5Q1HOCKh1ErMjqTLGy%2ByJj6JY%0AiZvMx3YrJSvjUS0uKpNwxPtGyiexRfKsmR%2FHqPzRHa0iY%2B752KSgUedwJPv1Wod%2B%0AY9BMAMIdU25UtkUEsaOYtorGWDaZSn2Bl0LYmP87kjcYypnHx0jtPtUCXfVHrE6u%0AZnDRFYsZbeXylY3mJkyOL2DzZwIDAQABo0IwQDAdBgNVHQ4EFgQURPhJwTAcUWUp%0ArOqQO68P%2FbJoqjMwHwYDVR0jBBgwFoAU7GdlxoSeEXucEXhjadHRC9xzS0UwDQYJ%0AKoZIhvcNAQELBQADggIBAGTnlyF2n%2F6s9phYbO8V17niO0BXB62ToX6gPhcw9f3y%0AhMui6RnrM1oiHlBWqZquCqYJ5ETvYJE1RqvoqtGysxCnIj0OTJHV4WtF3SHsd1Tu%0ATg%2B%2FUnGivtBTDQxj9sbAtCaSYRBqPByP8jvSTDgXR1mgOrEGjr2PZdZSoKLj4OHi%0A9UCMJw7pJsyA4lbroKshQTYv5Ks5SqtJpdp0%2BUX0UUlbPJqXiadfbKdoXvEgcwbP%0ACqR9v7kGYmNxfaGLNGVrV%2BnLawIDmdYXJE%2F4WJh6sHfiZxEsE%2BB4PoKADrb1Eapt%0AnSdHUgRfc0i5f2lcmErnU8nCMO5TWdHFOgpYwTS8w17FhNFZpaSmyZKM7uHcUs7y%0AUbuiQtdXocfSSMf%2FeycBEU%2FHAVIWQEqY%2BbJdC0q%2FR%2BsESeBtXd4IEIxR0QfgscGk%0AJyCSFC8z%2FvCgrRsH5rePqKO7%2FLAsDTP4GIQNFNfF4Wh6bsPXuJmvvoMcnmy%2F58Wo%0AE0XaG8UPHVAeyEmhncdM32E7SJbR91aRr2CkV23OoUz%2BwKG2%2FuObHmAkuMkCbbcz%0AJQoC7DZg5FGw%2BZR7v1DIBct5QNJQ8bG%2FXGRxjWC6dU7jrGhOF1X%2B2YYcdx9XnwyM%0A9YPxUy5bVfMhIiKP2wEso5fjOZ4RTvnB5R6zD3maJK%2FtZAXVhtyqXSkBYFi4MvEs%0A-----END%20CERTIFICATE-----%0A\n{\"GrpHdr\":{\"MsgId\":\"000020251022020360\",\"CreDtTm\":\"2025-10-22T14:14:32\",\"NbOfTxs\":1,\"SttlmInf\":{\"SttlmMtd\":\"INGA\"},\"InstgAgt\":{\"FinInstnId\":\"0205\"},\"InstdAgt\":{\"FinInstnId\":\"0205\"},\"Mge\":{\"Type\":\"acmt.998.322.001\"},\"ChnlId\":\"APP\"},\"CdtTrfTxInf\":{\"OrgnGrpInf\":{\"OrgnlMsgId\":\"02052025102257438954004\",\"OrgnlMgeType\":\"acmt.998.321.01\",\"OrgnlCreDtTm\":\"2025-10-22T14:14:39\"},\"PmtId\":{\"EndToEndId\":\"02052025102294747\",\"TxId\":\"18537\"},\"TxSts\":\"Ok\",\"Rsn\":{\"RsnCd\":\"0000\",\"AddtlInf\":\"Transacción Exitosa\"},\"Dbtr\":{\"AuthCode\":\"020520251022141433526306\"},\"Cdtr\":{\"AuthCode\":\"020520251022141433964146\"},\"SttlmDt\":\"2025-10-22\"}}\n\n"},{"result":{"nanos":0,"errorMessage":"no step-definition method match found for: match responseStatus in okStatus\nclasspath:Transferencia.feature:241","millis":0.0,"status":"failed"},"step":{"line":241,"prefix":"Then","index":6,"text":"match responseStatus in okStatus"},"stepLog":"14:14:42.738 classpath:Transferencia.feature:241\nThen match responseStatus in okStatus\nno step-definition method match found for: match responseStatus in okStatus\nclasspath:Transferencia.feature:241\n"},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":242,"prefix":"*","index":7,"text":"eval verifyTransferOutcome(response, okExpectation)"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":243,"prefix":"*","index":8,"text":"eval logTransferSummary('MsgId base', payloadBase, response, responseStatus)"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":244,"prefix":"*","index":9,"text":"def duplicateMsgId = payloadBase.GrpHdr.msgId"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":245,"prefix":"*","index":10,"text":"def payloadRepetido = buildPayload({ msgId: duplicateMsgId })"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":246,"prefix":"*","index":11,"text":"def expectation = { httpStatus: [409, 400], outcome: 'reject', expectedMsgId: duplicateMsgId }"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":247,"prefix":"*","index":12,"text":"def normalizedStatus = normalizeStatus(expectation.httpStatus)"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":248,"prefix":"Given","index":13,"text":"path 'finan', 'transferencia'"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":249,"prefix":"And","index":14,"text":"request payloadRepetido"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":250,"prefix":"When","index":15,"text":"method post"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":251,"prefix":"Then","index":16,"text":"match responseStatus in normalizedStatus"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":252,"prefix":"*","index":17,"text":"eval verifyTransferOutcome(response, expectation)"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":253,"prefix":"*","index":18,"text":"eval logTransferSummary('Fallo por MsgId repetido', payloadRepetido, response, responseStatus)"}}],"line":234,"description":"","durationMillis":3499.1745,"failed":true,"error":"no step-definition method match found for: match responseStatus in okStatus\nclasspath:Transferencia.feature:241","tags":["transferencia"],"executorName":"main","name":"Transferencia no exitosa, el codigo MsgId es el mismo del ordenante y receptor","startTime":1761160479231,"refId":"[7:234]","endTime":1761160482738,"exampleIndex":-1},{"sectionIndex":7,"stepResults":[{"result":{"nanos":6142900,"millis":6.1429,"status":"passed"},"step":{"background":true,"line":5,"prefix":"*","index":0,"text":"def tokenContext = callonce read('classpath:helpers\/generate-token.feature')"},"stepLog":"14:14:42.762 key store key count for classpath:certificado\/clientcert.cbiblian.internal 1.pfx: 1\n"},{"result":{"nanos":472800,"millis":0.4728,"status":"passed"},"step":{"background":true,"line":6,"prefix":"*","index":1,"text":"def tokenData = tokenContext.tokenInfo"}},{"result":{"nanos":715500,"millis":0.7155,"status":"passed"},"step":{"background":true,"line":7,"prefix":"*","index":2,"text":"def transferenciaBaseUrl = karate.properties['transfer.baseUrl'] || 'https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral'"}},{"result":{"nanos":106000,"millis":0.106,"status":"passed"},"step":{"background":true,"line":8,"prefix":"*","index":3,"text":"url transferenciaBaseUrl"}},{"result":{"nanos":484900,"millis":0.4849,"status":"passed"},"step":{"background":true,"line":9,"prefix":"*","index":4,"text":"def authHeaders = { 'Content-Type': 'application\/json' }"}},{"result":{"nanos":940800,"millis":0.9408,"status":"passed"},"step":{"background":true,"line":10,"prefix":"*","index":5,"text":"set authHeaders.Authorization = 'Bearer ' + tokenData.auth_tokencb"}},{"result":{"nanos":133100,"millis":0.1331,"status":"passed"},"step":{"background":true,"line":11,"prefix":"*","index":6,"text":"configure headers = authHeaders"}},{"result":{"nanos":217400,"millis":0.2174,"status":"passed"},"step":{"endLine":24,"background":true,"line":12,"prefix":"*","docString":"{\n  \"0205\": {\n    \"CTA_AHORROS\": \"EC5002051000000000020501052673\",\n    \"CTA_CORRIENTE\": \"EC0402051000000000020101002318\"\n  },\n  \"0303\": {\n    \"CTA_AHORROS\": \"EC5003031000000000030301051111\",\n    \"CTA_CORRIENTE\": \"EC0403031000000000030101002222\"\n  }\n}","index":7,"text":"def accountCatalog ="}},{"result":{"nanos":427800,"millis":0.4278,"status":"passed"},"step":{"endLine":39,"background":true,"line":25,"prefix":"*","docString":"function(value){\n  var list;\n  if (!value && value !== 0){\n    list = [200];\n  } else {\n    list = Array.isArray(value) ? value.slice(0) : [value];\n  }\n  if (list.indexOf(200) === -1){\n    list.push(200);\n  }\n  return list;\n}","index":8,"text":"def normalizeStatus ="}},{"result":{"nanos":332200,"millis":0.3322,"status":"passed"},"step":{"endLine":110,"background":true,"line":40,"prefix":"*","docString":"function(overrides){\n  overrides = overrides || {};\n  var token = karate.get('tokenData');\n  var catalog = karate.get('accountCatalog');\n  var LocalDateTime = Java.type('java.time.LocalDateTime');\n  var DateTimeFormatter = Java.type('java.time.format.DateTimeFormatter');\n  var timestamp = LocalDateTime.now().format(DateTimeFormatter.ofPattern(\"yyyy-MM-dd'T'HH:mm:ss\"));\n  var randomDigits = function(length){\n    var digits = '';\n    for (var i = 0; i < length; i++){\n      digits += Math.floor(Math.random() * 10);\n    }\n    return digits;\n  };\n  var coopCode = overrides.instgAgtFinInstId || token.coop_codecb || '0205';\n  var debtorType = overrides.debtorAccountType || 'CTA_AHORROS';\n  var creditorType = overrides.creditorAccountType || 'CTA_CORRIENTE';\n  var creditorEntity = overrides.creditorEntity || overrides.instdAgtFinInstId || coopCode;\n  var debtorAccounts = catalog[coopCode] || catalog['0205'];\n  var creditorAccounts = catalog[creditorEntity] || catalog['0303'];\n  var debtorIban = overrides.debtorIban || (debtorAccounts ? (debtorAccounts[debtorType] || debtorAccounts['CTA_AHORROS']) : 'EC5002051000000000020501052673');\n  var creditorIban = overrides.creditorIban || (creditorAccounts ? (creditorAccounts[creditorType] || creditorAccounts['CTA_CORRIENTE']) : 'EC0403031000000000030101002222');\n  if (overrides.sameIban){\n    creditorIban = debtorIban;\n  }\n  var msgId = overrides.msgId || (coopCode + token.currentDate + randomDigits(11));\n  var endToEndId = overrides.endToEndId || (coopCode + token.currentDate + randomDigits(5));\n  var amountValue = overrides.amount != null ? overrides.amount : 1.00;\n  var payload = {\n    GrpHdr: {\n      msgId: msgId,\n      creDtTm: timestamp,\n      nbOfTxs: overrides.nbOfTxs || 1,\n      sttlmInf: { sttlmMtd: overrides.settlementMethod || 'INGA' },\n      instgAgt: { finInstnId: coopCode },\n      InstdAgt: { FinInstnId: overrides.instdAgtFinInstId || creditorEntity },\n      Mge: { Type: overrides.messageType || 'acmt.998.321.01' },\n      ChnlId: overrides.channel || 'APP'\n    },\n    CdtTrfTxInf: {\n      PmtId: { EndToEndId: endToEndId },\n      IntrBkSttlmAmt: { Amt: amountValue, Ccy: overrides.currency || 'USD' },\n      DbtrAcctId: { IBAN: debtorIban },\n      CdtrAcctId: { IBAN: creditorIban },\n      Prtry: {\n        CustRef: overrides.customerReference || 'QA22',\n        ChanRef: overrides.channelReference || (overrides.channel === 'QR' ? 'QRPANAPAY' : 'TERM001'),\n        AgtRef: overrides.agentReference || 'AGT0002'\n      }\n    }\n  };\n  if (overrides.prtryOverrides){\n    Object.keys(overrides.prtryOverrides).forEach(function(key){\n      payload.CdtTrfTxInf.Prtry[key] = overrides.prtryOverrides[key];\n    });\n  }\n  if (overrides.overrideHeaders){\n    payload.GrpHdr.instgAgt = overrides.overrideHeaders.instgAgt || payload.GrpHdr.instgAgt;\n    payload.GrpHdr.InstdAgt = overrides.overrideHeaders.instdAgt || payload.GrpHdr.InstdAgt;\n  }\n  return payload;\n}","index":9,"text":"def buildPayload ="}},{"result":{"nanos":332500,"millis":0.3325,"status":"passed"},"step":{"endLine":150,"background":true,"line":111,"prefix":"*","docString":"function(body, expectation){\n  expectation = expectation || {};\n  var txInfo = (body && body.CdtTrfTxInf) ? body.CdtTrfTxInf : {};\n  var outcome = expectation.outcome || 'success';\n  var requireTxOk = expectation.requireTxOk === true;\n  var requireTxReject = expectation.requireTxReject === true;\n  var expectedTxStatus = expectation.expectedTxStatus;\n  if (expectedTxStatus != null){\n    karate.match(txInfo.TxSts, expectedTxStatus);\n  } else if (outcome === 'success' && requireTxOk){\n    karate.match(txInfo.TxSts, 'Ok');\n  } else if (outcome === 'reject' && requireTxReject){\n    karate.match(txInfo.TxSts, '#? _ && _ != \"Ok\"');\n  } else {\n    if (txInfo && txInfo.TxSts){\n      karate.log('TxSts recibido:', txInfo.TxSts, '- no se valida estrictamente.');\n    } else {\n      karate.log('Sin TxSts en la respuesta, continuando sin validacion.');\n    }\n  }\n  if (outcome === 'pending'){\n    karate.match(txInfo.TxSts, '#? _ == \"PENDING\" || _ == \"PROC\"');\n  }\n  if (expectation.reasonCode){\n    var reasonNode = txInfo.Rsn || {};\n    karate.match(reasonNode.RsnCd, expectation.reasonCode);\n  }\n  if (expectation.expectedEndToEndId){\n    karate.match(txInfo.PmtId.EndToEndId, expectation.expectedEndToEndId);\n  }\n  if (expectation.expectedMsgId){\n    var grpHdr = (body && body.GrpHdr) ? body.GrpHdr : {};\n    karate.match(grpHdr.msgId, expectation.expectedMsgId);\n  }\n}","index":10,"text":"def verifyTransferOutcome ="}},{"result":{"nanos":693800,"millis":0.6938,"status":"passed"},"step":{"endLine":156,"background":true,"line":151,"prefix":"*","docString":"function(name, payload, responseBody, status){\n  karate.log('[Transfer]', name, '| status:', status, '| msgId:', payload.GrpHdr.msgId, '| endToEnd:', payload.CdtTrfTxInf.PmtId.EndToEndId);\n}","index":11,"text":"def logTransferSummary ="}},{"result":{"nanos":9707600,"millis":9.7076,"status":"passed"},"step":{"line":256,"prefix":"*","index":0,"text":"def payload = buildPayload({ nbOfTxs: 999 })"}},{"result":{"nanos":448200,"millis":0.4482,"status":"passed"},"step":{"line":257,"prefix":"*","index":1,"text":"def expectation = { httpStatus: [429, 409, 400], outcome: 'reject' }"}},{"result":{"nanos":1086900,"millis":1.0869,"status":"passed"},"step":{"line":258,"prefix":"*","index":2,"text":"def normalizedStatus = normalizeStatus(expectation.httpStatus)"}},{"result":{"nanos":196200,"millis":0.1962,"status":"passed"},"step":{"line":259,"prefix":"Given","index":3,"text":"path 'finan', 'transferencia'"}},{"result":{"nanos":65200,"millis":0.0652,"status":"passed"},"step":{"line":260,"prefix":"And","index":4,"text":"request payload"}},{"result":{"nanos":776127400,"millis":776.1274,"status":"passed"},"step":{"line":261,"prefix":"When","index":5,"text":"method post"},"stepLog":"14:14:42.788 request:\n1 > POST https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral\/finan\/transferencia\n1 > Content-Type: application\/json; charset=UTF-8\n1 > Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2dUJWTkN6VlViUFBlTFdReEM0WDAyYVM3UnM2UGRYV1dja1dfc0xZMHlFIn0.eyJleHAiOjE3NjExNjA3NTAsImlhdCI6MTc2MTE2MDQ1MCwianRpIjoidHJydGNjOjQ5Yjg0NDVjLTgzYTAtMjI4Ni02NDczLWE2ZGEzOTBhOWQ0YSIsImlzcyI6Imh0dHBzOi8vYXV0ZW50aWNhY2lvbnFhLmNvb25lY3RhLmNvbS5lYy9hdXRoL3JlYWxtcy9QQU5BUEFZIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6Ijk5OGMyZmUwLTJjOGYtNGQwNC1iZjExLWY1OWExZTM5ODg3MyIsInR5cCI6IkJlYXJlciIsImF6cCI6IjAyMDVjYiIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiLyoiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRlZmF1bHQtcm9sZXMtYWRtaW5wYW5hcGF5Iiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7IjAyMDVjYiI6eyJyb2xlcyI6WyJ1bWFfcHJvdGVjdGlvbiJdfSwiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJjbGllbnRIb3N0IjoiMTAuMTAuMTAuMTUxIiwicHJlZmVycmVkX3VzZXJuYW1lIjoic2VydmljZS1hY2NvdW50LTAyMDVjYiIsImNsaWVudEFkZHJlc3MiOiIxMC4xMC4xMC4xNTEiLCJjbGllbnRfaWQiOiIwMjA1Y2IifQ.bATUogohrEqy7Voa4mFnsBzOnGy6tnjZGh_lOYRn-0hWXMY_fz-280nTu2Vv68eO3HeoewtWlt45S_iLI2-ml3pqpAlt3DXWVmLvVHw6d7TICHBfQsa0jGXMexKnyar7EinrVhF3deSK25Ap_ajC_82EvVvXrVG-7p9F1dEdq39y2R72JympejF5uhY_z_jNmqJSsnLEZVOo3WMJn76u9tTcYVIldC5uWGFWbPGEhvWPx4ZGpsuq_wrPOGdRmyJDFJPJl7LnLGHK0DBhuVtJUq_NFQkMus2fTTf_mWhRnoqNU-wUCS-fxMs6QusGzIVd-C3O29J3rerHTrGg21LAsQ\n1 > Content-Length: 511\n1 > Host: apipanapayqa.coonecta.com.ec\n1 > Connection: Keep-Alive\n1 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/17.0.12)\n1 > Accept-Encoding: gzip,deflate\n{\"GrpHdr\":{\"msgId\":\"02052025102222274573787\",\"creDtTm\":\"2025-10-22T14:14:42\",\"nbOfTxs\":999,\"sttlmInf\":{\"sttlmMtd\":\"INGA\"},\"instgAgt\":{\"finInstnId\":\"0205\"},\"InstdAgt\":{\"FinInstnId\":\"0205\"},\"Mge\":{\"Type\":\"acmt.998.321.01\"},\"ChnlId\":\"APP\"},\"CdtTrfTxInf\":{\"PmtId\":{\"EndToEndId\":\"02052025102274850\"},\"IntrBkSttlmAmt\":{\"Amt\":1,\"Ccy\":\"USD\"},\"DbtrAcctId\":{\"IBAN\":\"EC5002051000000000020501052673\"},\"CdtrAcctId\":{\"IBAN\":\"EC0402051000000000020101002318\"},\"Prtry\":{\"CustRef\":\"QA22\",\"ChanRef\":\"TERM001\",\"AgtRef\":\"AGT0002\"}}}\n\n14:14:43.567 response time in milliseconds: 775\n1 < 400\n1 < Date: Wed, 22 Oct 2025 19:14:36 GMT\n1 < Content-Type: application\/json; charset=utf-8\n1 < Transfer-Encoding: chunked\n1 < Connection: keep-alive\n1 < Server: Kestrel\n1 < Set-Cookie: ARRAffinity=135f536e0d078a815c3b83fda3468ab8a3a2abc604a35eefb28648d3961cfa9b;Path=\/;HttpOnly;Secure;Domain=app-apipanapay-qa.azurewebsites.net\n1 < Set-Cookie: ARRAffinitySameSite=135f536e0d078a815c3b83fda3468ab8a3a2abc604a35eefb28648d3961cfa9b;Path=\/;HttpOnly;SameSite=None;Secure;Domain=app-apipanapay-qa.azurewebsites.net\n1 < Request-Context: appId=cid-v1:a7a77847-2713-450f-9030-b350a2d54a28\n1 < X-Powered-By: ASP.NET\n1 < X-ARR-ClientCert: -----BEGIN%20CERTIFICATE-----%0AMIIEHDCCAgSgAwIBAgIUZIZBO0fb7VZ4KXrs01S4RYbWyJ8wDQYJKoZIhvcNAQEL%0ABQAwJTEjMCEGA1UEAwwacm9vdGNlcnQuY2JpYmxpYW4uaW50ZXJuYWwwHhcNMjUw%0AODEzMTMyNTU5WhcNMjgwODEyMTMyNTU5WjAnMSUwIwYDVQQDDBxjbGllbnRjZXJ0%0ALmNiaWJsaWFuLmludGVybmFsMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKC%0AAQEAskUDap6NmyYq8RT6F7z3DpZGQiflNQTvUT84TmxsKXEBRAkgINnkJqgKkd7f%0ASEybzqglQTbr4s41lCiPsy3X66qYjU2L%2Bojhni%2BOCVOX7n3JBYovL%2FqfMP3%2FkhZP%0AQIlK%2FQWPcrnl39fYkGOQv%2BYqoCGEPzGkib2m1Ma5Q1HOCKh1ErMjqTLGy%2ByJj6JY%0AiZvMx3YrJSvjUS0uKpNwxPtGyiexRfKsmR%2FHqPzRHa0iY%2B752KSgUedwJPv1Wod%2B%0AY9BMAMIdU25UtkUEsaOYtorGWDaZSn2Bl0LYmP87kjcYypnHx0jtPtUCXfVHrE6u%0AZnDRFYsZbeXylY3mJkyOL2DzZwIDAQABo0IwQDAdBgNVHQ4EFgQURPhJwTAcUWUp%0ArOqQO68P%2FbJoqjMwHwYDVR0jBBgwFoAU7GdlxoSeEXucEXhjadHRC9xzS0UwDQYJ%0AKoZIhvcNAQELBQADggIBAGTnlyF2n%2F6s9phYbO8V17niO0BXB62ToX6gPhcw9f3y%0AhMui6RnrM1oiHlBWqZquCqYJ5ETvYJE1RqvoqtGysxCnIj0OTJHV4WtF3SHsd1Tu%0ATg%2B%2FUnGivtBTDQxj9sbAtCaSYRBqPByP8jvSTDgXR1mgOrEGjr2PZdZSoKLj4OHi%0A9UCMJw7pJsyA4lbroKshQTYv5Ks5SqtJpdp0%2BUX0UUlbPJqXiadfbKdoXvEgcwbP%0ACqR9v7kGYmNxfaGLNGVrV%2BnLawIDmdYXJE%2F4WJh6sHfiZxEsE%2BB4PoKADrb1Eapt%0AnSdHUgRfc0i5f2lcmErnU8nCMO5TWdHFOgpYwTS8w17FhNFZpaSmyZKM7uHcUs7y%0AUbuiQtdXocfSSMf%2FeycBEU%2FHAVIWQEqY%2BbJdC0q%2FR%2BsESeBtXd4IEIxR0QfgscGk%0AJyCSFC8z%2FvCgrRsH5rePqKO7%2FLAsDTP4GIQNFNfF4Wh6bsPXuJmvvoMcnmy%2F58Wo%0AE0XaG8UPHVAeyEmhncdM32E7SJbR91aRr2CkV23OoUz%2BwKG2%2FuObHmAkuMkCbbcz%0AJQoC7DZg5FGw%2BZR7v1DIBct5QNJQ8bG%2FXGRxjWC6dU7jrGhOF1X%2B2YYcdx9XnwyM%0A9YPxUy5bVfMhIiKP2wEso5fjOZ4RTvnB5R6zD3maJK%2FtZAXVhtyqXSkBYFi4MvEs%0A-----END%20CERTIFICATE-----%0A\n{\"GrpHdr\":{\"MsgId\":\"000020251022020361\",\"CreDtTm\":\"2025-10-22T14:14:35\",\"NbOfTxs\":999,\"SttlmInf\":{\"SttlmMtd\":\"INGA\"},\"InstgAgt\":{\"FinInstnId\":\"0205\"},\"InstdAgt\":{\"FinInstnId\":\"0205\"},\"Mge\":{\"Type\":\"acmt.998.322.001\"},\"ChnlId\":\"APP\"},\"CdtTrfTxInf\":{\"OrgnGrpInf\":{\"OrgnlMsgId\":\"02052025102222274573787\",\"OrgnlMgeType\":\"acmt.998.321.01\",\"OrgnlCreDtTm\":\"2025-10-22T14:14:42\"},\"TxSts\":\"ERR\",\"Rsn\":{\"RsnCd\":\"9000\",\"AddtlInf\":\"El número de transacciones (NbOfTxs) es requerida. Tiene que enviar por lo menos 1 en el número de transacciones.\"},\"SttlmDt\":\"2025-10-22\"}}\n\n"},{"result":{"nanos":0,"errorMessage":"no step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:262","millis":0.0,"status":"failed"},"step":{"line":262,"prefix":"Then","index":6,"text":"match responseStatus in normalizedStatus"},"stepLog":"14:14:43.567 classpath:Transferencia.feature:262\nThen match responseStatus in normalizedStatus\nno step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:262\n"},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":263,"prefix":"*","index":7,"text":"eval verifyTransferOutcome(response, expectation)"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":264,"prefix":"*","index":8,"text":"eval logTransferSummary('Exceso de transacciones diarias', payload, response, responseStatus)"}}],"line":255,"description":"","durationMillis":798.6312,"failed":true,"error":"no step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:262","tags":["transferencia"],"executorName":"main","name":"Transferencia no exitosa, numero de transacciones diarias superior al permitido","startTime":1761160482755,"refId":"[8:255]","endTime":1761160483567,"exampleIndex":-1},{"sectionIndex":8,"stepResults":[{"result":{"nanos":5211800,"millis":5.2118,"status":"passed"},"step":{"background":true,"line":5,"prefix":"*","index":0,"text":"def tokenContext = callonce read('classpath:helpers\/generate-token.feature')"},"stepLog":"14:14:43.591 key store key count for classpath:certificado\/clientcert.cbiblian.internal 1.pfx: 1\n"},{"result":{"nanos":479800,"millis":0.4798,"status":"passed"},"step":{"background":true,"line":6,"prefix":"*","index":1,"text":"def tokenData = tokenContext.tokenInfo"}},{"result":{"nanos":527600,"millis":0.5276,"status":"passed"},"step":{"background":true,"line":7,"prefix":"*","index":2,"text":"def transferenciaBaseUrl = karate.properties['transfer.baseUrl'] || 'https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral'"}},{"result":{"nanos":76700,"millis":0.0767,"status":"passed"},"step":{"background":true,"line":8,"prefix":"*","index":3,"text":"url transferenciaBaseUrl"}},{"result":{"nanos":393300,"millis":0.3933,"status":"passed"},"step":{"background":true,"line":9,"prefix":"*","index":4,"text":"def authHeaders = { 'Content-Type': 'application\/json' }"}},{"result":{"nanos":799200,"millis":0.7992,"status":"passed"},"step":{"background":true,"line":10,"prefix":"*","index":5,"text":"set authHeaders.Authorization = 'Bearer ' + tokenData.auth_tokencb"}},{"result":{"nanos":56400,"millis":0.0564,"status":"passed"},"step":{"background":true,"line":11,"prefix":"*","index":6,"text":"configure headers = authHeaders"}},{"result":{"nanos":175900,"millis":0.1759,"status":"passed"},"step":{"endLine":24,"background":true,"line":12,"prefix":"*","docString":"{\n  \"0205\": {\n    \"CTA_AHORROS\": \"EC5002051000000000020501052673\",\n    \"CTA_CORRIENTE\": \"EC0402051000000000020101002318\"\n  },\n  \"0303\": {\n    \"CTA_AHORROS\": \"EC5003031000000000030301051111\",\n    \"CTA_CORRIENTE\": \"EC0403031000000000030101002222\"\n  }\n}","index":7,"text":"def accountCatalog ="}},{"result":{"nanos":239400,"millis":0.2394,"status":"passed"},"step":{"endLine":39,"background":true,"line":25,"prefix":"*","docString":"function(value){\n  var list;\n  if (!value && value !== 0){\n    list = [200];\n  } else {\n    list = Array.isArray(value) ? value.slice(0) : [value];\n  }\n  if (list.indexOf(200) === -1){\n    list.push(200);\n  }\n  return list;\n}","index":8,"text":"def normalizeStatus ="}},{"result":{"nanos":239700,"millis":0.2397,"status":"passed"},"step":{"endLine":110,"background":true,"line":40,"prefix":"*","docString":"function(overrides){\n  overrides = overrides || {};\n  var token = karate.get('tokenData');\n  var catalog = karate.get('accountCatalog');\n  var LocalDateTime = Java.type('java.time.LocalDateTime');\n  var DateTimeFormatter = Java.type('java.time.format.DateTimeFormatter');\n  var timestamp = LocalDateTime.now().format(DateTimeFormatter.ofPattern(\"yyyy-MM-dd'T'HH:mm:ss\"));\n  var randomDigits = function(length){\n    var digits = '';\n    for (var i = 0; i < length; i++){\n      digits += Math.floor(Math.random() * 10);\n    }\n    return digits;\n  };\n  var coopCode = overrides.instgAgtFinInstId || token.coop_codecb || '0205';\n  var debtorType = overrides.debtorAccountType || 'CTA_AHORROS';\n  var creditorType = overrides.creditorAccountType || 'CTA_CORRIENTE';\n  var creditorEntity = overrides.creditorEntity || overrides.instdAgtFinInstId || coopCode;\n  var debtorAccounts = catalog[coopCode] || catalog['0205'];\n  var creditorAccounts = catalog[creditorEntity] || catalog['0303'];\n  var debtorIban = overrides.debtorIban || (debtorAccounts ? (debtorAccounts[debtorType] || debtorAccounts['CTA_AHORROS']) : 'EC5002051000000000020501052673');\n  var creditorIban = overrides.creditorIban || (creditorAccounts ? (creditorAccounts[creditorType] || creditorAccounts['CTA_CORRIENTE']) : 'EC0403031000000000030101002222');\n  if (overrides.sameIban){\n    creditorIban = debtorIban;\n  }\n  var msgId = overrides.msgId || (coopCode + token.currentDate + randomDigits(11));\n  var endToEndId = overrides.endToEndId || (coopCode + token.currentDate + randomDigits(5));\n  var amountValue = overrides.amount != null ? overrides.amount : 1.00;\n  var payload = {\n    GrpHdr: {\n      msgId: msgId,\n      creDtTm: timestamp,\n      nbOfTxs: overrides.nbOfTxs || 1,\n      sttlmInf: { sttlmMtd: overrides.settlementMethod || 'INGA' },\n      instgAgt: { finInstnId: coopCode },\n      InstdAgt: { FinInstnId: overrides.instdAgtFinInstId || creditorEntity },\n      Mge: { Type: overrides.messageType || 'acmt.998.321.01' },\n      ChnlId: overrides.channel || 'APP'\n    },\n    CdtTrfTxInf: {\n      PmtId: { EndToEndId: endToEndId },\n      IntrBkSttlmAmt: { Amt: amountValue, Ccy: overrides.currency || 'USD' },\n      DbtrAcctId: { IBAN: debtorIban },\n      CdtrAcctId: { IBAN: creditorIban },\n      Prtry: {\n        CustRef: overrides.customerReference || 'QA22',\n        ChanRef: overrides.channelReference || (overrides.channel === 'QR' ? 'QRPANAPAY' : 'TERM001'),\n        AgtRef: overrides.agentReference || 'AGT0002'\n      }\n    }\n  };\n  if (overrides.prtryOverrides){\n    Object.keys(overrides.prtryOverrides).forEach(function(key){\n      payload.CdtTrfTxInf.Prtry[key] = overrides.prtryOverrides[key];\n    });\n  }\n  if (overrides.overrideHeaders){\n    payload.GrpHdr.instgAgt = overrides.overrideHeaders.instgAgt || payload.GrpHdr.instgAgt;\n    payload.GrpHdr.InstdAgt = overrides.overrideHeaders.instdAgt || payload.GrpHdr.InstdAgt;\n  }\n  return payload;\n}","index":9,"text":"def buildPayload ="}},{"result":{"nanos":172200,"millis":0.1722,"status":"passed"},"step":{"endLine":150,"background":true,"line":111,"prefix":"*","docString":"function(body, expectation){\n  expectation = expectation || {};\n  var txInfo = (body && body.CdtTrfTxInf) ? body.CdtTrfTxInf : {};\n  var outcome = expectation.outcome || 'success';\n  var requireTxOk = expectation.requireTxOk === true;\n  var requireTxReject = expectation.requireTxReject === true;\n  var expectedTxStatus = expectation.expectedTxStatus;\n  if (expectedTxStatus != null){\n    karate.match(txInfo.TxSts, expectedTxStatus);\n  } else if (outcome === 'success' && requireTxOk){\n    karate.match(txInfo.TxSts, 'Ok');\n  } else if (outcome === 'reject' && requireTxReject){\n    karate.match(txInfo.TxSts, '#? _ && _ != \"Ok\"');\n  } else {\n    if (txInfo && txInfo.TxSts){\n      karate.log('TxSts recibido:', txInfo.TxSts, '- no se valida estrictamente.');\n    } else {\n      karate.log('Sin TxSts en la respuesta, continuando sin validacion.');\n    }\n  }\n  if (outcome === 'pending'){\n    karate.match(txInfo.TxSts, '#? _ == \"PENDING\" || _ == \"PROC\"');\n  }\n  if (expectation.reasonCode){\n    var reasonNode = txInfo.Rsn || {};\n    karate.match(reasonNode.RsnCd, expectation.reasonCode);\n  }\n  if (expectation.expectedEndToEndId){\n    karate.match(txInfo.PmtId.EndToEndId, expectation.expectedEndToEndId);\n  }\n  if (expectation.expectedMsgId){\n    var grpHdr = (body && body.GrpHdr) ? body.GrpHdr : {};\n    karate.match(grpHdr.msgId, expectation.expectedMsgId);\n  }\n}","index":10,"text":"def verifyTransferOutcome ="}},{"result":{"nanos":150100,"millis":0.1501,"status":"passed"},"step":{"endLine":156,"background":true,"line":151,"prefix":"*","docString":"function(name, payload, responseBody, status){\n  karate.log('[Transfer]', name, '| status:', status, '| msgId:', payload.GrpHdr.msgId, '| endToEnd:', payload.CdtTrfTxInf.PmtId.EndToEndId);\n}","index":11,"text":"def logTransferSummary ="}},{"result":{"nanos":12967500,"millis":12.9675,"status":"passed"},"step":{"line":267,"prefix":"*","index":0,"text":"def payload = buildPayload({ amount: 15000.75 })"}},{"result":{"nanos":472700,"millis":0.4727,"status":"passed"},"step":{"line":268,"prefix":"*","index":1,"text":"def expectation = { httpStatus: [422, 409, 400], outcome: 'reject' }"}},{"result":{"nanos":1223100,"millis":1.2231,"status":"passed"},"step":{"line":269,"prefix":"*","index":2,"text":"def normalizedStatus = normalizeStatus(expectation.httpStatus)"}},{"result":{"nanos":200400,"millis":0.2004,"status":"passed"},"step":{"line":270,"prefix":"Given","index":3,"text":"path 'finan', 'transferencia'"}},{"result":{"nanos":91200,"millis":0.0912,"status":"passed"},"step":{"line":271,"prefix":"And","index":4,"text":"request payload"}},{"result":{"nanos":1741256400,"millis":1741.2564,"status":"passed"},"step":{"line":272,"prefix":"When","index":5,"text":"method post"},"stepLog":"14:14:43.624 request:\n1 > POST https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral\/finan\/transferencia\n1 > Content-Type: application\/json; charset=UTF-8\n1 > Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2dUJWTkN6VlViUFBlTFdReEM0WDAyYVM3UnM2UGRYV1dja1dfc0xZMHlFIn0.eyJleHAiOjE3NjExNjA3NTAsImlhdCI6MTc2MTE2MDQ1MCwianRpIjoidHJydGNjOjQ5Yjg0NDVjLTgzYTAtMjI4Ni02NDczLWE2ZGEzOTBhOWQ0YSIsImlzcyI6Imh0dHBzOi8vYXV0ZW50aWNhY2lvbnFhLmNvb25lY3RhLmNvbS5lYy9hdXRoL3JlYWxtcy9QQU5BUEFZIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6Ijk5OGMyZmUwLTJjOGYtNGQwNC1iZjExLWY1OWExZTM5ODg3MyIsInR5cCI6IkJlYXJlciIsImF6cCI6IjAyMDVjYiIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiLyoiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRlZmF1bHQtcm9sZXMtYWRtaW5wYW5hcGF5Iiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7IjAyMDVjYiI6eyJyb2xlcyI6WyJ1bWFfcHJvdGVjdGlvbiJdfSwiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJjbGllbnRIb3N0IjoiMTAuMTAuMTAuMTUxIiwicHJlZmVycmVkX3VzZXJuYW1lIjoic2VydmljZS1hY2NvdW50LTAyMDVjYiIsImNsaWVudEFkZHJlc3MiOiIxMC4xMC4xMC4xNTEiLCJjbGllbnRfaWQiOiIwMjA1Y2IifQ.bATUogohrEqy7Voa4mFnsBzOnGy6tnjZGh_lOYRn-0hWXMY_fz-280nTu2Vv68eO3HeoewtWlt45S_iLI2-ml3pqpAlt3DXWVmLvVHw6d7TICHBfQsa0jGXMexKnyar7EinrVhF3deSK25Ap_ajC_82EvVvXrVG-7p9F1dEdq39y2R72JympejF5uhY_z_jNmqJSsnLEZVOo3WMJn76u9tTcYVIldC5uWGFWbPGEhvWPx4ZGpsuq_wrPOGdRmyJDFJPJl7LnLGHK0DBhuVtJUq_NFQkMus2fTTf_mWhRnoqNU-wUCS-fxMs6QusGzIVd-C3O29J3rerHTrGg21LAsQ\n1 > Content-Length: 516\n1 > Host: apipanapayqa.coonecta.com.ec\n1 > Connection: Keep-Alive\n1 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/17.0.12)\n1 > Accept-Encoding: gzip,deflate\n{\"GrpHdr\":{\"msgId\":\"02052025102231912219681\",\"creDtTm\":\"2025-10-22T14:14:43\",\"nbOfTxs\":1,\"sttlmInf\":{\"sttlmMtd\":\"INGA\"},\"instgAgt\":{\"finInstnId\":\"0205\"},\"InstdAgt\":{\"FinInstnId\":\"0205\"},\"Mge\":{\"Type\":\"acmt.998.321.01\"},\"ChnlId\":\"APP\"},\"CdtTrfTxInf\":{\"PmtId\":{\"EndToEndId\":\"02052025102299017\"},\"IntrBkSttlmAmt\":{\"Amt\":15000.75,\"Ccy\":\"USD\"},\"DbtrAcctId\":{\"IBAN\":\"EC5002051000000000020501052673\"},\"CdtrAcctId\":{\"IBAN\":\"EC0402051000000000020101002318\"},\"Prtry\":{\"CustRef\":\"QA22\",\"ChanRef\":\"TERM001\",\"AgtRef\":\"AGT0002\"}}}\n\n14:14:45.357 response time in milliseconds: 1733\n1 < 400\n1 < Date: Wed, 22 Oct 2025 19:14:36 GMT\n1 < Content-Type: application\/json; charset=utf-8\n1 < Transfer-Encoding: chunked\n1 < Connection: keep-alive\n1 < Server: Kestrel\n1 < Set-Cookie: ARRAffinity=135f536e0d078a815c3b83fda3468ab8a3a2abc604a35eefb28648d3961cfa9b;Path=\/;HttpOnly;Secure;Domain=app-apipanapay-qa.azurewebsites.net\n1 < Set-Cookie: ARRAffinitySameSite=135f536e0d078a815c3b83fda3468ab8a3a2abc604a35eefb28648d3961cfa9b;Path=\/;HttpOnly;SameSite=None;Secure;Domain=app-apipanapay-qa.azurewebsites.net\n1 < Request-Context: appId=cid-v1:a7a77847-2713-450f-9030-b350a2d54a28\n1 < X-Powered-By: ASP.NET\n1 < X-ARR-ClientCert: -----BEGIN%20CERTIFICATE-----%0AMIIEHDCCAgSgAwIBAgIUZIZBO0fb7VZ4KXrs01S4RYbWyJ8wDQYJKoZIhvcNAQEL%0ABQAwJTEjMCEGA1UEAwwacm9vdGNlcnQuY2JpYmxpYW4uaW50ZXJuYWwwHhcNMjUw%0AODEzMTMyNTU5WhcNMjgwODEyMTMyNTU5WjAnMSUwIwYDVQQDDBxjbGllbnRjZXJ0%0ALmNiaWJsaWFuLmludGVybmFsMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKC%0AAQEAskUDap6NmyYq8RT6F7z3DpZGQiflNQTvUT84TmxsKXEBRAkgINnkJqgKkd7f%0ASEybzqglQTbr4s41lCiPsy3X66qYjU2L%2Bojhni%2BOCVOX7n3JBYovL%2FqfMP3%2FkhZP%0AQIlK%2FQWPcrnl39fYkGOQv%2BYqoCGEPzGkib2m1Ma5Q1HOCKh1ErMjqTLGy%2ByJj6JY%0AiZvMx3YrJSvjUS0uKpNwxPtGyiexRfKsmR%2FHqPzRHa0iY%2B752KSgUedwJPv1Wod%2B%0AY9BMAMIdU25UtkUEsaOYtorGWDaZSn2Bl0LYmP87kjcYypnHx0jtPtUCXfVHrE6u%0AZnDRFYsZbeXylY3mJkyOL2DzZwIDAQABo0IwQDAdBgNVHQ4EFgQURPhJwTAcUWUp%0ArOqQO68P%2FbJoqjMwHwYDVR0jBBgwFoAU7GdlxoSeEXucEXhjadHRC9xzS0UwDQYJ%0AKoZIhvcNAQELBQADggIBAGTnlyF2n%2F6s9phYbO8V17niO0BXB62ToX6gPhcw9f3y%0AhMui6RnrM1oiHlBWqZquCqYJ5ETvYJE1RqvoqtGysxCnIj0OTJHV4WtF3SHsd1Tu%0ATg%2B%2FUnGivtBTDQxj9sbAtCaSYRBqPByP8jvSTDgXR1mgOrEGjr2PZdZSoKLj4OHi%0A9UCMJw7pJsyA4lbroKshQTYv5Ks5SqtJpdp0%2BUX0UUlbPJqXiadfbKdoXvEgcwbP%0ACqR9v7kGYmNxfaGLNGVrV%2BnLawIDmdYXJE%2F4WJh6sHfiZxEsE%2BB4PoKADrb1Eapt%0AnSdHUgRfc0i5f2lcmErnU8nCMO5TWdHFOgpYwTS8w17FhNFZpaSmyZKM7uHcUs7y%0AUbuiQtdXocfSSMf%2FeycBEU%2FHAVIWQEqY%2BbJdC0q%2FR%2BsESeBtXd4IEIxR0QfgscGk%0AJyCSFC8z%2FvCgrRsH5rePqKO7%2FLAsDTP4GIQNFNfF4Wh6bsPXuJmvvoMcnmy%2F58Wo%0AE0XaG8UPHVAeyEmhncdM32E7SJbR91aRr2CkV23OoUz%2BwKG2%2FuObHmAkuMkCbbcz%0AJQoC7DZg5FGw%2BZR7v1DIBct5QNJQ8bG%2FXGRxjWC6dU7jrGhOF1X%2B2YYcdx9XnwyM%0A9YPxUy5bVfMhIiKP2wEso5fjOZ4RTvnB5R6zD3maJK%2FtZAXVhtyqXSkBYFi4MvEs%0A-----END%20CERTIFICATE-----%0A\n{\"GrpHdr\":{\"MsgId\":\"000020251022020362\",\"CreDtTm\":\"2025-10-22T14:14:36\",\"NbOfTxs\":1,\"SttlmInf\":{\"SttlmMtd\":\"INGA\"},\"InstgAgt\":{\"FinInstnId\":\"0205\"},\"InstdAgt\":{\"FinInstnId\":\"0205\"},\"Mge\":{\"Type\":\"acmt.998.322.001\"},\"ChnlId\":\"APP\"},\"CdtTrfTxInf\":{\"OrgnGrpInf\":{\"OrgnlMsgId\":\"02052025102231912219681\",\"OrgnlMgeType\":\"acmt.998.321.01\",\"OrgnlCreDtTm\":\"2025-10-22T14:14:43\"},\"TxSts\":\"ERR\",\"Rsn\":{\"RsnCd\":\"AM02\",\"AddtlInf\":\"El monto excede el máximo permitido.\"},\"SttlmDt\":\"2025-10-22\"}}\n\n"},{"result":{"nanos":0,"errorMessage":"no step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:273","millis":0.0,"status":"failed"},"step":{"line":273,"prefix":"Then","index":6,"text":"match responseStatus in normalizedStatus"},"stepLog":"14:14:45.365 classpath:Transferencia.feature:273\nThen match responseStatus in normalizedStatus\nno step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:273\n"},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":274,"prefix":"*","index":7,"text":"eval verifyTransferOutcome(response, expectation)"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":275,"prefix":"*","index":8,"text":"eval logTransferSummary('Monto decimal supera limite', payload, response, responseStatus)"}}],"line":266,"description":"","durationMillis":1764.7334,"failed":true,"error":"no step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:273","tags":["transferencia"],"executorName":"main","name":"Transferencia no exitosa, monto maximo con decimales por transaccion","startTime":1761160483584,"refId":"[9:266]","endTime":1761160485365,"exampleIndex":-1},{"sectionIndex":9,"stepResults":[{"result":{"nanos":4856200,"millis":4.8562,"status":"passed"},"step":{"background":true,"line":5,"prefix":"*","index":0,"text":"def tokenContext = callonce read('classpath:helpers\/generate-token.feature')"},"stepLog":"14:14:45.382 key store key count for classpath:certificado\/clientcert.cbiblian.internal 1.pfx: 1\n"},{"result":{"nanos":812700,"millis":0.8127,"status":"passed"},"step":{"background":true,"line":6,"prefix":"*","index":1,"text":"def tokenData = tokenContext.tokenInfo"}},{"result":{"nanos":1445800,"millis":1.4458,"status":"passed"},"step":{"background":true,"line":7,"prefix":"*","index":2,"text":"def transferenciaBaseUrl = karate.properties['transfer.baseUrl'] || 'https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral'"}},{"result":{"nanos":182300,"millis":0.1823,"status":"passed"},"step":{"background":true,"line":8,"prefix":"*","index":3,"text":"url transferenciaBaseUrl"}},{"result":{"nanos":691100,"millis":0.6911,"status":"passed"},"step":{"background":true,"line":9,"prefix":"*","index":4,"text":"def authHeaders = { 'Content-Type': 'application\/json' }"}},{"result":{"nanos":946300,"millis":0.9463,"status":"passed"},"step":{"background":true,"line":10,"prefix":"*","index":5,"text":"set authHeaders.Authorization = 'Bearer ' + tokenData.auth_tokencb"}},{"result":{"nanos":69000,"millis":0.069,"status":"passed"},"step":{"background":true,"line":11,"prefix":"*","index":6,"text":"configure headers = authHeaders"}},{"result":{"nanos":209300,"millis":0.2093,"status":"passed"},"step":{"endLine":24,"background":true,"line":12,"prefix":"*","docString":"{\n  \"0205\": {\n    \"CTA_AHORROS\": \"EC5002051000000000020501052673\",\n    \"CTA_CORRIENTE\": \"EC0402051000000000020101002318\"\n  },\n  \"0303\": {\n    \"CTA_AHORROS\": \"EC5003031000000000030301051111\",\n    \"CTA_CORRIENTE\": \"EC0403031000000000030101002222\"\n  }\n}","index":7,"text":"def accountCatalog ="}},{"result":{"nanos":196900,"millis":0.1969,"status":"passed"},"step":{"endLine":39,"background":true,"line":25,"prefix":"*","docString":"function(value){\n  var list;\n  if (!value && value !== 0){\n    list = [200];\n  } else {\n    list = Array.isArray(value) ? value.slice(0) : [value];\n  }\n  if (list.indexOf(200) === -1){\n    list.push(200);\n  }\n  return list;\n}","index":8,"text":"def normalizeStatus ="}},{"result":{"nanos":249800,"millis":0.2498,"status":"passed"},"step":{"endLine":110,"background":true,"line":40,"prefix":"*","docString":"function(overrides){\n  overrides = overrides || {};\n  var token = karate.get('tokenData');\n  var catalog = karate.get('accountCatalog');\n  var LocalDateTime = Java.type('java.time.LocalDateTime');\n  var DateTimeFormatter = Java.type('java.time.format.DateTimeFormatter');\n  var timestamp = LocalDateTime.now().format(DateTimeFormatter.ofPattern(\"yyyy-MM-dd'T'HH:mm:ss\"));\n  var randomDigits = function(length){\n    var digits = '';\n    for (var i = 0; i < length; i++){\n      digits += Math.floor(Math.random() * 10);\n    }\n    return digits;\n  };\n  var coopCode = overrides.instgAgtFinInstId || token.coop_codecb || '0205';\n  var debtorType = overrides.debtorAccountType || 'CTA_AHORROS';\n  var creditorType = overrides.creditorAccountType || 'CTA_CORRIENTE';\n  var creditorEntity = overrides.creditorEntity || overrides.instdAgtFinInstId || coopCode;\n  var debtorAccounts = catalog[coopCode] || catalog['0205'];\n  var creditorAccounts = catalog[creditorEntity] || catalog['0303'];\n  var debtorIban = overrides.debtorIban || (debtorAccounts ? (debtorAccounts[debtorType] || debtorAccounts['CTA_AHORROS']) : 'EC5002051000000000020501052673');\n  var creditorIban = overrides.creditorIban || (creditorAccounts ? (creditorAccounts[creditorType] || creditorAccounts['CTA_CORRIENTE']) : 'EC0403031000000000030101002222');\n  if (overrides.sameIban){\n    creditorIban = debtorIban;\n  }\n  var msgId = overrides.msgId || (coopCode + token.currentDate + randomDigits(11));\n  var endToEndId = overrides.endToEndId || (coopCode + token.currentDate + randomDigits(5));\n  var amountValue = overrides.amount != null ? overrides.amount : 1.00;\n  var payload = {\n    GrpHdr: {\n      msgId: msgId,\n      creDtTm: timestamp,\n      nbOfTxs: overrides.nbOfTxs || 1,\n      sttlmInf: { sttlmMtd: overrides.settlementMethod || 'INGA' },\n      instgAgt: { finInstnId: coopCode },\n      InstdAgt: { FinInstnId: overrides.instdAgtFinInstId || creditorEntity },\n      Mge: { Type: overrides.messageType || 'acmt.998.321.01' },\n      ChnlId: overrides.channel || 'APP'\n    },\n    CdtTrfTxInf: {\n      PmtId: { EndToEndId: endToEndId },\n      IntrBkSttlmAmt: { Amt: amountValue, Ccy: overrides.currency || 'USD' },\n      DbtrAcctId: { IBAN: debtorIban },\n      CdtrAcctId: { IBAN: creditorIban },\n      Prtry: {\n        CustRef: overrides.customerReference || 'QA22',\n        ChanRef: overrides.channelReference || (overrides.channel === 'QR' ? 'QRPANAPAY' : 'TERM001'),\n        AgtRef: overrides.agentReference || 'AGT0002'\n      }\n    }\n  };\n  if (overrides.prtryOverrides){\n    Object.keys(overrides.prtryOverrides).forEach(function(key){\n      payload.CdtTrfTxInf.Prtry[key] = overrides.prtryOverrides[key];\n    });\n  }\n  if (overrides.overrideHeaders){\n    payload.GrpHdr.instgAgt = overrides.overrideHeaders.instgAgt || payload.GrpHdr.instgAgt;\n    payload.GrpHdr.InstdAgt = overrides.overrideHeaders.instdAgt || payload.GrpHdr.InstdAgt;\n  }\n  return payload;\n}","index":9,"text":"def buildPayload ="}},{"result":{"nanos":170600,"millis":0.1706,"status":"passed"},"step":{"endLine":150,"background":true,"line":111,"prefix":"*","docString":"function(body, expectation){\n  expectation = expectation || {};\n  var txInfo = (body && body.CdtTrfTxInf) ? body.CdtTrfTxInf : {};\n  var outcome = expectation.outcome || 'success';\n  var requireTxOk = expectation.requireTxOk === true;\n  var requireTxReject = expectation.requireTxReject === true;\n  var expectedTxStatus = expectation.expectedTxStatus;\n  if (expectedTxStatus != null){\n    karate.match(txInfo.TxSts, expectedTxStatus);\n  } else if (outcome === 'success' && requireTxOk){\n    karate.match(txInfo.TxSts, 'Ok');\n  } else if (outcome === 'reject' && requireTxReject){\n    karate.match(txInfo.TxSts, '#? _ && _ != \"Ok\"');\n  } else {\n    if (txInfo && txInfo.TxSts){\n      karate.log('TxSts recibido:', txInfo.TxSts, '- no se valida estrictamente.');\n    } else {\n      karate.log('Sin TxSts en la respuesta, continuando sin validacion.');\n    }\n  }\n  if (outcome === 'pending'){\n    karate.match(txInfo.TxSts, '#? _ == \"PENDING\" || _ == \"PROC\"');\n  }\n  if (expectation.reasonCode){\n    var reasonNode = txInfo.Rsn || {};\n    karate.match(reasonNode.RsnCd, expectation.reasonCode);\n  }\n  if (expectation.expectedEndToEndId){\n    karate.match(txInfo.PmtId.EndToEndId, expectation.expectedEndToEndId);\n  }\n  if (expectation.expectedMsgId){\n    var grpHdr = (body && body.GrpHdr) ? body.GrpHdr : {};\n    karate.match(grpHdr.msgId, expectation.expectedMsgId);\n  }\n}","index":10,"text":"def verifyTransferOutcome ="}},{"result":{"nanos":127300,"millis":0.1273,"status":"passed"},"step":{"endLine":156,"background":true,"line":151,"prefix":"*","docString":"function(name, payload, responseBody, status){\n  karate.log('[Transfer]', name, '| status:', status, '| msgId:', payload.GrpHdr.msgId, '| endToEnd:', payload.CdtTrfTxInf.PmtId.EndToEndId);\n}","index":11,"text":"def logTransferSummary ="}},{"result":{"nanos":3952600,"millis":3.9526,"status":"passed"},"step":{"line":278,"prefix":"*","index":0,"text":"def payload = buildPayload({ amount: 20000 })"}},{"result":{"nanos":218800,"millis":0.2188,"status":"passed"},"step":{"line":279,"prefix":"*","index":1,"text":"def expectation = { httpStatus: [422, 409, 400], outcome: 'reject' }"}},{"result":{"nanos":1229700,"millis":1.2297,"status":"passed"},"step":{"line":280,"prefix":"*","index":2,"text":"def normalizedStatus = normalizeStatus(expectation.httpStatus)"}},{"result":{"nanos":172900,"millis":0.1729,"status":"passed"},"step":{"line":281,"prefix":"Given","index":3,"text":"path 'finan', 'transferencia'"}},{"result":{"nanos":57200,"millis":0.0572,"status":"passed"},"step":{"line":282,"prefix":"And","index":4,"text":"request payload"}},{"result":{"nanos":1982916000,"millis":1982.916,"status":"passed"},"step":{"line":283,"prefix":"When","index":5,"text":"method post"},"stepLog":"14:14:45.406 request:\n1 > POST https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral\/finan\/transferencia\n1 > Content-Type: application\/json; charset=UTF-8\n1 > Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2dUJWTkN6VlViUFBlTFdReEM0WDAyYVM3UnM2UGRYV1dja1dfc0xZMHlFIn0.eyJleHAiOjE3NjExNjA3NTAsImlhdCI6MTc2MTE2MDQ1MCwianRpIjoidHJydGNjOjQ5Yjg0NDVjLTgzYTAtMjI4Ni02NDczLWE2ZGEzOTBhOWQ0YSIsImlzcyI6Imh0dHBzOi8vYXV0ZW50aWNhY2lvbnFhLmNvb25lY3RhLmNvbS5lYy9hdXRoL3JlYWxtcy9QQU5BUEFZIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6Ijk5OGMyZmUwLTJjOGYtNGQwNC1iZjExLWY1OWExZTM5ODg3MyIsInR5cCI6IkJlYXJlciIsImF6cCI6IjAyMDVjYiIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiLyoiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRlZmF1bHQtcm9sZXMtYWRtaW5wYW5hcGF5Iiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7IjAyMDVjYiI6eyJyb2xlcyI6WyJ1bWFfcHJvdGVjdGlvbiJdfSwiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJjbGllbnRIb3N0IjoiMTAuMTAuMTAuMTUxIiwicHJlZmVycmVkX3VzZXJuYW1lIjoic2VydmljZS1hY2NvdW50LTAyMDVjYiIsImNsaWVudEFkZHJlc3MiOiIxMC4xMC4xMC4xNTEiLCJjbGllbnRfaWQiOiIwMjA1Y2IifQ.bATUogohrEqy7Voa4mFnsBzOnGy6tnjZGh_lOYRn-0hWXMY_fz-280nTu2Vv68eO3HeoewtWlt45S_iLI2-ml3pqpAlt3DXWVmLvVHw6d7TICHBfQsa0jGXMexKnyar7EinrVhF3deSK25Ap_ajC_82EvVvXrVG-7p9F1dEdq39y2R72JympejF5uhY_z_jNmqJSsnLEZVOo3WMJn76u9tTcYVIldC5uWGFWbPGEhvWPx4ZGpsuq_wrPOGdRmyJDFJPJl7LnLGHK0DBhuVtJUq_NFQkMus2fTTf_mWhRnoqNU-wUCS-fxMs6QusGzIVd-C3O29J3rerHTrGg21LAsQ\n1 > Content-Length: 515\n1 > Host: apipanapayqa.coonecta.com.ec\n1 > Connection: Keep-Alive\n1 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/17.0.12)\n1 > Accept-Encoding: gzip,deflate\n{\"GrpHdr\":{\"msgId\":\"02052025102291567638368\",\"creDtTm\":\"2025-10-22T14:14:45\",\"nbOfTxs\":1,\"sttlmInf\":{\"sttlmMtd\":\"INGA\"},\"instgAgt\":{\"finInstnId\":\"0205\"},\"InstdAgt\":{\"FinInstnId\":\"0205\"},\"Mge\":{\"Type\":\"acmt.998.321.01\"},\"ChnlId\":\"APP\"},\"CdtTrfTxInf\":{\"PmtId\":{\"EndToEndId\":\"02052025102200102\"},\"IntrBkSttlmAmt\":{\"Amt\":20000.0,\"Ccy\":\"USD\"},\"DbtrAcctId\":{\"IBAN\":\"EC5002051000000000020501052673\"},\"CdtrAcctId\":{\"IBAN\":\"EC0402051000000000020101002318\"},\"Prtry\":{\"CustRef\":\"QA22\",\"ChanRef\":\"TERM001\",\"AgtRef\":\"AGT0002\"}}}\n\n14:14:47.389 response time in milliseconds: 1980\n1 < 400\n1 < Date: Wed, 22 Oct 2025 19:14:39 GMT\n1 < Content-Type: application\/json; charset=utf-8\n1 < Transfer-Encoding: chunked\n1 < Connection: keep-alive\n1 < Server: Kestrel\n1 < Set-Cookie: ARRAffinity=135f536e0d078a815c3b83fda3468ab8a3a2abc604a35eefb28648d3961cfa9b;Path=\/;HttpOnly;Secure;Domain=app-apipanapay-qa.azurewebsites.net\n1 < Set-Cookie: ARRAffinitySameSite=135f536e0d078a815c3b83fda3468ab8a3a2abc604a35eefb28648d3961cfa9b;Path=\/;HttpOnly;SameSite=None;Secure;Domain=app-apipanapay-qa.azurewebsites.net\n1 < Request-Context: appId=cid-v1:a7a77847-2713-450f-9030-b350a2d54a28\n1 < X-Powered-By: ASP.NET\n1 < X-ARR-ClientCert: -----BEGIN%20CERTIFICATE-----%0AMIIEHDCCAgSgAwIBAgIUZIZBO0fb7VZ4KXrs01S4RYbWyJ8wDQYJKoZIhvcNAQEL%0ABQAwJTEjMCEGA1UEAwwacm9vdGNlcnQuY2JpYmxpYW4uaW50ZXJuYWwwHhcNMjUw%0AODEzMTMyNTU5WhcNMjgwODEyMTMyNTU5WjAnMSUwIwYDVQQDDBxjbGllbnRjZXJ0%0ALmNiaWJsaWFuLmludGVybmFsMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKC%0AAQEAskUDap6NmyYq8RT6F7z3DpZGQiflNQTvUT84TmxsKXEBRAkgINnkJqgKkd7f%0ASEybzqglQTbr4s41lCiPsy3X66qYjU2L%2Bojhni%2BOCVOX7n3JBYovL%2FqfMP3%2FkhZP%0AQIlK%2FQWPcrnl39fYkGOQv%2BYqoCGEPzGkib2m1Ma5Q1HOCKh1ErMjqTLGy%2ByJj6JY%0AiZvMx3YrJSvjUS0uKpNwxPtGyiexRfKsmR%2FHqPzRHa0iY%2B752KSgUedwJPv1Wod%2B%0AY9BMAMIdU25UtkUEsaOYtorGWDaZSn2Bl0LYmP87kjcYypnHx0jtPtUCXfVHrE6u%0AZnDRFYsZbeXylY3mJkyOL2DzZwIDAQABo0IwQDAdBgNVHQ4EFgQURPhJwTAcUWUp%0ArOqQO68P%2FbJoqjMwHwYDVR0jBBgwFoAU7GdlxoSeEXucEXhjadHRC9xzS0UwDQYJ%0AKoZIhvcNAQELBQADggIBAGTnlyF2n%2F6s9phYbO8V17niO0BXB62ToX6gPhcw9f3y%0AhMui6RnrM1oiHlBWqZquCqYJ5ETvYJE1RqvoqtGysxCnIj0OTJHV4WtF3SHsd1Tu%0ATg%2B%2FUnGivtBTDQxj9sbAtCaSYRBqPByP8jvSTDgXR1mgOrEGjr2PZdZSoKLj4OHi%0A9UCMJw7pJsyA4lbroKshQTYv5Ks5SqtJpdp0%2BUX0UUlbPJqXiadfbKdoXvEgcwbP%0ACqR9v7kGYmNxfaGLNGVrV%2BnLawIDmdYXJE%2F4WJh6sHfiZxEsE%2BB4PoKADrb1Eapt%0AnSdHUgRfc0i5f2lcmErnU8nCMO5TWdHFOgpYwTS8w17FhNFZpaSmyZKM7uHcUs7y%0AUbuiQtdXocfSSMf%2FeycBEU%2FHAVIWQEqY%2BbJdC0q%2FR%2BsESeBtXd4IEIxR0QfgscGk%0AJyCSFC8z%2FvCgrRsH5rePqKO7%2FLAsDTP4GIQNFNfF4Wh6bsPXuJmvvoMcnmy%2F58Wo%0AE0XaG8UPHVAeyEmhncdM32E7SJbR91aRr2CkV23OoUz%2BwKG2%2FuObHmAkuMkCbbcz%0AJQoC7DZg5FGw%2BZR7v1DIBct5QNJQ8bG%2FXGRxjWC6dU7jrGhOF1X%2B2YYcdx9XnwyM%0A9YPxUy5bVfMhIiKP2wEso5fjOZ4RTvnB5R6zD3maJK%2FtZAXVhtyqXSkBYFi4MvEs%0A-----END%20CERTIFICATE-----%0A\n{\"GrpHdr\":{\"MsgId\":\"000020251022020363\",\"CreDtTm\":\"2025-10-22T14:14:38\",\"NbOfTxs\":1,\"SttlmInf\":{\"SttlmMtd\":\"INGA\"},\"InstgAgt\":{\"FinInstnId\":\"0205\"},\"InstdAgt\":{\"FinInstnId\":\"0205\"},\"Mge\":{\"Type\":\"acmt.998.322.001\"},\"ChnlId\":\"APP\"},\"CdtTrfTxInf\":{\"OrgnGrpInf\":{\"OrgnlMsgId\":\"02052025102291567638368\",\"OrgnlMgeType\":\"acmt.998.321.01\",\"OrgnlCreDtTm\":\"2025-10-22T14:14:45\"},\"TxSts\":\"ERR\",\"Rsn\":{\"RsnCd\":\"AM02\",\"AddtlInf\":\"El monto excede el máximo permitido.\"},\"SttlmDt\":\"2025-10-22\"}}\n\n"},{"result":{"nanos":0,"errorMessage":"no step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:284","millis":0.0,"status":"failed"},"step":{"line":284,"prefix":"Then","index":6,"text":"match responseStatus in normalizedStatus"},"stepLog":"14:14:47.391 classpath:Transferencia.feature:284\nThen match responseStatus in normalizedStatus\nno step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:284\n"},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":285,"prefix":"*","index":7,"text":"eval verifyTransferOutcome(response, expectation)"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":286,"prefix":"*","index":8,"text":"eval logTransferSummary('Monto entero supera limite', payload, response, responseStatus)"}}],"line":277,"description":"","durationMillis":1998.5045,"failed":true,"error":"no step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:284","tags":["transferencia"],"executorName":"main","name":"Transferencia no exitosa, monto maximo entero por transaccion","startTime":1761160485380,"refId":"[10:277]","endTime":1761160487391,"exampleIndex":-1},{"sectionIndex":10,"stepResults":[{"result":{"nanos":3674100,"millis":3.6741,"status":"passed"},"step":{"background":true,"line":5,"prefix":"*","index":0,"text":"def tokenContext = callonce read('classpath:helpers\/generate-token.feature')"},"stepLog":"14:14:47.411 key store key count for classpath:certificado\/clientcert.cbiblian.internal 1.pfx: 1\n"},{"result":{"nanos":336600,"millis":0.3366,"status":"passed"},"step":{"background":true,"line":6,"prefix":"*","index":1,"text":"def tokenData = tokenContext.tokenInfo"}},{"result":{"nanos":465700,"millis":0.4657,"status":"passed"},"step":{"background":true,"line":7,"prefix":"*","index":2,"text":"def transferenciaBaseUrl = karate.properties['transfer.baseUrl'] || 'https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral'"}},{"result":{"nanos":94100,"millis":0.0941,"status":"passed"},"step":{"background":true,"line":8,"prefix":"*","index":3,"text":"url transferenciaBaseUrl"}},{"result":{"nanos":417800,"millis":0.4178,"status":"passed"},"step":{"background":true,"line":9,"prefix":"*","index":4,"text":"def authHeaders = { 'Content-Type': 'application\/json' }"}},{"result":{"nanos":1954300,"millis":1.9543,"status":"passed"},"step":{"background":true,"line":10,"prefix":"*","index":5,"text":"set authHeaders.Authorization = 'Bearer ' + tokenData.auth_tokencb"}},{"result":{"nanos":91800,"millis":0.0918,"status":"passed"},"step":{"background":true,"line":11,"prefix":"*","index":6,"text":"configure headers = authHeaders"}},{"result":{"nanos":361700,"millis":0.3617,"status":"passed"},"step":{"endLine":24,"background":true,"line":12,"prefix":"*","docString":"{\n  \"0205\": {\n    \"CTA_AHORROS\": \"EC5002051000000000020501052673\",\n    \"CTA_CORRIENTE\": \"EC0402051000000000020101002318\"\n  },\n  \"0303\": {\n    \"CTA_AHORROS\": \"EC5003031000000000030301051111\",\n    \"CTA_CORRIENTE\": \"EC0403031000000000030101002222\"\n  }\n}","index":7,"text":"def accountCatalog ="}},{"result":{"nanos":927900,"millis":0.9279,"status":"passed"},"step":{"endLine":39,"background":true,"line":25,"prefix":"*","docString":"function(value){\n  var list;\n  if (!value && value !== 0){\n    list = [200];\n  } else {\n    list = Array.isArray(value) ? value.slice(0) : [value];\n  }\n  if (list.indexOf(200) === -1){\n    list.push(200);\n  }\n  return list;\n}","index":8,"text":"def normalizeStatus ="}},{"result":{"nanos":465700,"millis":0.4657,"status":"passed"},"step":{"endLine":110,"background":true,"line":40,"prefix":"*","docString":"function(overrides){\n  overrides = overrides || {};\n  var token = karate.get('tokenData');\n  var catalog = karate.get('accountCatalog');\n  var LocalDateTime = Java.type('java.time.LocalDateTime');\n  var DateTimeFormatter = Java.type('java.time.format.DateTimeFormatter');\n  var timestamp = LocalDateTime.now().format(DateTimeFormatter.ofPattern(\"yyyy-MM-dd'T'HH:mm:ss\"));\n  var randomDigits = function(length){\n    var digits = '';\n    for (var i = 0; i < length; i++){\n      digits += Math.floor(Math.random() * 10);\n    }\n    return digits;\n  };\n  var coopCode = overrides.instgAgtFinInstId || token.coop_codecb || '0205';\n  var debtorType = overrides.debtorAccountType || 'CTA_AHORROS';\n  var creditorType = overrides.creditorAccountType || 'CTA_CORRIENTE';\n  var creditorEntity = overrides.creditorEntity || overrides.instdAgtFinInstId || coopCode;\n  var debtorAccounts = catalog[coopCode] || catalog['0205'];\n  var creditorAccounts = catalog[creditorEntity] || catalog['0303'];\n  var debtorIban = overrides.debtorIban || (debtorAccounts ? (debtorAccounts[debtorType] || debtorAccounts['CTA_AHORROS']) : 'EC5002051000000000020501052673');\n  var creditorIban = overrides.creditorIban || (creditorAccounts ? (creditorAccounts[creditorType] || creditorAccounts['CTA_CORRIENTE']) : 'EC0403031000000000030101002222');\n  if (overrides.sameIban){\n    creditorIban = debtorIban;\n  }\n  var msgId = overrides.msgId || (coopCode + token.currentDate + randomDigits(11));\n  var endToEndId = overrides.endToEndId || (coopCode + token.currentDate + randomDigits(5));\n  var amountValue = overrides.amount != null ? overrides.amount : 1.00;\n  var payload = {\n    GrpHdr: {\n      msgId: msgId,\n      creDtTm: timestamp,\n      nbOfTxs: overrides.nbOfTxs || 1,\n      sttlmInf: { sttlmMtd: overrides.settlementMethod || 'INGA' },\n      instgAgt: { finInstnId: coopCode },\n      InstdAgt: { FinInstnId: overrides.instdAgtFinInstId || creditorEntity },\n      Mge: { Type: overrides.messageType || 'acmt.998.321.01' },\n      ChnlId: overrides.channel || 'APP'\n    },\n    CdtTrfTxInf: {\n      PmtId: { EndToEndId: endToEndId },\n      IntrBkSttlmAmt: { Amt: amountValue, Ccy: overrides.currency || 'USD' },\n      DbtrAcctId: { IBAN: debtorIban },\n      CdtrAcctId: { IBAN: creditorIban },\n      Prtry: {\n        CustRef: overrides.customerReference || 'QA22',\n        ChanRef: overrides.channelReference || (overrides.channel === 'QR' ? 'QRPANAPAY' : 'TERM001'),\n        AgtRef: overrides.agentReference || 'AGT0002'\n      }\n    }\n  };\n  if (overrides.prtryOverrides){\n    Object.keys(overrides.prtryOverrides).forEach(function(key){\n      payload.CdtTrfTxInf.Prtry[key] = overrides.prtryOverrides[key];\n    });\n  }\n  if (overrides.overrideHeaders){\n    payload.GrpHdr.instgAgt = overrides.overrideHeaders.instgAgt || payload.GrpHdr.instgAgt;\n    payload.GrpHdr.InstdAgt = overrides.overrideHeaders.instdAgt || payload.GrpHdr.InstdAgt;\n  }\n  return payload;\n}","index":9,"text":"def buildPayload ="}},{"result":{"nanos":315900,"millis":0.3159,"status":"passed"},"step":{"endLine":150,"background":true,"line":111,"prefix":"*","docString":"function(body, expectation){\n  expectation = expectation || {};\n  var txInfo = (body && body.CdtTrfTxInf) ? body.CdtTrfTxInf : {};\n  var outcome = expectation.outcome || 'success';\n  var requireTxOk = expectation.requireTxOk === true;\n  var requireTxReject = expectation.requireTxReject === true;\n  var expectedTxStatus = expectation.expectedTxStatus;\n  if (expectedTxStatus != null){\n    karate.match(txInfo.TxSts, expectedTxStatus);\n  } else if (outcome === 'success' && requireTxOk){\n    karate.match(txInfo.TxSts, 'Ok');\n  } else if (outcome === 'reject' && requireTxReject){\n    karate.match(txInfo.TxSts, '#? _ && _ != \"Ok\"');\n  } else {\n    if (txInfo && txInfo.TxSts){\n      karate.log('TxSts recibido:', txInfo.TxSts, '- no se valida estrictamente.');\n    } else {\n      karate.log('Sin TxSts en la respuesta, continuando sin validacion.');\n    }\n  }\n  if (outcome === 'pending'){\n    karate.match(txInfo.TxSts, '#? _ == \"PENDING\" || _ == \"PROC\"');\n  }\n  if (expectation.reasonCode){\n    var reasonNode = txInfo.Rsn || {};\n    karate.match(reasonNode.RsnCd, expectation.reasonCode);\n  }\n  if (expectation.expectedEndToEndId){\n    karate.match(txInfo.PmtId.EndToEndId, expectation.expectedEndToEndId);\n  }\n  if (expectation.expectedMsgId){\n    var grpHdr = (body && body.GrpHdr) ? body.GrpHdr : {};\n    karate.match(grpHdr.msgId, expectation.expectedMsgId);\n  }\n}","index":10,"text":"def verifyTransferOutcome ="}},{"result":{"nanos":257300,"millis":0.2573,"status":"passed"},"step":{"endLine":156,"background":true,"line":151,"prefix":"*","docString":"function(name, payload, responseBody, status){\n  karate.log('[Transfer]', name, '| status:', status, '| msgId:', payload.GrpHdr.msgId, '| endToEnd:', payload.CdtTrfTxInf.PmtId.EndToEndId);\n}","index":11,"text":"def logTransferSummary ="}},{"result":{"nanos":9418700,"millis":9.4187,"status":"passed"},"step":{"line":289,"prefix":"*","index":0,"text":"def payload = buildPayload({ amount: 2.99 })"}},{"result":{"nanos":942600,"millis":0.9426,"status":"passed"},"step":{"line":290,"prefix":"*","index":1,"text":"def expectation = { httpStatus: [422, 409, 400], outcome: 'reject' }"}},{"result":{"nanos":2075700,"millis":2.0757,"status":"passed"},"step":{"line":291,"prefix":"*","index":2,"text":"def normalizedStatus = normalizeStatus(expectation.httpStatus)"}},{"result":{"nanos":423500,"millis":0.4235,"status":"passed"},"step":{"line":292,"prefix":"Given","index":3,"text":"path 'finan', 'transferencia'"}},{"result":{"nanos":166900,"millis":0.1669,"status":"passed"},"step":{"line":293,"prefix":"And","index":4,"text":"request payload"}},{"result":{"nanos":3398284000,"millis":3398.284,"status":"passed"},"step":{"line":294,"prefix":"When","index":5,"text":"method post"},"stepLog":"14:14:47.443 request:\n1 > POST https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral\/finan\/transferencia\n1 > Content-Type: application\/json; charset=UTF-8\n1 > Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2dUJWTkN6VlViUFBlTFdReEM0WDAyYVM3UnM2UGRYV1dja1dfc0xZMHlFIn0.eyJleHAiOjE3NjExNjA3NTAsImlhdCI6MTc2MTE2MDQ1MCwianRpIjoidHJydGNjOjQ5Yjg0NDVjLTgzYTAtMjI4Ni02NDczLWE2ZGEzOTBhOWQ0YSIsImlzcyI6Imh0dHBzOi8vYXV0ZW50aWNhY2lvbnFhLmNvb25lY3RhLmNvbS5lYy9hdXRoL3JlYWxtcy9QQU5BUEFZIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6Ijk5OGMyZmUwLTJjOGYtNGQwNC1iZjExLWY1OWExZTM5ODg3MyIsInR5cCI6IkJlYXJlciIsImF6cCI6IjAyMDVjYiIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiLyoiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRlZmF1bHQtcm9sZXMtYWRtaW5wYW5hcGF5Iiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7IjAyMDVjYiI6eyJyb2xlcyI6WyJ1bWFfcHJvdGVjdGlvbiJdfSwiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJjbGllbnRIb3N0IjoiMTAuMTAuMTAuMTUxIiwicHJlZmVycmVkX3VzZXJuYW1lIjoic2VydmljZS1hY2NvdW50LTAyMDVjYiIsImNsaWVudEFkZHJlc3MiOiIxMC4xMC4xMC4xNTEiLCJjbGllbnRfaWQiOiIwMjA1Y2IifQ.bATUogohrEqy7Voa4mFnsBzOnGy6tnjZGh_lOYRn-0hWXMY_fz-280nTu2Vv68eO3HeoewtWlt45S_iLI2-ml3pqpAlt3DXWVmLvVHw6d7TICHBfQsa0jGXMexKnyar7EinrVhF3deSK25Ap_ajC_82EvVvXrVG-7p9F1dEdq39y2R72JympejF5uhY_z_jNmqJSsnLEZVOo3WMJn76u9tTcYVIldC5uWGFWbPGEhvWPx4ZGpsuq_wrPOGdRmyJDFJPJl7LnLGHK0DBhuVtJUq_NFQkMus2fTTf_mWhRnoqNU-wUCS-fxMs6QusGzIVd-C3O29J3rerHTrGg21LAsQ\n1 > Content-Length: 512\n1 > Host: apipanapayqa.coonecta.com.ec\n1 > Connection: Keep-Alive\n1 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/17.0.12)\n1 > Accept-Encoding: gzip,deflate\n{\"GrpHdr\":{\"msgId\":\"02052025102232799996672\",\"creDtTm\":\"2025-10-22T14:14:47\",\"nbOfTxs\":1,\"sttlmInf\":{\"sttlmMtd\":\"INGA\"},\"instgAgt\":{\"finInstnId\":\"0205\"},\"InstdAgt\":{\"FinInstnId\":\"0205\"},\"Mge\":{\"Type\":\"acmt.998.321.01\"},\"ChnlId\":\"APP\"},\"CdtTrfTxInf\":{\"PmtId\":{\"EndToEndId\":\"02052025102212553\"},\"IntrBkSttlmAmt\":{\"Amt\":2.99,\"Ccy\":\"USD\"},\"DbtrAcctId\":{\"IBAN\":\"EC5002051000000000020501052673\"},\"CdtrAcctId\":{\"IBAN\":\"EC0402051000000000020101002318\"},\"Prtry\":{\"CustRef\":\"QA22\",\"ChanRef\":\"TERM001\",\"AgtRef\":\"AGT0002\"}}}\n\n14:14:50.837 response time in milliseconds: 3303\n1 < 200\n1 < Date: Wed, 22 Oct 2025 19:14:41 GMT\n1 < Content-Type: application\/json; charset=utf-8\n1 < Transfer-Encoding: chunked\n1 < Connection: keep-alive\n1 < Server: Kestrel\n1 < Set-Cookie: ARRAffinity=135f536e0d078a815c3b83fda3468ab8a3a2abc604a35eefb28648d3961cfa9b;Path=\/;HttpOnly;Secure;Domain=app-apipanapay-qa.azurewebsites.net\n1 < Set-Cookie: ARRAffinitySameSite=135f536e0d078a815c3b83fda3468ab8a3a2abc604a35eefb28648d3961cfa9b;Path=\/;HttpOnly;SameSite=None;Secure;Domain=app-apipanapay-qa.azurewebsites.net\n1 < Vary: Accept-Encoding\n1 < Request-Context: appId=cid-v1:a7a77847-2713-450f-9030-b350a2d54a28\n1 < X-Powered-By: ASP.NET\n1 < X-ARR-ClientCert: -----BEGIN%20CERTIFICATE-----%0AMIIEHDCCAgSgAwIBAgIUZIZBO0fb7VZ4KXrs01S4RYbWyJ8wDQYJKoZIhvcNAQEL%0ABQAwJTEjMCEGA1UEAwwacm9vdGNlcnQuY2JpYmxpYW4uaW50ZXJuYWwwHhcNMjUw%0AODEzMTMyNTU5WhcNMjgwODEyMTMyNTU5WjAnMSUwIwYDVQQDDBxjbGllbnRjZXJ0%0ALmNiaWJsaWFuLmludGVybmFsMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKC%0AAQEAskUDap6NmyYq8RT6F7z3DpZGQiflNQTvUT84TmxsKXEBRAkgINnkJqgKkd7f%0ASEybzqglQTbr4s41lCiPsy3X66qYjU2L%2Bojhni%2BOCVOX7n3JBYovL%2FqfMP3%2FkhZP%0AQIlK%2FQWPcrnl39fYkGOQv%2BYqoCGEPzGkib2m1Ma5Q1HOCKh1ErMjqTLGy%2ByJj6JY%0AiZvMx3YrJSvjUS0uKpNwxPtGyiexRfKsmR%2FHqPzRHa0iY%2B752KSgUedwJPv1Wod%2B%0AY9BMAMIdU25UtkUEsaOYtorGWDaZSn2Bl0LYmP87kjcYypnHx0jtPtUCXfVHrE6u%0AZnDRFYsZbeXylY3mJkyOL2DzZwIDAQABo0IwQDAdBgNVHQ4EFgQURPhJwTAcUWUp%0ArOqQO68P%2FbJoqjMwHwYDVR0jBBgwFoAU7GdlxoSeEXucEXhjadHRC9xzS0UwDQYJ%0AKoZIhvcNAQELBQADggIBAGTnlyF2n%2F6s9phYbO8V17niO0BXB62ToX6gPhcw9f3y%0AhMui6RnrM1oiHlBWqZquCqYJ5ETvYJE1RqvoqtGysxCnIj0OTJHV4WtF3SHsd1Tu%0ATg%2B%2FUnGivtBTDQxj9sbAtCaSYRBqPByP8jvSTDgXR1mgOrEGjr2PZdZSoKLj4OHi%0A9UCMJw7pJsyA4lbroKshQTYv5Ks5SqtJpdp0%2BUX0UUlbPJqXiadfbKdoXvEgcwbP%0ACqR9v7kGYmNxfaGLNGVrV%2BnLawIDmdYXJE%2F4WJh6sHfiZxEsE%2BB4PoKADrb1Eapt%0AnSdHUgRfc0i5f2lcmErnU8nCMO5TWdHFOgpYwTS8w17FhNFZpaSmyZKM7uHcUs7y%0AUbuiQtdXocfSSMf%2FeycBEU%2FHAVIWQEqY%2BbJdC0q%2FR%2BsESeBtXd4IEIxR0QfgscGk%0AJyCSFC8z%2FvCgrRsH5rePqKO7%2FLAsDTP4GIQNFNfF4Wh6bsPXuJmvvoMcnmy%2F58Wo%0AE0XaG8UPHVAeyEmhncdM32E7SJbR91aRr2CkV23OoUz%2BwKG2%2FuObHmAkuMkCbbcz%0AJQoC7DZg5FGw%2BZR7v1DIBct5QNJQ8bG%2FXGRxjWC6dU7jrGhOF1X%2B2YYcdx9XnwyM%0A9YPxUy5bVfMhIiKP2wEso5fjOZ4RTvnB5R6zD3maJK%2FtZAXVhtyqXSkBYFi4MvEs%0A-----END%20CERTIFICATE-----%0A\n{\"GrpHdr\":{\"MsgId\":\"000020251022020364\",\"CreDtTm\":\"2025-10-22T14:14:40\",\"NbOfTxs\":1,\"SttlmInf\":{\"SttlmMtd\":\"INGA\"},\"InstgAgt\":{\"FinInstnId\":\"0205\"},\"InstdAgt\":{\"FinInstnId\":\"0205\"},\"Mge\":{\"Type\":\"acmt.998.322.001\"},\"ChnlId\":\"APP\"},\"CdtTrfTxInf\":{\"OrgnGrpInf\":{\"OrgnlMsgId\":\"02052025102232799996672\",\"OrgnlMgeType\":\"acmt.998.321.01\",\"OrgnlCreDtTm\":\"2025-10-22T14:14:47\"},\"PmtId\":{\"EndToEndId\":\"02052025102212553\",\"TxId\":\"18538\"},\"TxSts\":\"Ok\",\"Rsn\":{\"RsnCd\":\"0000\",\"AddtlInf\":\"Transacción Exitosa\"},\"Dbtr\":{\"AuthCode\":\"020520251022141441901586\"},\"Cdtr\":{\"AuthCode\":\"020520251022141442354279\"},\"SttlmDt\":\"2025-10-22\"}}\n\n"},{"result":{"nanos":0,"errorMessage":"no step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:295","millis":0.0,"status":"failed"},"step":{"line":295,"prefix":"Then","index":6,"text":"match responseStatus in normalizedStatus"},"stepLog":"14:14:50.839 classpath:Transferencia.feature:295\nThen match responseStatus in normalizedStatus\nno step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:295\n"},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":296,"prefix":"*","index":7,"text":"eval verifyTransferOutcome(response, expectation)"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":297,"prefix":"*","index":8,"text":"eval logTransferSummary('Monto decimal inferior al minimo', payload, response, responseStatus)"}}],"line":288,"description":"","durationMillis":3420.6743,"failed":true,"error":"no step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:295","tags":["transferencia"],"executorName":"main","name":"Transferencia no exitosa, monto minimo con valor decimal de 2.99","startTime":1761160487401,"refId":"[11:288]","endTime":1761160490839,"exampleIndex":-1},{"sectionIndex":11,"stepResults":[{"result":{"nanos":4444400,"millis":4.4444,"status":"passed"},"step":{"background":true,"line":5,"prefix":"*","index":0,"text":"def tokenContext = callonce read('classpath:helpers\/generate-token.feature')"},"stepLog":"14:14:50.861 key store key count for classpath:certificado\/clientcert.cbiblian.internal 1.pfx: 1\n"},{"result":{"nanos":353100,"millis":0.3531,"status":"passed"},"step":{"background":true,"line":6,"prefix":"*","index":1,"text":"def tokenData = tokenContext.tokenInfo"}},{"result":{"nanos":502800,"millis":0.5028,"status":"passed"},"step":{"background":true,"line":7,"prefix":"*","index":2,"text":"def transferenciaBaseUrl = karate.properties['transfer.baseUrl'] || 'https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral'"}},{"result":{"nanos":82900,"millis":0.0829,"status":"passed"},"step":{"background":true,"line":8,"prefix":"*","index":3,"text":"url transferenciaBaseUrl"}},{"result":{"nanos":432100,"millis":0.4321,"status":"passed"},"step":{"background":true,"line":9,"prefix":"*","index":4,"text":"def authHeaders = { 'Content-Type': 'application\/json' }"}},{"result":{"nanos":872200,"millis":0.8722,"status":"passed"},"step":{"background":true,"line":10,"prefix":"*","index":5,"text":"set authHeaders.Authorization = 'Bearer ' + tokenData.auth_tokencb"}},{"result":{"nanos":67200,"millis":0.0672,"status":"passed"},"step":{"background":true,"line":11,"prefix":"*","index":6,"text":"configure headers = authHeaders"}},{"result":{"nanos":219500,"millis":0.2195,"status":"passed"},"step":{"endLine":24,"background":true,"line":12,"prefix":"*","docString":"{\n  \"0205\": {\n    \"CTA_AHORROS\": \"EC5002051000000000020501052673\",\n    \"CTA_CORRIENTE\": \"EC0402051000000000020101002318\"\n  },\n  \"0303\": {\n    \"CTA_AHORROS\": \"EC5003031000000000030301051111\",\n    \"CTA_CORRIENTE\": \"EC0403031000000000030101002222\"\n  }\n}","index":7,"text":"def accountCatalog ="}},{"result":{"nanos":232900,"millis":0.2329,"status":"passed"},"step":{"endLine":39,"background":true,"line":25,"prefix":"*","docString":"function(value){\n  var list;\n  if (!value && value !== 0){\n    list = [200];\n  } else {\n    list = Array.isArray(value) ? value.slice(0) : [value];\n  }\n  if (list.indexOf(200) === -1){\n    list.push(200);\n  }\n  return list;\n}","index":8,"text":"def normalizeStatus ="}},{"result":{"nanos":665300,"millis":0.6653,"status":"passed"},"step":{"endLine":110,"background":true,"line":40,"prefix":"*","docString":"function(overrides){\n  overrides = overrides || {};\n  var token = karate.get('tokenData');\n  var catalog = karate.get('accountCatalog');\n  var LocalDateTime = Java.type('java.time.LocalDateTime');\n  var DateTimeFormatter = Java.type('java.time.format.DateTimeFormatter');\n  var timestamp = LocalDateTime.now().format(DateTimeFormatter.ofPattern(\"yyyy-MM-dd'T'HH:mm:ss\"));\n  var randomDigits = function(length){\n    var digits = '';\n    for (var i = 0; i < length; i++){\n      digits += Math.floor(Math.random() * 10);\n    }\n    return digits;\n  };\n  var coopCode = overrides.instgAgtFinInstId || token.coop_codecb || '0205';\n  var debtorType = overrides.debtorAccountType || 'CTA_AHORROS';\n  var creditorType = overrides.creditorAccountType || 'CTA_CORRIENTE';\n  var creditorEntity = overrides.creditorEntity || overrides.instdAgtFinInstId || coopCode;\n  var debtorAccounts = catalog[coopCode] || catalog['0205'];\n  var creditorAccounts = catalog[creditorEntity] || catalog['0303'];\n  var debtorIban = overrides.debtorIban || (debtorAccounts ? (debtorAccounts[debtorType] || debtorAccounts['CTA_AHORROS']) : 'EC5002051000000000020501052673');\n  var creditorIban = overrides.creditorIban || (creditorAccounts ? (creditorAccounts[creditorType] || creditorAccounts['CTA_CORRIENTE']) : 'EC0403031000000000030101002222');\n  if (overrides.sameIban){\n    creditorIban = debtorIban;\n  }\n  var msgId = overrides.msgId || (coopCode + token.currentDate + randomDigits(11));\n  var endToEndId = overrides.endToEndId || (coopCode + token.currentDate + randomDigits(5));\n  var amountValue = overrides.amount != null ? overrides.amount : 1.00;\n  var payload = {\n    GrpHdr: {\n      msgId: msgId,\n      creDtTm: timestamp,\n      nbOfTxs: overrides.nbOfTxs || 1,\n      sttlmInf: { sttlmMtd: overrides.settlementMethod || 'INGA' },\n      instgAgt: { finInstnId: coopCode },\n      InstdAgt: { FinInstnId: overrides.instdAgtFinInstId || creditorEntity },\n      Mge: { Type: overrides.messageType || 'acmt.998.321.01' },\n      ChnlId: overrides.channel || 'APP'\n    },\n    CdtTrfTxInf: {\n      PmtId: { EndToEndId: endToEndId },\n      IntrBkSttlmAmt: { Amt: amountValue, Ccy: overrides.currency || 'USD' },\n      DbtrAcctId: { IBAN: debtorIban },\n      CdtrAcctId: { IBAN: creditorIban },\n      Prtry: {\n        CustRef: overrides.customerReference || 'QA22',\n        ChanRef: overrides.channelReference || (overrides.channel === 'QR' ? 'QRPANAPAY' : 'TERM001'),\n        AgtRef: overrides.agentReference || 'AGT0002'\n      }\n    }\n  };\n  if (overrides.prtryOverrides){\n    Object.keys(overrides.prtryOverrides).forEach(function(key){\n      payload.CdtTrfTxInf.Prtry[key] = overrides.prtryOverrides[key];\n    });\n  }\n  if (overrides.overrideHeaders){\n    payload.GrpHdr.instgAgt = overrides.overrideHeaders.instgAgt || payload.GrpHdr.instgAgt;\n    payload.GrpHdr.InstdAgt = overrides.overrideHeaders.instdAgt || payload.GrpHdr.InstdAgt;\n  }\n  return payload;\n}","index":9,"text":"def buildPayload ="}},{"result":{"nanos":342100,"millis":0.3421,"status":"passed"},"step":{"endLine":150,"background":true,"line":111,"prefix":"*","docString":"function(body, expectation){\n  expectation = expectation || {};\n  var txInfo = (body && body.CdtTrfTxInf) ? body.CdtTrfTxInf : {};\n  var outcome = expectation.outcome || 'success';\n  var requireTxOk = expectation.requireTxOk === true;\n  var requireTxReject = expectation.requireTxReject === true;\n  var expectedTxStatus = expectation.expectedTxStatus;\n  if (expectedTxStatus != null){\n    karate.match(txInfo.TxSts, expectedTxStatus);\n  } else if (outcome === 'success' && requireTxOk){\n    karate.match(txInfo.TxSts, 'Ok');\n  } else if (outcome === 'reject' && requireTxReject){\n    karate.match(txInfo.TxSts, '#? _ && _ != \"Ok\"');\n  } else {\n    if (txInfo && txInfo.TxSts){\n      karate.log('TxSts recibido:', txInfo.TxSts, '- no se valida estrictamente.');\n    } else {\n      karate.log('Sin TxSts en la respuesta, continuando sin validacion.');\n    }\n  }\n  if (outcome === 'pending'){\n    karate.match(txInfo.TxSts, '#? _ == \"PENDING\" || _ == \"PROC\"');\n  }\n  if (expectation.reasonCode){\n    var reasonNode = txInfo.Rsn || {};\n    karate.match(reasonNode.RsnCd, expectation.reasonCode);\n  }\n  if (expectation.expectedEndToEndId){\n    karate.match(txInfo.PmtId.EndToEndId, expectation.expectedEndToEndId);\n  }\n  if (expectation.expectedMsgId){\n    var grpHdr = (body && body.GrpHdr) ? body.GrpHdr : {};\n    karate.match(grpHdr.msgId, expectation.expectedMsgId);\n  }\n}","index":10,"text":"def verifyTransferOutcome ="}},{"result":{"nanos":161800,"millis":0.1618,"status":"passed"},"step":{"endLine":156,"background":true,"line":151,"prefix":"*","docString":"function(name, payload, responseBody, status){\n  karate.log('[Transfer]', name, '| status:', status, '| msgId:', payload.GrpHdr.msgId, '| endToEnd:', payload.CdtTrfTxInf.PmtId.EndToEndId);\n}","index":11,"text":"def logTransferSummary ="}},{"result":{"nanos":7819000,"millis":7.819,"status":"passed"},"step":{"line":300,"prefix":"*","index":0,"text":"def payload = buildPayload({ amount: 1.00 })"}},{"result":{"nanos":495700,"millis":0.4957,"status":"passed"},"step":{"line":301,"prefix":"*","index":1,"text":"def expectation = { httpStatus: [422, 409, 400], outcome: 'reject' }"}},{"result":{"nanos":1101900,"millis":1.1019,"status":"passed"},"step":{"line":302,"prefix":"*","index":2,"text":"def normalizedStatus = normalizeStatus(expectation.httpStatus)"}},{"result":{"nanos":220900,"millis":0.2209,"status":"passed"},"step":{"line":303,"prefix":"Given","index":3,"text":"path 'finan', 'transferencia'"}},{"result":{"nanos":65800,"millis":0.0658,"status":"passed"},"step":{"line":304,"prefix":"And","index":4,"text":"request payload"}},{"result":{"nanos":3637664300,"millis":3637.6643,"status":"passed"},"step":{"line":305,"prefix":"When","index":5,"text":"method post"},"stepLog":"14:14:50.889 request:\n1 > POST https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral\/finan\/transferencia\n1 > Content-Type: application\/json; charset=UTF-8\n1 > Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2dUJWTkN6VlViUFBlTFdReEM0WDAyYVM3UnM2UGRYV1dja1dfc0xZMHlFIn0.eyJleHAiOjE3NjExNjA3NTAsImlhdCI6MTc2MTE2MDQ1MCwianRpIjoidHJydGNjOjQ5Yjg0NDVjLTgzYTAtMjI4Ni02NDczLWE2ZGEzOTBhOWQ0YSIsImlzcyI6Imh0dHBzOi8vYXV0ZW50aWNhY2lvbnFhLmNvb25lY3RhLmNvbS5lYy9hdXRoL3JlYWxtcy9QQU5BUEFZIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6Ijk5OGMyZmUwLTJjOGYtNGQwNC1iZjExLWY1OWExZTM5ODg3MyIsInR5cCI6IkJlYXJlciIsImF6cCI6IjAyMDVjYiIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiLyoiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRlZmF1bHQtcm9sZXMtYWRtaW5wYW5hcGF5Iiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7IjAyMDVjYiI6eyJyb2xlcyI6WyJ1bWFfcHJvdGVjdGlvbiJdfSwiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJjbGllbnRIb3N0IjoiMTAuMTAuMTAuMTUxIiwicHJlZmVycmVkX3VzZXJuYW1lIjoic2VydmljZS1hY2NvdW50LTAyMDVjYiIsImNsaWVudEFkZHJlc3MiOiIxMC4xMC4xMC4xNTEiLCJjbGllbnRfaWQiOiIwMjA1Y2IifQ.bATUogohrEqy7Voa4mFnsBzOnGy6tnjZGh_lOYRn-0hWXMY_fz-280nTu2Vv68eO3HeoewtWlt45S_iLI2-ml3pqpAlt3DXWVmLvVHw6d7TICHBfQsa0jGXMexKnyar7EinrVhF3deSK25Ap_ajC_82EvVvXrVG-7p9F1dEdq39y2R72JympejF5uhY_z_jNmqJSsnLEZVOo3WMJn76u9tTcYVIldC5uWGFWbPGEhvWPx4ZGpsuq_wrPOGdRmyJDFJPJl7LnLGHK0DBhuVtJUq_NFQkMus2fTTf_mWhRnoqNU-wUCS-fxMs6QusGzIVd-C3O29J3rerHTrGg21LAsQ\n1 > Content-Length: 511\n1 > Host: apipanapayqa.coonecta.com.ec\n1 > Connection: Keep-Alive\n1 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/17.0.12)\n1 > Accept-Encoding: gzip,deflate\n{\"GrpHdr\":{\"msgId\":\"02052025102285189261842\",\"creDtTm\":\"2025-10-22T14:14:50\",\"nbOfTxs\":1,\"sttlmInf\":{\"sttlmMtd\":\"INGA\"},\"instgAgt\":{\"finInstnId\":\"0205\"},\"InstdAgt\":{\"FinInstnId\":\"0205\"},\"Mge\":{\"Type\":\"acmt.998.321.01\"},\"ChnlId\":\"APP\"},\"CdtTrfTxInf\":{\"PmtId\":{\"EndToEndId\":\"02052025102202407\"},\"IntrBkSttlmAmt\":{\"Amt\":1.0,\"Ccy\":\"USD\"},\"DbtrAcctId\":{\"IBAN\":\"EC5002051000000000020501052673\"},\"CdtrAcctId\":{\"IBAN\":\"EC0402051000000000020101002318\"},\"Prtry\":{\"CustRef\":\"QA22\",\"ChanRef\":\"TERM001\",\"AgtRef\":\"AGT0002\"}}}\n\n14:14:54.523 response time in milliseconds: 3538\n1 < 200\n1 < Date: Wed, 22 Oct 2025 19:14:46 GMT\n1 < Content-Type: application\/json; charset=utf-8\n1 < Transfer-Encoding: chunked\n1 < Connection: keep-alive\n1 < Server: Kestrel\n1 < Set-Cookie: ARRAffinity=135f536e0d078a815c3b83fda3468ab8a3a2abc604a35eefb28648d3961cfa9b;Path=\/;HttpOnly;Secure;Domain=app-apipanapay-qa.azurewebsites.net\n1 < Set-Cookie: ARRAffinitySameSite=135f536e0d078a815c3b83fda3468ab8a3a2abc604a35eefb28648d3961cfa9b;Path=\/;HttpOnly;SameSite=None;Secure;Domain=app-apipanapay-qa.azurewebsites.net\n1 < Vary: Accept-Encoding\n1 < Request-Context: appId=cid-v1:a7a77847-2713-450f-9030-b350a2d54a28\n1 < X-Powered-By: ASP.NET\n1 < X-ARR-ClientCert: -----BEGIN%20CERTIFICATE-----%0AMIIEHDCCAgSgAwIBAgIUZIZBO0fb7VZ4KXrs01S4RYbWyJ8wDQYJKoZIhvcNAQEL%0ABQAwJTEjMCEGA1UEAwwacm9vdGNlcnQuY2JpYmxpYW4uaW50ZXJuYWwwHhcNMjUw%0AODEzMTMyNTU5WhcNMjgwODEyMTMyNTU5WjAnMSUwIwYDVQQDDBxjbGllbnRjZXJ0%0ALmNiaWJsaWFuLmludGVybmFsMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKC%0AAQEAskUDap6NmyYq8RT6F7z3DpZGQiflNQTvUT84TmxsKXEBRAkgINnkJqgKkd7f%0ASEybzqglQTbr4s41lCiPsy3X66qYjU2L%2Bojhni%2BOCVOX7n3JBYovL%2FqfMP3%2FkhZP%0AQIlK%2FQWPcrnl39fYkGOQv%2BYqoCGEPzGkib2m1Ma5Q1HOCKh1ErMjqTLGy%2ByJj6JY%0AiZvMx3YrJSvjUS0uKpNwxPtGyiexRfKsmR%2FHqPzRHa0iY%2B752KSgUedwJPv1Wod%2B%0AY9BMAMIdU25UtkUEsaOYtorGWDaZSn2Bl0LYmP87kjcYypnHx0jtPtUCXfVHrE6u%0AZnDRFYsZbeXylY3mJkyOL2DzZwIDAQABo0IwQDAdBgNVHQ4EFgQURPhJwTAcUWUp%0ArOqQO68P%2FbJoqjMwHwYDVR0jBBgwFoAU7GdlxoSeEXucEXhjadHRC9xzS0UwDQYJ%0AKoZIhvcNAQELBQADggIBAGTnlyF2n%2F6s9phYbO8V17niO0BXB62ToX6gPhcw9f3y%0AhMui6RnrM1oiHlBWqZquCqYJ5ETvYJE1RqvoqtGysxCnIj0OTJHV4WtF3SHsd1Tu%0ATg%2B%2FUnGivtBTDQxj9sbAtCaSYRBqPByP8jvSTDgXR1mgOrEGjr2PZdZSoKLj4OHi%0A9UCMJw7pJsyA4lbroKshQTYv5Ks5SqtJpdp0%2BUX0UUlbPJqXiadfbKdoXvEgcwbP%0ACqR9v7kGYmNxfaGLNGVrV%2BnLawIDmdYXJE%2F4WJh6sHfiZxEsE%2BB4PoKADrb1Eapt%0AnSdHUgRfc0i5f2lcmErnU8nCMO5TWdHFOgpYwTS8w17FhNFZpaSmyZKM7uHcUs7y%0AUbuiQtdXocfSSMf%2FeycBEU%2FHAVIWQEqY%2BbJdC0q%2FR%2BsESeBtXd4IEIxR0QfgscGk%0AJyCSFC8z%2FvCgrRsH5rePqKO7%2FLAsDTP4GIQNFNfF4Wh6bsPXuJmvvoMcnmy%2F58Wo%0AE0XaG8UPHVAeyEmhncdM32E7SJbR91aRr2CkV23OoUz%2BwKG2%2FuObHmAkuMkCbbcz%0AJQoC7DZg5FGw%2BZR7v1DIBct5QNJQ8bG%2FXGRxjWC6dU7jrGhOF1X%2B2YYcdx9XnwyM%0A9YPxUy5bVfMhIiKP2wEso5fjOZ4RTvnB5R6zD3maJK%2FtZAXVhtyqXSkBYFi4MvEs%0A-----END%20CERTIFICATE-----%0A\n{\"GrpHdr\":{\"MsgId\":\"000020251022020365\",\"CreDtTm\":\"2025-10-22T14:14:44\",\"NbOfTxs\":1,\"SttlmInf\":{\"SttlmMtd\":\"INGA\"},\"InstgAgt\":{\"FinInstnId\":\"0205\"},\"InstdAgt\":{\"FinInstnId\":\"0205\"},\"Mge\":{\"Type\":\"acmt.998.322.001\"},\"ChnlId\":\"APP\"},\"CdtTrfTxInf\":{\"OrgnGrpInf\":{\"OrgnlMsgId\":\"02052025102285189261842\",\"OrgnlMgeType\":\"acmt.998.321.01\",\"OrgnlCreDtTm\":\"2025-10-22T14:14:50\"},\"PmtId\":{\"EndToEndId\":\"02052025102202407\",\"TxId\":\"18539\"},\"TxSts\":\"Ok\",\"Rsn\":{\"RsnCd\":\"0000\",\"AddtlInf\":\"Transacción Exitosa\"},\"Dbtr\":{\"AuthCode\":\"020520251022141445452947\"},\"Cdtr\":{\"AuthCode\":\"020520251022141445890318\"},\"SttlmDt\":\"2025-10-22\"}}\n\n"},{"result":{"nanos":0,"errorMessage":"no step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:306","millis":0.0,"status":"failed"},"step":{"line":306,"prefix":"Then","index":6,"text":"match responseStatus in normalizedStatus"},"stepLog":"14:14:54.523 classpath:Transferencia.feature:306\nThen match responseStatus in normalizedStatus\nno step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:306\n"},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":307,"prefix":"*","index":7,"text":"eval verifyTransferOutcome(response, expectation)"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":308,"prefix":"*","index":8,"text":"eval logTransferSummary('Monto entero inferior al minimo', payload, response, responseStatus)"}}],"line":299,"description":"","durationMillis":3655.7439,"failed":true,"error":"no step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:306","tags":["transferencia"],"executorName":"main","name":"Transferencia no exitosa, monto minimo entero de 1.00","startTime":1761160490853,"refId":"[12:299]","endTime":1761160494523,"exampleIndex":-1},{"sectionIndex":12,"stepResults":[{"result":{"nanos":5962100,"millis":5.9621,"status":"passed"},"step":{"background":true,"line":5,"prefix":"*","index":0,"text":"def tokenContext = callonce read('classpath:helpers\/generate-token.feature')"},"stepLog":"14:14:54.545 key store key count for classpath:certificado\/clientcert.cbiblian.internal 1.pfx: 1\n"},{"result":{"nanos":2778000,"millis":2.778,"status":"passed"},"step":{"background":true,"line":6,"prefix":"*","index":1,"text":"def tokenData = tokenContext.tokenInfo"}},{"result":{"nanos":3528700,"millis":3.5287,"status":"passed"},"step":{"background":true,"line":7,"prefix":"*","index":2,"text":"def transferenciaBaseUrl = karate.properties['transfer.baseUrl'] || 'https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral'"}},{"result":{"nanos":120200,"millis":0.1202,"status":"passed"},"step":{"background":true,"line":8,"prefix":"*","index":3,"text":"url transferenciaBaseUrl"}},{"result":{"nanos":507100,"millis":0.5071,"status":"passed"},"step":{"background":true,"line":9,"prefix":"*","index":4,"text":"def authHeaders = { 'Content-Type': 'application\/json' }"}},{"result":{"nanos":1851100,"millis":1.8511,"status":"passed"},"step":{"background":true,"line":10,"prefix":"*","index":5,"text":"set authHeaders.Authorization = 'Bearer ' + tokenData.auth_tokencb"}},{"result":{"nanos":93000,"millis":0.093,"status":"passed"},"step":{"background":true,"line":11,"prefix":"*","index":6,"text":"configure headers = authHeaders"}},{"result":{"nanos":405400,"millis":0.4054,"status":"passed"},"step":{"endLine":24,"background":true,"line":12,"prefix":"*","docString":"{\n  \"0205\": {\n    \"CTA_AHORROS\": \"EC5002051000000000020501052673\",\n    \"CTA_CORRIENTE\": \"EC0402051000000000020101002318\"\n  },\n  \"0303\": {\n    \"CTA_AHORROS\": \"EC5003031000000000030301051111\",\n    \"CTA_CORRIENTE\": \"EC0403031000000000030101002222\"\n  }\n}","index":7,"text":"def accountCatalog ="}},{"result":{"nanos":2700700,"millis":2.7007,"status":"passed"},"step":{"endLine":39,"background":true,"line":25,"prefix":"*","docString":"function(value){\n  var list;\n  if (!value && value !== 0){\n    list = [200];\n  } else {\n    list = Array.isArray(value) ? value.slice(0) : [value];\n  }\n  if (list.indexOf(200) === -1){\n    list.push(200);\n  }\n  return list;\n}","index":8,"text":"def normalizeStatus ="}},{"result":{"nanos":571500,"millis":0.5715,"status":"passed"},"step":{"endLine":110,"background":true,"line":40,"prefix":"*","docString":"function(overrides){\n  overrides = overrides || {};\n  var token = karate.get('tokenData');\n  var catalog = karate.get('accountCatalog');\n  var LocalDateTime = Java.type('java.time.LocalDateTime');\n  var DateTimeFormatter = Java.type('java.time.format.DateTimeFormatter');\n  var timestamp = LocalDateTime.now().format(DateTimeFormatter.ofPattern(\"yyyy-MM-dd'T'HH:mm:ss\"));\n  var randomDigits = function(length){\n    var digits = '';\n    for (var i = 0; i < length; i++){\n      digits += Math.floor(Math.random() * 10);\n    }\n    return digits;\n  };\n  var coopCode = overrides.instgAgtFinInstId || token.coop_codecb || '0205';\n  var debtorType = overrides.debtorAccountType || 'CTA_AHORROS';\n  var creditorType = overrides.creditorAccountType || 'CTA_CORRIENTE';\n  var creditorEntity = overrides.creditorEntity || overrides.instdAgtFinInstId || coopCode;\n  var debtorAccounts = catalog[coopCode] || catalog['0205'];\n  var creditorAccounts = catalog[creditorEntity] || catalog['0303'];\n  var debtorIban = overrides.debtorIban || (debtorAccounts ? (debtorAccounts[debtorType] || debtorAccounts['CTA_AHORROS']) : 'EC5002051000000000020501052673');\n  var creditorIban = overrides.creditorIban || (creditorAccounts ? (creditorAccounts[creditorType] || creditorAccounts['CTA_CORRIENTE']) : 'EC0403031000000000030101002222');\n  if (overrides.sameIban){\n    creditorIban = debtorIban;\n  }\n  var msgId = overrides.msgId || (coopCode + token.currentDate + randomDigits(11));\n  var endToEndId = overrides.endToEndId || (coopCode + token.currentDate + randomDigits(5));\n  var amountValue = overrides.amount != null ? overrides.amount : 1.00;\n  var payload = {\n    GrpHdr: {\n      msgId: msgId,\n      creDtTm: timestamp,\n      nbOfTxs: overrides.nbOfTxs || 1,\n      sttlmInf: { sttlmMtd: overrides.settlementMethod || 'INGA' },\n      instgAgt: { finInstnId: coopCode },\n      InstdAgt: { FinInstnId: overrides.instdAgtFinInstId || creditorEntity },\n      Mge: { Type: overrides.messageType || 'acmt.998.321.01' },\n      ChnlId: overrides.channel || 'APP'\n    },\n    CdtTrfTxInf: {\n      PmtId: { EndToEndId: endToEndId },\n      IntrBkSttlmAmt: { Amt: amountValue, Ccy: overrides.currency || 'USD' },\n      DbtrAcctId: { IBAN: debtorIban },\n      CdtrAcctId: { IBAN: creditorIban },\n      Prtry: {\n        CustRef: overrides.customerReference || 'QA22',\n        ChanRef: overrides.channelReference || (overrides.channel === 'QR' ? 'QRPANAPAY' : 'TERM001'),\n        AgtRef: overrides.agentReference || 'AGT0002'\n      }\n    }\n  };\n  if (overrides.prtryOverrides){\n    Object.keys(overrides.prtryOverrides).forEach(function(key){\n      payload.CdtTrfTxInf.Prtry[key] = overrides.prtryOverrides[key];\n    });\n  }\n  if (overrides.overrideHeaders){\n    payload.GrpHdr.instgAgt = overrides.overrideHeaders.instgAgt || payload.GrpHdr.instgAgt;\n    payload.GrpHdr.InstdAgt = overrides.overrideHeaders.instdAgt || payload.GrpHdr.InstdAgt;\n  }\n  return payload;\n}","index":9,"text":"def buildPayload ="}},{"result":{"nanos":6281600,"millis":6.2816,"status":"passed"},"step":{"endLine":150,"background":true,"line":111,"prefix":"*","docString":"function(body, expectation){\n  expectation = expectation || {};\n  var txInfo = (body && body.CdtTrfTxInf) ? body.CdtTrfTxInf : {};\n  var outcome = expectation.outcome || 'success';\n  var requireTxOk = expectation.requireTxOk === true;\n  var requireTxReject = expectation.requireTxReject === true;\n  var expectedTxStatus = expectation.expectedTxStatus;\n  if (expectedTxStatus != null){\n    karate.match(txInfo.TxSts, expectedTxStatus);\n  } else if (outcome === 'success' && requireTxOk){\n    karate.match(txInfo.TxSts, 'Ok');\n  } else if (outcome === 'reject' && requireTxReject){\n    karate.match(txInfo.TxSts, '#? _ && _ != \"Ok\"');\n  } else {\n    if (txInfo && txInfo.TxSts){\n      karate.log('TxSts recibido:', txInfo.TxSts, '- no se valida estrictamente.');\n    } else {\n      karate.log('Sin TxSts en la respuesta, continuando sin validacion.');\n    }\n  }\n  if (outcome === 'pending'){\n    karate.match(txInfo.TxSts, '#? _ == \"PENDING\" || _ == \"PROC\"');\n  }\n  if (expectation.reasonCode){\n    var reasonNode = txInfo.Rsn || {};\n    karate.match(reasonNode.RsnCd, expectation.reasonCode);\n  }\n  if (expectation.expectedEndToEndId){\n    karate.match(txInfo.PmtId.EndToEndId, expectation.expectedEndToEndId);\n  }\n  if (expectation.expectedMsgId){\n    var grpHdr = (body && body.GrpHdr) ? body.GrpHdr : {};\n    karate.match(grpHdr.msgId, expectation.expectedMsgId);\n  }\n}","index":10,"text":"def verifyTransferOutcome ="}},{"result":{"nanos":2844100,"millis":2.8441,"status":"passed"},"step":{"endLine":156,"background":true,"line":151,"prefix":"*","docString":"function(name, payload, responseBody, status){\n  karate.log('[Transfer]', name, '| status:', status, '| msgId:', payload.GrpHdr.msgId, '| endToEnd:', payload.CdtTrfTxInf.PmtId.EndToEndId);\n}","index":11,"text":"def logTransferSummary ="}},{"result":{"nanos":5562400,"millis":5.5624,"status":"passed"},"step":{"line":311,"prefix":"*","index":0,"text":"def payload = buildPayload({ amount: 0.00 })"}},{"result":{"nanos":452200,"millis":0.4522,"status":"passed"},"step":{"line":312,"prefix":"*","index":1,"text":"def expectation = { httpStatus: [422, 409, 400], outcome: 'reject' }"}},{"result":{"nanos":2380300,"millis":2.3803,"status":"passed"},"step":{"line":313,"prefix":"*","index":2,"text":"def normalizedStatus = normalizeStatus(expectation.httpStatus)"}},{"result":{"nanos":619500,"millis":0.6195,"status":"passed"},"step":{"line":314,"prefix":"Given","index":3,"text":"path 'finan', 'transferencia'"}},{"result":{"nanos":110800,"millis":0.1108,"status":"passed"},"step":{"line":315,"prefix":"And","index":4,"text":"request payload"}},{"result":{"nanos":1662401100,"millis":1662.4011,"status":"passed"},"step":{"line":316,"prefix":"When","index":5,"text":"method post"},"stepLog":"14:14:54.592 request:\n1 > POST https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral\/finan\/transferencia\n1 > Content-Type: application\/json; charset=UTF-8\n1 > Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2dUJWTkN6VlViUFBlTFdReEM0WDAyYVM3UnM2UGRYV1dja1dfc0xZMHlFIn0.eyJleHAiOjE3NjExNjA3NTAsImlhdCI6MTc2MTE2MDQ1MCwianRpIjoidHJydGNjOjQ5Yjg0NDVjLTgzYTAtMjI4Ni02NDczLWE2ZGEzOTBhOWQ0YSIsImlzcyI6Imh0dHBzOi8vYXV0ZW50aWNhY2lvbnFhLmNvb25lY3RhLmNvbS5lYy9hdXRoL3JlYWxtcy9QQU5BUEFZIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6Ijk5OGMyZmUwLTJjOGYtNGQwNC1iZjExLWY1OWExZTM5ODg3MyIsInR5cCI6IkJlYXJlciIsImF6cCI6IjAyMDVjYiIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiLyoiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRlZmF1bHQtcm9sZXMtYWRtaW5wYW5hcGF5Iiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7IjAyMDVjYiI6eyJyb2xlcyI6WyJ1bWFfcHJvdGVjdGlvbiJdfSwiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJjbGllbnRIb3N0IjoiMTAuMTAuMTAuMTUxIiwicHJlZmVycmVkX3VzZXJuYW1lIjoic2VydmljZS1hY2NvdW50LTAyMDVjYiIsImNsaWVudEFkZHJlc3MiOiIxMC4xMC4xMC4xNTEiLCJjbGllbnRfaWQiOiIwMjA1Y2IifQ.bATUogohrEqy7Voa4mFnsBzOnGy6tnjZGh_lOYRn-0hWXMY_fz-280nTu2Vv68eO3HeoewtWlt45S_iLI2-ml3pqpAlt3DXWVmLvVHw6d7TICHBfQsa0jGXMexKnyar7EinrVhF3deSK25Ap_ajC_82EvVvXrVG-7p9F1dEdq39y2R72JympejF5uhY_z_jNmqJSsnLEZVOo3WMJn76u9tTcYVIldC5uWGFWbPGEhvWPx4ZGpsuq_wrPOGdRmyJDFJPJl7LnLGHK0DBhuVtJUq_NFQkMus2fTTf_mWhRnoqNU-wUCS-fxMs6QusGzIVd-C3O29J3rerHTrGg21LAsQ\n1 > Content-Length: 511\n1 > Host: apipanapayqa.coonecta.com.ec\n1 > Connection: Keep-Alive\n1 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/17.0.12)\n1 > Accept-Encoding: gzip,deflate\n{\"GrpHdr\":{\"msgId\":\"02052025102253059527838\",\"creDtTm\":\"2025-10-22T14:14:54\",\"nbOfTxs\":1,\"sttlmInf\":{\"sttlmMtd\":\"INGA\"},\"instgAgt\":{\"finInstnId\":\"0205\"},\"InstdAgt\":{\"FinInstnId\":\"0205\"},\"Mge\":{\"Type\":\"acmt.998.321.01\"},\"ChnlId\":\"APP\"},\"CdtTrfTxInf\":{\"PmtId\":{\"EndToEndId\":\"02052025102207607\"},\"IntrBkSttlmAmt\":{\"Amt\":0.0,\"Ccy\":\"USD\"},\"DbtrAcctId\":{\"IBAN\":\"EC5002051000000000020501052673\"},\"CdtrAcctId\":{\"IBAN\":\"EC0402051000000000020101002318\"},\"Prtry\":{\"CustRef\":\"QA22\",\"ChanRef\":\"TERM001\",\"AgtRef\":\"AGT0002\"}}}\n\n14:14:56.248 response time in milliseconds: 1656\n1 < 400\n1 < Date: Wed, 22 Oct 2025 19:14:47 GMT\n1 < Content-Type: application\/json; charset=utf-8\n1 < Transfer-Encoding: chunked\n1 < Connection: keep-alive\n1 < Server: Kestrel\n1 < Set-Cookie: ARRAffinity=135f536e0d078a815c3b83fda3468ab8a3a2abc604a35eefb28648d3961cfa9b;Path=\/;HttpOnly;Secure;Domain=app-apipanapay-qa.azurewebsites.net\n1 < Set-Cookie: ARRAffinitySameSite=135f536e0d078a815c3b83fda3468ab8a3a2abc604a35eefb28648d3961cfa9b;Path=\/;HttpOnly;SameSite=None;Secure;Domain=app-apipanapay-qa.azurewebsites.net\n1 < Request-Context: appId=cid-v1:a7a77847-2713-450f-9030-b350a2d54a28\n1 < X-Powered-By: ASP.NET\n1 < X-ARR-ClientCert: -----BEGIN%20CERTIFICATE-----%0AMIIEHDCCAgSgAwIBAgIUZIZBO0fb7VZ4KXrs01S4RYbWyJ8wDQYJKoZIhvcNAQEL%0ABQAwJTEjMCEGA1UEAwwacm9vdGNlcnQuY2JpYmxpYW4uaW50ZXJuYWwwHhcNMjUw%0AODEzMTMyNTU5WhcNMjgwODEyMTMyNTU5WjAnMSUwIwYDVQQDDBxjbGllbnRjZXJ0%0ALmNiaWJsaWFuLmludGVybmFsMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKC%0AAQEAskUDap6NmyYq8RT6F7z3DpZGQiflNQTvUT84TmxsKXEBRAkgINnkJqgKkd7f%0ASEybzqglQTbr4s41lCiPsy3X66qYjU2L%2Bojhni%2BOCVOX7n3JBYovL%2FqfMP3%2FkhZP%0AQIlK%2FQWPcrnl39fYkGOQv%2BYqoCGEPzGkib2m1Ma5Q1HOCKh1ErMjqTLGy%2ByJj6JY%0AiZvMx3YrJSvjUS0uKpNwxPtGyiexRfKsmR%2FHqPzRHa0iY%2B752KSgUedwJPv1Wod%2B%0AY9BMAMIdU25UtkUEsaOYtorGWDaZSn2Bl0LYmP87kjcYypnHx0jtPtUCXfVHrE6u%0AZnDRFYsZbeXylY3mJkyOL2DzZwIDAQABo0IwQDAdBgNVHQ4EFgQURPhJwTAcUWUp%0ArOqQO68P%2FbJoqjMwHwYDVR0jBBgwFoAU7GdlxoSeEXucEXhjadHRC9xzS0UwDQYJ%0AKoZIhvcNAQELBQADggIBAGTnlyF2n%2F6s9phYbO8V17niO0BXB62ToX6gPhcw9f3y%0AhMui6RnrM1oiHlBWqZquCqYJ5ETvYJE1RqvoqtGysxCnIj0OTJHV4WtF3SHsd1Tu%0ATg%2B%2FUnGivtBTDQxj9sbAtCaSYRBqPByP8jvSTDgXR1mgOrEGjr2PZdZSoKLj4OHi%0A9UCMJw7pJsyA4lbroKshQTYv5Ks5SqtJpdp0%2BUX0UUlbPJqXiadfbKdoXvEgcwbP%0ACqR9v7kGYmNxfaGLNGVrV%2BnLawIDmdYXJE%2F4WJh6sHfiZxEsE%2BB4PoKADrb1Eapt%0AnSdHUgRfc0i5f2lcmErnU8nCMO5TWdHFOgpYwTS8w17FhNFZpaSmyZKM7uHcUs7y%0AUbuiQtdXocfSSMf%2FeycBEU%2FHAVIWQEqY%2BbJdC0q%2FR%2BsESeBtXd4IEIxR0QfgscGk%0AJyCSFC8z%2FvCgrRsH5rePqKO7%2FLAsDTP4GIQNFNfF4Wh6bsPXuJmvvoMcnmy%2F58Wo%0AE0XaG8UPHVAeyEmhncdM32E7SJbR91aRr2CkV23OoUz%2BwKG2%2FuObHmAkuMkCbbcz%0AJQoC7DZg5FGw%2BZR7v1DIBct5QNJQ8bG%2FXGRxjWC6dU7jrGhOF1X%2B2YYcdx9XnwyM%0A9YPxUy5bVfMhIiKP2wEso5fjOZ4RTvnB5R6zD3maJK%2FtZAXVhtyqXSkBYFi4MvEs%0A-----END%20CERTIFICATE-----%0A\n{\"GrpHdr\":{\"MsgId\":\"000020251022020366\",\"CreDtTm\":\"2025-10-22T14:14:47\",\"NbOfTxs\":1,\"SttlmInf\":{\"SttlmMtd\":\"INGA\"},\"InstgAgt\":{\"FinInstnId\":\"0205\"},\"InstdAgt\":{\"FinInstnId\":\"0205\"},\"Mge\":{\"Type\":\"acmt.998.322.001\"},\"ChnlId\":\"APP\"},\"CdtTrfTxInf\":{\"OrgnGrpInf\":{\"OrgnlMsgId\":\"02052025102253059527838\",\"OrgnlMgeType\":\"acmt.998.321.01\",\"OrgnlCreDtTm\":\"2025-10-22T14:14:54\"},\"TxSts\":\"ERR\",\"Rsn\":{\"RsnCd\":\"AM06\",\"AddtlInf\":\"El monto no cumple con el mínimo requerido.\"},\"SttlmDt\":\"2025-10-22\"}}\n\n"},{"result":{"nanos":0,"errorMessage":"no step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:317","millis":0.0,"status":"failed"},"step":{"line":317,"prefix":"Then","index":6,"text":"match responseStatus in normalizedStatus"},"stepLog":"14:14:56.248 classpath:Transferencia.feature:317\nThen match responseStatus in normalizedStatus\nno step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:317\n"},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":318,"prefix":"*","index":7,"text":"eval verifyTransferOutcome(response, expectation)"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":319,"prefix":"*","index":8,"text":"eval logTransferSummary('Monto cero', payload, response, responseStatus)"}}],"line":310,"description":"","durationMillis":1699.1698,"failed":true,"error":"no step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:317","tags":["transferencia"],"executorName":"main","name":"Transferencia no exitosa, monto 0.00","startTime":1761160494535,"refId":"[13:310]","endTime":1761160496248,"exampleIndex":-1},{"sectionIndex":13,"stepResults":[{"result":{"nanos":7289500,"millis":7.2895,"status":"passed"},"step":{"background":true,"line":5,"prefix":"*","index":0,"text":"def tokenContext = callonce read('classpath:helpers\/generate-token.feature')"},"stepLog":"14:14:56.274 key store key count for classpath:certificado\/clientcert.cbiblian.internal 1.pfx: 1\n"},{"result":{"nanos":706100,"millis":0.7061,"status":"passed"},"step":{"background":true,"line":6,"prefix":"*","index":1,"text":"def tokenData = tokenContext.tokenInfo"}},{"result":{"nanos":1066500,"millis":1.0665,"status":"passed"},"step":{"background":true,"line":7,"prefix":"*","index":2,"text":"def transferenciaBaseUrl = karate.properties['transfer.baseUrl'] || 'https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral'"}},{"result":{"nanos":133500,"millis":0.1335,"status":"passed"},"step":{"background":true,"line":8,"prefix":"*","index":3,"text":"url transferenciaBaseUrl"}},{"result":{"nanos":694500,"millis":0.6945,"status":"passed"},"step":{"background":true,"line":9,"prefix":"*","index":4,"text":"def authHeaders = { 'Content-Type': 'application\/json' }"}},{"result":{"nanos":5759300,"millis":5.7593,"status":"passed"},"step":{"background":true,"line":10,"prefix":"*","index":5,"text":"set authHeaders.Authorization = 'Bearer ' + tokenData.auth_tokencb"}},{"result":{"nanos":251000,"millis":0.251,"status":"passed"},"step":{"background":true,"line":11,"prefix":"*","index":6,"text":"configure headers = authHeaders"}},{"result":{"nanos":590000,"millis":0.59,"status":"passed"},"step":{"endLine":24,"background":true,"line":12,"prefix":"*","docString":"{\n  \"0205\": {\n    \"CTA_AHORROS\": \"EC5002051000000000020501052673\",\n    \"CTA_CORRIENTE\": \"EC0402051000000000020101002318\"\n  },\n  \"0303\": {\n    \"CTA_AHORROS\": \"EC5003031000000000030301051111\",\n    \"CTA_CORRIENTE\": \"EC0403031000000000030101002222\"\n  }\n}","index":7,"text":"def accountCatalog ="}},{"result":{"nanos":550000,"millis":0.55,"status":"passed"},"step":{"endLine":39,"background":true,"line":25,"prefix":"*","docString":"function(value){\n  var list;\n  if (!value && value !== 0){\n    list = [200];\n  } else {\n    list = Array.isArray(value) ? value.slice(0) : [value];\n  }\n  if (list.indexOf(200) === -1){\n    list.push(200);\n  }\n  return list;\n}","index":8,"text":"def normalizeStatus ="}},{"result":{"nanos":405500,"millis":0.4055,"status":"passed"},"step":{"endLine":110,"background":true,"line":40,"prefix":"*","docString":"function(overrides){\n  overrides = overrides || {};\n  var token = karate.get('tokenData');\n  var catalog = karate.get('accountCatalog');\n  var LocalDateTime = Java.type('java.time.LocalDateTime');\n  var DateTimeFormatter = Java.type('java.time.format.DateTimeFormatter');\n  var timestamp = LocalDateTime.now().format(DateTimeFormatter.ofPattern(\"yyyy-MM-dd'T'HH:mm:ss\"));\n  var randomDigits = function(length){\n    var digits = '';\n    for (var i = 0; i < length; i++){\n      digits += Math.floor(Math.random() * 10);\n    }\n    return digits;\n  };\n  var coopCode = overrides.instgAgtFinInstId || token.coop_codecb || '0205';\n  var debtorType = overrides.debtorAccountType || 'CTA_AHORROS';\n  var creditorType = overrides.creditorAccountType || 'CTA_CORRIENTE';\n  var creditorEntity = overrides.creditorEntity || overrides.instdAgtFinInstId || coopCode;\n  var debtorAccounts = catalog[coopCode] || catalog['0205'];\n  var creditorAccounts = catalog[creditorEntity] || catalog['0303'];\n  var debtorIban = overrides.debtorIban || (debtorAccounts ? (debtorAccounts[debtorType] || debtorAccounts['CTA_AHORROS']) : 'EC5002051000000000020501052673');\n  var creditorIban = overrides.creditorIban || (creditorAccounts ? (creditorAccounts[creditorType] || creditorAccounts['CTA_CORRIENTE']) : 'EC0403031000000000030101002222');\n  if (overrides.sameIban){\n    creditorIban = debtorIban;\n  }\n  var msgId = overrides.msgId || (coopCode + token.currentDate + randomDigits(11));\n  var endToEndId = overrides.endToEndId || (coopCode + token.currentDate + randomDigits(5));\n  var amountValue = overrides.amount != null ? overrides.amount : 1.00;\n  var payload = {\n    GrpHdr: {\n      msgId: msgId,\n      creDtTm: timestamp,\n      nbOfTxs: overrides.nbOfTxs || 1,\n      sttlmInf: { sttlmMtd: overrides.settlementMethod || 'INGA' },\n      instgAgt: { finInstnId: coopCode },\n      InstdAgt: { FinInstnId: overrides.instdAgtFinInstId || creditorEntity },\n      Mge: { Type: overrides.messageType || 'acmt.998.321.01' },\n      ChnlId: overrides.channel || 'APP'\n    },\n    CdtTrfTxInf: {\n      PmtId: { EndToEndId: endToEndId },\n      IntrBkSttlmAmt: { Amt: amountValue, Ccy: overrides.currency || 'USD' },\n      DbtrAcctId: { IBAN: debtorIban },\n      CdtrAcctId: { IBAN: creditorIban },\n      Prtry: {\n        CustRef: overrides.customerReference || 'QA22',\n        ChanRef: overrides.channelReference || (overrides.channel === 'QR' ? 'QRPANAPAY' : 'TERM001'),\n        AgtRef: overrides.agentReference || 'AGT0002'\n      }\n    }\n  };\n  if (overrides.prtryOverrides){\n    Object.keys(overrides.prtryOverrides).forEach(function(key){\n      payload.CdtTrfTxInf.Prtry[key] = overrides.prtryOverrides[key];\n    });\n  }\n  if (overrides.overrideHeaders){\n    payload.GrpHdr.instgAgt = overrides.overrideHeaders.instgAgt || payload.GrpHdr.instgAgt;\n    payload.GrpHdr.InstdAgt = overrides.overrideHeaders.instdAgt || payload.GrpHdr.InstdAgt;\n  }\n  return payload;\n}","index":9,"text":"def buildPayload ="}},{"result":{"nanos":226400,"millis":0.2264,"status":"passed"},"step":{"endLine":150,"background":true,"line":111,"prefix":"*","docString":"function(body, expectation){\n  expectation = expectation || {};\n  var txInfo = (body && body.CdtTrfTxInf) ? body.CdtTrfTxInf : {};\n  var outcome = expectation.outcome || 'success';\n  var requireTxOk = expectation.requireTxOk === true;\n  var requireTxReject = expectation.requireTxReject === true;\n  var expectedTxStatus = expectation.expectedTxStatus;\n  if (expectedTxStatus != null){\n    karate.match(txInfo.TxSts, expectedTxStatus);\n  } else if (outcome === 'success' && requireTxOk){\n    karate.match(txInfo.TxSts, 'Ok');\n  } else if (outcome === 'reject' && requireTxReject){\n    karate.match(txInfo.TxSts, '#? _ && _ != \"Ok\"');\n  } else {\n    if (txInfo && txInfo.TxSts){\n      karate.log('TxSts recibido:', txInfo.TxSts, '- no se valida estrictamente.');\n    } else {\n      karate.log('Sin TxSts en la respuesta, continuando sin validacion.');\n    }\n  }\n  if (outcome === 'pending'){\n    karate.match(txInfo.TxSts, '#? _ == \"PENDING\" || _ == \"PROC\"');\n  }\n  if (expectation.reasonCode){\n    var reasonNode = txInfo.Rsn || {};\n    karate.match(reasonNode.RsnCd, expectation.reasonCode);\n  }\n  if (expectation.expectedEndToEndId){\n    karate.match(txInfo.PmtId.EndToEndId, expectation.expectedEndToEndId);\n  }\n  if (expectation.expectedMsgId){\n    var grpHdr = (body && body.GrpHdr) ? body.GrpHdr : {};\n    karate.match(grpHdr.msgId, expectation.expectedMsgId);\n  }\n}","index":10,"text":"def verifyTransferOutcome ="}},{"result":{"nanos":173700,"millis":0.1737,"status":"passed"},"step":{"endLine":156,"background":true,"line":151,"prefix":"*","docString":"function(name, payload, responseBody, status){\n  karate.log('[Transfer]', name, '| status:', status, '| msgId:', payload.GrpHdr.msgId, '| endToEnd:', payload.CdtTrfTxInf.PmtId.EndToEndId);\n}","index":11,"text":"def logTransferSummary ="}},{"result":{"nanos":13142700,"millis":13.1427,"status":"passed"},"step":{"line":322,"prefix":"*","index":0,"text":"def payload = buildPayload({ amount: 5000.00 })"}},{"result":{"nanos":785900,"millis":0.7859,"status":"passed"},"step":{"line":323,"prefix":"*","index":1,"text":"def expectation = { httpStatus: [429, 409, 400], outcome: 'reject' }"}},{"result":{"nanos":2178400,"millis":2.1784,"status":"passed"},"step":{"line":324,"prefix":"*","index":2,"text":"def normalizedStatus = normalizeStatus(expectation.httpStatus)"}},{"result":{"nanos":506900,"millis":0.5069,"status":"passed"},"step":{"line":325,"prefix":"Given","index":3,"text":"path 'finan', 'transferencia'"}},{"result":{"nanos":137800,"millis":0.1378,"status":"passed"},"step":{"line":326,"prefix":"And","index":4,"text":"request payload"}},{"result":{"nanos":1798423100,"millis":1798.4231,"status":"passed"},"step":{"line":327,"prefix":"When","index":5,"text":"method post"},"stepLog":"14:14:56.320 request:\n1 > POST https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral\/finan\/transferencia\n1 > Content-Type: application\/json; charset=UTF-8\n1 > Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2dUJWTkN6VlViUFBlTFdReEM0WDAyYVM3UnM2UGRYV1dja1dfc0xZMHlFIn0.eyJleHAiOjE3NjExNjA3NTAsImlhdCI6MTc2MTE2MDQ1MCwianRpIjoidHJydGNjOjQ5Yjg0NDVjLTgzYTAtMjI4Ni02NDczLWE2ZGEzOTBhOWQ0YSIsImlzcyI6Imh0dHBzOi8vYXV0ZW50aWNhY2lvbnFhLmNvb25lY3RhLmNvbS5lYy9hdXRoL3JlYWxtcy9QQU5BUEFZIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6Ijk5OGMyZmUwLTJjOGYtNGQwNC1iZjExLWY1OWExZTM5ODg3MyIsInR5cCI6IkJlYXJlciIsImF6cCI6IjAyMDVjYiIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiLyoiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRlZmF1bHQtcm9sZXMtYWRtaW5wYW5hcGF5Iiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7IjAyMDVjYiI6eyJyb2xlcyI6WyJ1bWFfcHJvdGVjdGlvbiJdfSwiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJjbGllbnRIb3N0IjoiMTAuMTAuMTAuMTUxIiwicHJlZmVycmVkX3VzZXJuYW1lIjoic2VydmljZS1hY2NvdW50LTAyMDVjYiIsImNsaWVudEFkZHJlc3MiOiIxMC4xMC4xMC4xNTEiLCJjbGllbnRfaWQiOiIwMjA1Y2IifQ.bATUogohrEqy7Voa4mFnsBzOnGy6tnjZGh_lOYRn-0hWXMY_fz-280nTu2Vv68eO3HeoewtWlt45S_iLI2-ml3pqpAlt3DXWVmLvVHw6d7TICHBfQsa0jGXMexKnyar7EinrVhF3deSK25Ap_ajC_82EvVvXrVG-7p9F1dEdq39y2R72JympejF5uhY_z_jNmqJSsnLEZVOo3WMJn76u9tTcYVIldC5uWGFWbPGEhvWPx4ZGpsuq_wrPOGdRmyJDFJPJl7LnLGHK0DBhuVtJUq_NFQkMus2fTTf_mWhRnoqNU-wUCS-fxMs6QusGzIVd-C3O29J3rerHTrGg21LAsQ\n1 > Content-Length: 514\n1 > Host: apipanapayqa.coonecta.com.ec\n1 > Connection: Keep-Alive\n1 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/17.0.12)\n1 > Accept-Encoding: gzip,deflate\n{\"GrpHdr\":{\"msgId\":\"02052025102286051865074\",\"creDtTm\":\"2025-10-22T14:14:56\",\"nbOfTxs\":1,\"sttlmInf\":{\"sttlmMtd\":\"INGA\"},\"instgAgt\":{\"finInstnId\":\"0205\"},\"InstdAgt\":{\"FinInstnId\":\"0205\"},\"Mge\":{\"Type\":\"acmt.998.321.01\"},\"ChnlId\":\"APP\"},\"CdtTrfTxInf\":{\"PmtId\":{\"EndToEndId\":\"02052025102249135\"},\"IntrBkSttlmAmt\":{\"Amt\":5000.0,\"Ccy\":\"USD\"},\"DbtrAcctId\":{\"IBAN\":\"EC5002051000000000020501052673\"},\"CdtrAcctId\":{\"IBAN\":\"EC0402051000000000020101002318\"},\"Prtry\":{\"CustRef\":\"QA22\",\"ChanRef\":\"TERM001\",\"AgtRef\":\"AGT0002\"}}}\n\n14:14:58.111 response time in milliseconds: 1791\n1 < 400\n1 < Date: Wed, 22 Oct 2025 19:14:50 GMT\n1 < Content-Type: application\/json; charset=utf-8\n1 < Transfer-Encoding: chunked\n1 < Connection: keep-alive\n1 < Server: Kestrel\n1 < Set-Cookie: ARRAffinity=135f536e0d078a815c3b83fda3468ab8a3a2abc604a35eefb28648d3961cfa9b;Path=\/;HttpOnly;Secure;Domain=app-apipanapay-qa.azurewebsites.net\n1 < Set-Cookie: ARRAffinitySameSite=135f536e0d078a815c3b83fda3468ab8a3a2abc604a35eefb28648d3961cfa9b;Path=\/;HttpOnly;SameSite=None;Secure;Domain=app-apipanapay-qa.azurewebsites.net\n1 < Request-Context: appId=cid-v1:a7a77847-2713-450f-9030-b350a2d54a28\n1 < X-Powered-By: ASP.NET\n1 < X-ARR-ClientCert: -----BEGIN%20CERTIFICATE-----%0AMIIEHDCCAgSgAwIBAgIUZIZBO0fb7VZ4KXrs01S4RYbWyJ8wDQYJKoZIhvcNAQEL%0ABQAwJTEjMCEGA1UEAwwacm9vdGNlcnQuY2JpYmxpYW4uaW50ZXJuYWwwHhcNMjUw%0AODEzMTMyNTU5WhcNMjgwODEyMTMyNTU5WjAnMSUwIwYDVQQDDBxjbGllbnRjZXJ0%0ALmNiaWJsaWFuLmludGVybmFsMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKC%0AAQEAskUDap6NmyYq8RT6F7z3DpZGQiflNQTvUT84TmxsKXEBRAkgINnkJqgKkd7f%0ASEybzqglQTbr4s41lCiPsy3X66qYjU2L%2Bojhni%2BOCVOX7n3JBYovL%2FqfMP3%2FkhZP%0AQIlK%2FQWPcrnl39fYkGOQv%2BYqoCGEPzGkib2m1Ma5Q1HOCKh1ErMjqTLGy%2ByJj6JY%0AiZvMx3YrJSvjUS0uKpNwxPtGyiexRfKsmR%2FHqPzRHa0iY%2B752KSgUedwJPv1Wod%2B%0AY9BMAMIdU25UtkUEsaOYtorGWDaZSn2Bl0LYmP87kjcYypnHx0jtPtUCXfVHrE6u%0AZnDRFYsZbeXylY3mJkyOL2DzZwIDAQABo0IwQDAdBgNVHQ4EFgQURPhJwTAcUWUp%0ArOqQO68P%2FbJoqjMwHwYDVR0jBBgwFoAU7GdlxoSeEXucEXhjadHRC9xzS0UwDQYJ%0AKoZIhvcNAQELBQADggIBAGTnlyF2n%2F6s9phYbO8V17niO0BXB62ToX6gPhcw9f3y%0AhMui6RnrM1oiHlBWqZquCqYJ5ETvYJE1RqvoqtGysxCnIj0OTJHV4WtF3SHsd1Tu%0ATg%2B%2FUnGivtBTDQxj9sbAtCaSYRBqPByP8jvSTDgXR1mgOrEGjr2PZdZSoKLj4OHi%0A9UCMJw7pJsyA4lbroKshQTYv5Ks5SqtJpdp0%2BUX0UUlbPJqXiadfbKdoXvEgcwbP%0ACqR9v7kGYmNxfaGLNGVrV%2BnLawIDmdYXJE%2F4WJh6sHfiZxEsE%2BB4PoKADrb1Eapt%0AnSdHUgRfc0i5f2lcmErnU8nCMO5TWdHFOgpYwTS8w17FhNFZpaSmyZKM7uHcUs7y%0AUbuiQtdXocfSSMf%2FeycBEU%2FHAVIWQEqY%2BbJdC0q%2FR%2BsESeBtXd4IEIxR0QfgscGk%0AJyCSFC8z%2FvCgrRsH5rePqKO7%2FLAsDTP4GIQNFNfF4Wh6bsPXuJmvvoMcnmy%2F58Wo%0AE0XaG8UPHVAeyEmhncdM32E7SJbR91aRr2CkV23OoUz%2BwKG2%2FuObHmAkuMkCbbcz%0AJQoC7DZg5FGw%2BZR7v1DIBct5QNJQ8bG%2FXGRxjWC6dU7jrGhOF1X%2B2YYcdx9XnwyM%0A9YPxUy5bVfMhIiKP2wEso5fjOZ4RTvnB5R6zD3maJK%2FtZAXVhtyqXSkBYFi4MvEs%0A-----END%20CERTIFICATE-----%0A\n{\"GrpHdr\":{\"MsgId\":\"000020251022020367\",\"CreDtTm\":\"2025-10-22T14:14:49\",\"NbOfTxs\":1,\"SttlmInf\":{\"SttlmMtd\":\"INGA\"},\"InstgAgt\":{\"FinInstnId\":\"0205\"},\"InstdAgt\":{\"FinInstnId\":\"0205\"},\"Mge\":{\"Type\":\"acmt.998.322.001\"},\"ChnlId\":\"APP\"},\"CdtTrfTxInf\":{\"OrgnGrpInf\":{\"OrgnlMsgId\":\"02052025102286051865074\",\"OrgnlMgeType\":\"acmt.998.321.01\",\"OrgnlCreDtTm\":\"2025-10-22T14:14:56\"},\"TxSts\":\"ERR\",\"Rsn\":{\"RsnCd\":\"AM02\",\"AddtlInf\":\"El monto excede el máximo permitido.\"},\"SttlmDt\":\"2025-10-22\"}}\n\n"},{"result":{"nanos":0,"errorMessage":"no step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:328","millis":0.0,"status":"failed"},"step":{"line":328,"prefix":"Then","index":6,"text":"match responseStatus in normalizedStatus"},"stepLog":"14:14:58.111 classpath:Transferencia.feature:328\nThen match responseStatus in normalizedStatus\nno step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:328\n"},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":329,"prefix":"*","index":7,"text":"eval verifyTransferOutcome(response, expectation)"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":330,"prefix":"*","index":8,"text":"eval logTransferSummary('Limite diario acumulado', payload, response, responseStatus)"}}],"line":321,"description":"","durationMillis":1833.0208,"failed":true,"error":"no step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:328","tags":["transferencia"],"executorName":"main","name":"Validar limites por transacciones de usuario, monto acumulado diario superior al permitido","startTime":1761160496266,"refId":"[14:321]","endTime":1761160498111,"exampleIndex":-1},{"sectionIndex":14,"stepResults":[{"result":{"nanos":6117800,"millis":6.1178,"status":"passed"},"step":{"background":true,"line":5,"prefix":"*","index":0,"text":"def tokenContext = callonce read('classpath:helpers\/generate-token.feature')"},"stepLog":"14:14:58.136 key store key count for classpath:certificado\/clientcert.cbiblian.internal 1.pfx: 1\n"},{"result":{"nanos":351800,"millis":0.3518,"status":"passed"},"step":{"background":true,"line":6,"prefix":"*","index":1,"text":"def tokenData = tokenContext.tokenInfo"}},{"result":{"nanos":509000,"millis":0.509,"status":"passed"},"step":{"background":true,"line":7,"prefix":"*","index":2,"text":"def transferenciaBaseUrl = karate.properties['transfer.baseUrl'] || 'https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral'"}},{"result":{"nanos":545000,"millis":0.545,"status":"passed"},"step":{"background":true,"line":8,"prefix":"*","index":3,"text":"url transferenciaBaseUrl"}},{"result":{"nanos":408100,"millis":0.4081,"status":"passed"},"step":{"background":true,"line":9,"prefix":"*","index":4,"text":"def authHeaders = { 'Content-Type': 'application\/json' }"}},{"result":{"nanos":728500,"millis":0.7285,"status":"passed"},"step":{"background":true,"line":10,"prefix":"*","index":5,"text":"set authHeaders.Authorization = 'Bearer ' + tokenData.auth_tokencb"}},{"result":{"nanos":139300,"millis":0.1393,"status":"passed"},"step":{"background":true,"line":11,"prefix":"*","index":6,"text":"configure headers = authHeaders"}},{"result":{"nanos":793900,"millis":0.7939,"status":"passed"},"step":{"endLine":24,"background":true,"line":12,"prefix":"*","docString":"{\n  \"0205\": {\n    \"CTA_AHORROS\": \"EC5002051000000000020501052673\",\n    \"CTA_CORRIENTE\": \"EC0402051000000000020101002318\"\n  },\n  \"0303\": {\n    \"CTA_AHORROS\": \"EC5003031000000000030301051111\",\n    \"CTA_CORRIENTE\": \"EC0403031000000000030101002222\"\n  }\n}","index":7,"text":"def accountCatalog ="}},{"result":{"nanos":360700,"millis":0.3607,"status":"passed"},"step":{"endLine":39,"background":true,"line":25,"prefix":"*","docString":"function(value){\n  var list;\n  if (!value && value !== 0){\n    list = [200];\n  } else {\n    list = Array.isArray(value) ? value.slice(0) : [value];\n  }\n  if (list.indexOf(200) === -1){\n    list.push(200);\n  }\n  return list;\n}","index":8,"text":"def normalizeStatus ="}},{"result":{"nanos":393700,"millis":0.3937,"status":"passed"},"step":{"endLine":110,"background":true,"line":40,"prefix":"*","docString":"function(overrides){\n  overrides = overrides || {};\n  var token = karate.get('tokenData');\n  var catalog = karate.get('accountCatalog');\n  var LocalDateTime = Java.type('java.time.LocalDateTime');\n  var DateTimeFormatter = Java.type('java.time.format.DateTimeFormatter');\n  var timestamp = LocalDateTime.now().format(DateTimeFormatter.ofPattern(\"yyyy-MM-dd'T'HH:mm:ss\"));\n  var randomDigits = function(length){\n    var digits = '';\n    for (var i = 0; i < length; i++){\n      digits += Math.floor(Math.random() * 10);\n    }\n    return digits;\n  };\n  var coopCode = overrides.instgAgtFinInstId || token.coop_codecb || '0205';\n  var debtorType = overrides.debtorAccountType || 'CTA_AHORROS';\n  var creditorType = overrides.creditorAccountType || 'CTA_CORRIENTE';\n  var creditorEntity = overrides.creditorEntity || overrides.instdAgtFinInstId || coopCode;\n  var debtorAccounts = catalog[coopCode] || catalog['0205'];\n  var creditorAccounts = catalog[creditorEntity] || catalog['0303'];\n  var debtorIban = overrides.debtorIban || (debtorAccounts ? (debtorAccounts[debtorType] || debtorAccounts['CTA_AHORROS']) : 'EC5002051000000000020501052673');\n  var creditorIban = overrides.creditorIban || (creditorAccounts ? (creditorAccounts[creditorType] || creditorAccounts['CTA_CORRIENTE']) : 'EC0403031000000000030101002222');\n  if (overrides.sameIban){\n    creditorIban = debtorIban;\n  }\n  var msgId = overrides.msgId || (coopCode + token.currentDate + randomDigits(11));\n  var endToEndId = overrides.endToEndId || (coopCode + token.currentDate + randomDigits(5));\n  var amountValue = overrides.amount != null ? overrides.amount : 1.00;\n  var payload = {\n    GrpHdr: {\n      msgId: msgId,\n      creDtTm: timestamp,\n      nbOfTxs: overrides.nbOfTxs || 1,\n      sttlmInf: { sttlmMtd: overrides.settlementMethod || 'INGA' },\n      instgAgt: { finInstnId: coopCode },\n      InstdAgt: { FinInstnId: overrides.instdAgtFinInstId || creditorEntity },\n      Mge: { Type: overrides.messageType || 'acmt.998.321.01' },\n      ChnlId: overrides.channel || 'APP'\n    },\n    CdtTrfTxInf: {\n      PmtId: { EndToEndId: endToEndId },\n      IntrBkSttlmAmt: { Amt: amountValue, Ccy: overrides.currency || 'USD' },\n      DbtrAcctId: { IBAN: debtorIban },\n      CdtrAcctId: { IBAN: creditorIban },\n      Prtry: {\n        CustRef: overrides.customerReference || 'QA22',\n        ChanRef: overrides.channelReference || (overrides.channel === 'QR' ? 'QRPANAPAY' : 'TERM001'),\n        AgtRef: overrides.agentReference || 'AGT0002'\n      }\n    }\n  };\n  if (overrides.prtryOverrides){\n    Object.keys(overrides.prtryOverrides).forEach(function(key){\n      payload.CdtTrfTxInf.Prtry[key] = overrides.prtryOverrides[key];\n    });\n  }\n  if (overrides.overrideHeaders){\n    payload.GrpHdr.instgAgt = overrides.overrideHeaders.instgAgt || payload.GrpHdr.instgAgt;\n    payload.GrpHdr.InstdAgt = overrides.overrideHeaders.instdAgt || payload.GrpHdr.InstdAgt;\n  }\n  return payload;\n}","index":9,"text":"def buildPayload ="}},{"result":{"nanos":223600,"millis":0.2236,"status":"passed"},"step":{"endLine":150,"background":true,"line":111,"prefix":"*","docString":"function(body, expectation){\n  expectation = expectation || {};\n  var txInfo = (body && body.CdtTrfTxInf) ? body.CdtTrfTxInf : {};\n  var outcome = expectation.outcome || 'success';\n  var requireTxOk = expectation.requireTxOk === true;\n  var requireTxReject = expectation.requireTxReject === true;\n  var expectedTxStatus = expectation.expectedTxStatus;\n  if (expectedTxStatus != null){\n    karate.match(txInfo.TxSts, expectedTxStatus);\n  } else if (outcome === 'success' && requireTxOk){\n    karate.match(txInfo.TxSts, 'Ok');\n  } else if (outcome === 'reject' && requireTxReject){\n    karate.match(txInfo.TxSts, '#? _ && _ != \"Ok\"');\n  } else {\n    if (txInfo && txInfo.TxSts){\n      karate.log('TxSts recibido:', txInfo.TxSts, '- no se valida estrictamente.');\n    } else {\n      karate.log('Sin TxSts en la respuesta, continuando sin validacion.');\n    }\n  }\n  if (outcome === 'pending'){\n    karate.match(txInfo.TxSts, '#? _ == \"PENDING\" || _ == \"PROC\"');\n  }\n  if (expectation.reasonCode){\n    var reasonNode = txInfo.Rsn || {};\n    karate.match(reasonNode.RsnCd, expectation.reasonCode);\n  }\n  if (expectation.expectedEndToEndId){\n    karate.match(txInfo.PmtId.EndToEndId, expectation.expectedEndToEndId);\n  }\n  if (expectation.expectedMsgId){\n    var grpHdr = (body && body.GrpHdr) ? body.GrpHdr : {};\n    karate.match(grpHdr.msgId, expectation.expectedMsgId);\n  }\n}","index":10,"text":"def verifyTransferOutcome ="}},{"result":{"nanos":147600,"millis":0.1476,"status":"passed"},"step":{"endLine":156,"background":true,"line":151,"prefix":"*","docString":"function(name, payload, responseBody, status){\n  karate.log('[Transfer]', name, '| status:', status, '| msgId:', payload.GrpHdr.msgId, '| endToEnd:', payload.CdtTrfTxInf.PmtId.EndToEndId);\n}","index":11,"text":"def logTransferSummary ="}},{"result":{"nanos":5641300,"millis":5.6413,"status":"passed"},"step":{"line":333,"prefix":"*","index":0,"text":"def payload = buildPayload({ amount: 12000.00 })"}},{"result":{"nanos":1238000,"millis":1.238,"status":"passed"},"step":{"line":334,"prefix":"*","index":1,"text":"def expectation = { httpStatus: [429, 409, 400], outcome: 'reject' }"}},{"result":{"nanos":1920300,"millis":1.9203,"status":"passed"},"step":{"line":335,"prefix":"*","index":2,"text":"def normalizedStatus = normalizeStatus(expectation.httpStatus)"}},{"result":{"nanos":434400,"millis":0.4344,"status":"passed"},"step":{"line":336,"prefix":"Given","index":3,"text":"path 'finan', 'transferencia'"}},{"result":{"nanos":237100,"millis":0.2371,"status":"passed"},"step":{"line":337,"prefix":"And","index":4,"text":"request payload"}},{"result":{"nanos":1901541000,"millis":1901.541,"status":"passed"},"step":{"line":338,"prefix":"When","index":5,"text":"method post"},"stepLog":"14:14:58.160 request:\n1 > POST https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral\/finan\/transferencia\n1 > Content-Type: application\/json; charset=UTF-8\n1 > Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2dUJWTkN6VlViUFBlTFdReEM0WDAyYVM3UnM2UGRYV1dja1dfc0xZMHlFIn0.eyJleHAiOjE3NjExNjA3NTAsImlhdCI6MTc2MTE2MDQ1MCwianRpIjoidHJydGNjOjQ5Yjg0NDVjLTgzYTAtMjI4Ni02NDczLWE2ZGEzOTBhOWQ0YSIsImlzcyI6Imh0dHBzOi8vYXV0ZW50aWNhY2lvbnFhLmNvb25lY3RhLmNvbS5lYy9hdXRoL3JlYWxtcy9QQU5BUEFZIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6Ijk5OGMyZmUwLTJjOGYtNGQwNC1iZjExLWY1OWExZTM5ODg3MyIsInR5cCI6IkJlYXJlciIsImF6cCI6IjAyMDVjYiIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiLyoiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRlZmF1bHQtcm9sZXMtYWRtaW5wYW5hcGF5Iiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7IjAyMDVjYiI6eyJyb2xlcyI6WyJ1bWFfcHJvdGVjdGlvbiJdfSwiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJjbGllbnRIb3N0IjoiMTAuMTAuMTAuMTUxIiwicHJlZmVycmVkX3VzZXJuYW1lIjoic2VydmljZS1hY2NvdW50LTAyMDVjYiIsImNsaWVudEFkZHJlc3MiOiIxMC4xMC4xMC4xNTEiLCJjbGllbnRfaWQiOiIwMjA1Y2IifQ.bATUogohrEqy7Voa4mFnsBzOnGy6tnjZGh_lOYRn-0hWXMY_fz-280nTu2Vv68eO3HeoewtWlt45S_iLI2-ml3pqpAlt3DXWVmLvVHw6d7TICHBfQsa0jGXMexKnyar7EinrVhF3deSK25Ap_ajC_82EvVvXrVG-7p9F1dEdq39y2R72JympejF5uhY_z_jNmqJSsnLEZVOo3WMJn76u9tTcYVIldC5uWGFWbPGEhvWPx4ZGpsuq_wrPOGdRmyJDFJPJl7LnLGHK0DBhuVtJUq_NFQkMus2fTTf_mWhRnoqNU-wUCS-fxMs6QusGzIVd-C3O29J3rerHTrGg21LAsQ\n1 > Content-Length: 515\n1 > Host: apipanapayqa.coonecta.com.ec\n1 > Connection: Keep-Alive\n1 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/17.0.12)\n1 > Accept-Encoding: gzip,deflate\n{\"GrpHdr\":{\"msgId\":\"02052025102217544221669\",\"creDtTm\":\"2025-10-22T14:14:58\",\"nbOfTxs\":1,\"sttlmInf\":{\"sttlmMtd\":\"INGA\"},\"instgAgt\":{\"finInstnId\":\"0205\"},\"InstdAgt\":{\"FinInstnId\":\"0205\"},\"Mge\":{\"Type\":\"acmt.998.321.01\"},\"ChnlId\":\"APP\"},\"CdtTrfTxInf\":{\"PmtId\":{\"EndToEndId\":\"02052025102228612\"},\"IntrBkSttlmAmt\":{\"Amt\":12000.0,\"Ccy\":\"USD\"},\"DbtrAcctId\":{\"IBAN\":\"EC5002051000000000020501052673\"},\"CdtrAcctId\":{\"IBAN\":\"EC0402051000000000020101002318\"},\"Prtry\":{\"CustRef\":\"QA22\",\"ChanRef\":\"TERM001\",\"AgtRef\":\"AGT0002\"}}}\n\n14:15:00.060 response time in milliseconds: 1897\n1 < 400\n1 < Date: Wed, 22 Oct 2025 19:14:51 GMT\n1 < Content-Type: application\/json; charset=utf-8\n1 < Transfer-Encoding: chunked\n1 < Connection: keep-alive\n1 < Server: Kestrel\n1 < Set-Cookie: ARRAffinity=135f536e0d078a815c3b83fda3468ab8a3a2abc604a35eefb28648d3961cfa9b;Path=\/;HttpOnly;Secure;Domain=app-apipanapay-qa.azurewebsites.net\n1 < Set-Cookie: ARRAffinitySameSite=135f536e0d078a815c3b83fda3468ab8a3a2abc604a35eefb28648d3961cfa9b;Path=\/;HttpOnly;SameSite=None;Secure;Domain=app-apipanapay-qa.azurewebsites.net\n1 < Request-Context: appId=cid-v1:a7a77847-2713-450f-9030-b350a2d54a28\n1 < X-Powered-By: ASP.NET\n1 < X-ARR-ClientCert: -----BEGIN%20CERTIFICATE-----%0AMIIEHDCCAgSgAwIBAgIUZIZBO0fb7VZ4KXrs01S4RYbWyJ8wDQYJKoZIhvcNAQEL%0ABQAwJTEjMCEGA1UEAwwacm9vdGNlcnQuY2JpYmxpYW4uaW50ZXJuYWwwHhcNMjUw%0AODEzMTMyNTU5WhcNMjgwODEyMTMyNTU5WjAnMSUwIwYDVQQDDBxjbGllbnRjZXJ0%0ALmNiaWJsaWFuLmludGVybmFsMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKC%0AAQEAskUDap6NmyYq8RT6F7z3DpZGQiflNQTvUT84TmxsKXEBRAkgINnkJqgKkd7f%0ASEybzqglQTbr4s41lCiPsy3X66qYjU2L%2Bojhni%2BOCVOX7n3JBYovL%2FqfMP3%2FkhZP%0AQIlK%2FQWPcrnl39fYkGOQv%2BYqoCGEPzGkib2m1Ma5Q1HOCKh1ErMjqTLGy%2ByJj6JY%0AiZvMx3YrJSvjUS0uKpNwxPtGyiexRfKsmR%2FHqPzRHa0iY%2B752KSgUedwJPv1Wod%2B%0AY9BMAMIdU25UtkUEsaOYtorGWDaZSn2Bl0LYmP87kjcYypnHx0jtPtUCXfVHrE6u%0AZnDRFYsZbeXylY3mJkyOL2DzZwIDAQABo0IwQDAdBgNVHQ4EFgQURPhJwTAcUWUp%0ArOqQO68P%2FbJoqjMwHwYDVR0jBBgwFoAU7GdlxoSeEXucEXhjadHRC9xzS0UwDQYJ%0AKoZIhvcNAQELBQADggIBAGTnlyF2n%2F6s9phYbO8V17niO0BXB62ToX6gPhcw9f3y%0AhMui6RnrM1oiHlBWqZquCqYJ5ETvYJE1RqvoqtGysxCnIj0OTJHV4WtF3SHsd1Tu%0ATg%2B%2FUnGivtBTDQxj9sbAtCaSYRBqPByP8jvSTDgXR1mgOrEGjr2PZdZSoKLj4OHi%0A9UCMJw7pJsyA4lbroKshQTYv5Ks5SqtJpdp0%2BUX0UUlbPJqXiadfbKdoXvEgcwbP%0ACqR9v7kGYmNxfaGLNGVrV%2BnLawIDmdYXJE%2F4WJh6sHfiZxEsE%2BB4PoKADrb1Eapt%0AnSdHUgRfc0i5f2lcmErnU8nCMO5TWdHFOgpYwTS8w17FhNFZpaSmyZKM7uHcUs7y%0AUbuiQtdXocfSSMf%2FeycBEU%2FHAVIWQEqY%2BbJdC0q%2FR%2BsESeBtXd4IEIxR0QfgscGk%0AJyCSFC8z%2FvCgrRsH5rePqKO7%2FLAsDTP4GIQNFNfF4Wh6bsPXuJmvvoMcnmy%2F58Wo%0AE0XaG8UPHVAeyEmhncdM32E7SJbR91aRr2CkV23OoUz%2BwKG2%2FuObHmAkuMkCbbcz%0AJQoC7DZg5FGw%2BZR7v1DIBct5QNJQ8bG%2FXGRxjWC6dU7jrGhOF1X%2B2YYcdx9XnwyM%0A9YPxUy5bVfMhIiKP2wEso5fjOZ4RTvnB5R6zD3maJK%2FtZAXVhtyqXSkBYFi4MvEs%0A-----END%20CERTIFICATE-----%0A\n{\"GrpHdr\":{\"MsgId\":\"000020251022020368\",\"CreDtTm\":\"2025-10-22T14:14:51\",\"NbOfTxs\":1,\"SttlmInf\":{\"SttlmMtd\":\"INGA\"},\"InstgAgt\":{\"FinInstnId\":\"0205\"},\"InstdAgt\":{\"FinInstnId\":\"0205\"},\"Mge\":{\"Type\":\"acmt.998.322.001\"},\"ChnlId\":\"APP\"},\"CdtTrfTxInf\":{\"OrgnGrpInf\":{\"OrgnlMsgId\":\"02052025102217544221669\",\"OrgnlMgeType\":\"acmt.998.321.01\",\"OrgnlCreDtTm\":\"2025-10-22T14:14:58\"},\"TxSts\":\"ERR\",\"Rsn\":{\"RsnCd\":\"AM02\",\"AddtlInf\":\"El monto excede el máximo permitido.\"},\"SttlmDt\":\"2025-10-22\"}}\n\n"},{"result":{"nanos":0,"errorMessage":"no step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:339","millis":0.0,"status":"failed"},"step":{"line":339,"prefix":"Then","index":6,"text":"match responseStatus in normalizedStatus"},"stepLog":"14:15:00.060 classpath:Transferencia.feature:339\nThen match responseStatus in normalizedStatus\nno step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:339\n"},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":340,"prefix":"*","index":7,"text":"eval verifyTransferOutcome(response, expectation)"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":341,"prefix":"*","index":8,"text":"eval logTransferSummary('Limite mensual acumulado', payload, response, responseStatus)"}}],"line":332,"description":"","durationMillis":1921.7311,"failed":true,"error":"no step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:339","tags":["transferencia"],"executorName":"main","name":"Validar limites por transacciones de usuario, monto acumulado mensual superior al permitido","startTime":1761160498130,"refId":"[15:332]","endTime":1761160500060,"exampleIndex":-1},{"sectionIndex":15,"stepResults":[{"result":{"nanos":3508300,"millis":3.5083,"status":"passed"},"step":{"background":true,"line":5,"prefix":"*","index":0,"text":"def tokenContext = callonce read('classpath:helpers\/generate-token.feature')"},"stepLog":"14:15:00.081 key store key count for classpath:certificado\/clientcert.cbiblian.internal 1.pfx: 1\n"},{"result":{"nanos":366200,"millis":0.3662,"status":"passed"},"step":{"background":true,"line":6,"prefix":"*","index":1,"text":"def tokenData = tokenContext.tokenInfo"}},{"result":{"nanos":475000,"millis":0.475,"status":"passed"},"step":{"background":true,"line":7,"prefix":"*","index":2,"text":"def transferenciaBaseUrl = karate.properties['transfer.baseUrl'] || 'https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral'"}},{"result":{"nanos":85200,"millis":0.0852,"status":"passed"},"step":{"background":true,"line":8,"prefix":"*","index":3,"text":"url transferenciaBaseUrl"}},{"result":{"nanos":379300,"millis":0.3793,"status":"passed"},"step":{"background":true,"line":9,"prefix":"*","index":4,"text":"def authHeaders = { 'Content-Type': 'application\/json' }"}},{"result":{"nanos":791800,"millis":0.7918,"status":"passed"},"step":{"background":true,"line":10,"prefix":"*","index":5,"text":"set authHeaders.Authorization = 'Bearer ' + tokenData.auth_tokencb"}},{"result":{"nanos":933400,"millis":0.9334,"status":"passed"},"step":{"background":true,"line":11,"prefix":"*","index":6,"text":"configure headers = authHeaders"}},{"result":{"nanos":495300,"millis":0.4953,"status":"passed"},"step":{"endLine":24,"background":true,"line":12,"prefix":"*","docString":"{\n  \"0205\": {\n    \"CTA_AHORROS\": \"EC5002051000000000020501052673\",\n    \"CTA_CORRIENTE\": \"EC0402051000000000020101002318\"\n  },\n  \"0303\": {\n    \"CTA_AHORROS\": \"EC5003031000000000030301051111\",\n    \"CTA_CORRIENTE\": \"EC0403031000000000030101002222\"\n  }\n}","index":7,"text":"def accountCatalog ="}},{"result":{"nanos":416700,"millis":0.4167,"status":"passed"},"step":{"endLine":39,"background":true,"line":25,"prefix":"*","docString":"function(value){\n  var list;\n  if (!value && value !== 0){\n    list = [200];\n  } else {\n    list = Array.isArray(value) ? value.slice(0) : [value];\n  }\n  if (list.indexOf(200) === -1){\n    list.push(200);\n  }\n  return list;\n}","index":8,"text":"def normalizeStatus ="}},{"result":{"nanos":451000,"millis":0.451,"status":"passed"},"step":{"endLine":110,"background":true,"line":40,"prefix":"*","docString":"function(overrides){\n  overrides = overrides || {};\n  var token = karate.get('tokenData');\n  var catalog = karate.get('accountCatalog');\n  var LocalDateTime = Java.type('java.time.LocalDateTime');\n  var DateTimeFormatter = Java.type('java.time.format.DateTimeFormatter');\n  var timestamp = LocalDateTime.now().format(DateTimeFormatter.ofPattern(\"yyyy-MM-dd'T'HH:mm:ss\"));\n  var randomDigits = function(length){\n    var digits = '';\n    for (var i = 0; i < length; i++){\n      digits += Math.floor(Math.random() * 10);\n    }\n    return digits;\n  };\n  var coopCode = overrides.instgAgtFinInstId || token.coop_codecb || '0205';\n  var debtorType = overrides.debtorAccountType || 'CTA_AHORROS';\n  var creditorType = overrides.creditorAccountType || 'CTA_CORRIENTE';\n  var creditorEntity = overrides.creditorEntity || overrides.instdAgtFinInstId || coopCode;\n  var debtorAccounts = catalog[coopCode] || catalog['0205'];\n  var creditorAccounts = catalog[creditorEntity] || catalog['0303'];\n  var debtorIban = overrides.debtorIban || (debtorAccounts ? (debtorAccounts[debtorType] || debtorAccounts['CTA_AHORROS']) : 'EC5002051000000000020501052673');\n  var creditorIban = overrides.creditorIban || (creditorAccounts ? (creditorAccounts[creditorType] || creditorAccounts['CTA_CORRIENTE']) : 'EC0403031000000000030101002222');\n  if (overrides.sameIban){\n    creditorIban = debtorIban;\n  }\n  var msgId = overrides.msgId || (coopCode + token.currentDate + randomDigits(11));\n  var endToEndId = overrides.endToEndId || (coopCode + token.currentDate + randomDigits(5));\n  var amountValue = overrides.amount != null ? overrides.amount : 1.00;\n  var payload = {\n    GrpHdr: {\n      msgId: msgId,\n      creDtTm: timestamp,\n      nbOfTxs: overrides.nbOfTxs || 1,\n      sttlmInf: { sttlmMtd: overrides.settlementMethod || 'INGA' },\n      instgAgt: { finInstnId: coopCode },\n      InstdAgt: { FinInstnId: overrides.instdAgtFinInstId || creditorEntity },\n      Mge: { Type: overrides.messageType || 'acmt.998.321.01' },\n      ChnlId: overrides.channel || 'APP'\n    },\n    CdtTrfTxInf: {\n      PmtId: { EndToEndId: endToEndId },\n      IntrBkSttlmAmt: { Amt: amountValue, Ccy: overrides.currency || 'USD' },\n      DbtrAcctId: { IBAN: debtorIban },\n      CdtrAcctId: { IBAN: creditorIban },\n      Prtry: {\n        CustRef: overrides.customerReference || 'QA22',\n        ChanRef: overrides.channelReference || (overrides.channel === 'QR' ? 'QRPANAPAY' : 'TERM001'),\n        AgtRef: overrides.agentReference || 'AGT0002'\n      }\n    }\n  };\n  if (overrides.prtryOverrides){\n    Object.keys(overrides.prtryOverrides).forEach(function(key){\n      payload.CdtTrfTxInf.Prtry[key] = overrides.prtryOverrides[key];\n    });\n  }\n  if (overrides.overrideHeaders){\n    payload.GrpHdr.instgAgt = overrides.overrideHeaders.instgAgt || payload.GrpHdr.instgAgt;\n    payload.GrpHdr.InstdAgt = overrides.overrideHeaders.instdAgt || payload.GrpHdr.InstdAgt;\n  }\n  return payload;\n}","index":9,"text":"def buildPayload ="}},{"result":{"nanos":254300,"millis":0.2543,"status":"passed"},"step":{"endLine":150,"background":true,"line":111,"prefix":"*","docString":"function(body, expectation){\n  expectation = expectation || {};\n  var txInfo = (body && body.CdtTrfTxInf) ? body.CdtTrfTxInf : {};\n  var outcome = expectation.outcome || 'success';\n  var requireTxOk = expectation.requireTxOk === true;\n  var requireTxReject = expectation.requireTxReject === true;\n  var expectedTxStatus = expectation.expectedTxStatus;\n  if (expectedTxStatus != null){\n    karate.match(txInfo.TxSts, expectedTxStatus);\n  } else if (outcome === 'success' && requireTxOk){\n    karate.match(txInfo.TxSts, 'Ok');\n  } else if (outcome === 'reject' && requireTxReject){\n    karate.match(txInfo.TxSts, '#? _ && _ != \"Ok\"');\n  } else {\n    if (txInfo && txInfo.TxSts){\n      karate.log('TxSts recibido:', txInfo.TxSts, '- no se valida estrictamente.');\n    } else {\n      karate.log('Sin TxSts en la respuesta, continuando sin validacion.');\n    }\n  }\n  if (outcome === 'pending'){\n    karate.match(txInfo.TxSts, '#? _ == \"PENDING\" || _ == \"PROC\"');\n  }\n  if (expectation.reasonCode){\n    var reasonNode = txInfo.Rsn || {};\n    karate.match(reasonNode.RsnCd, expectation.reasonCode);\n  }\n  if (expectation.expectedEndToEndId){\n    karate.match(txInfo.PmtId.EndToEndId, expectation.expectedEndToEndId);\n  }\n  if (expectation.expectedMsgId){\n    var grpHdr = (body && body.GrpHdr) ? body.GrpHdr : {};\n    karate.match(grpHdr.msgId, expectation.expectedMsgId);\n  }\n}","index":10,"text":"def verifyTransferOutcome ="}},{"result":{"nanos":210400,"millis":0.2104,"status":"passed"},"step":{"endLine":156,"background":true,"line":151,"prefix":"*","docString":"function(name, payload, responseBody, status){\n  karate.log('[Transfer]', name, '| status:', status, '| msgId:', payload.GrpHdr.msgId, '| endToEnd:', payload.CdtTrfTxInf.PmtId.EndToEndId);\n}","index":11,"text":"def logTransferSummary ="}},{"result":{"nanos":2260200,"millis":2.2602,"status":"passed"},"step":{"line":344,"prefix":"*","index":0,"text":"eval karate.log('Asegurar que el parametro de limite diario haya sido actualizado antes de ejecutar este escenario.')"},"stepLog":"14:15:00.091 Asegurar que el parametro de limite diario haya sido actualizado antes de ejecutar este escenario. \n"},{"result":{"nanos":6331000,"millis":6.331,"status":"passed"},"step":{"line":345,"prefix":"*","index":1,"text":"def payload = buildPayload({ amount: 3000.00 })"}},{"result":{"nanos":434400,"millis":0.4344,"status":"passed"},"step":{"line":346,"prefix":"*","index":2,"text":"def expectation = { httpStatus: 200, outcome: 'success', expectedEndToEndId: payload.CdtTrfTxInf.PmtId.EndToEndId }"}},{"result":{"nanos":618600,"millis":0.6186,"status":"passed"},"step":{"line":347,"prefix":"*","index":3,"text":"def normalizedStatus = normalizeStatus(expectation.httpStatus)"}},{"result":{"nanos":620500,"millis":0.6205,"status":"passed"},"step":{"line":348,"prefix":"Given","index":4,"text":"path 'finan', 'transferencia'"}},{"result":{"nanos":272600,"millis":0.2726,"status":"passed"},"step":{"line":349,"prefix":"And","index":5,"text":"request payload"}},{"result":{"nanos":2438527200,"millis":2438.5272,"status":"passed"},"step":{"line":350,"prefix":"When","index":6,"text":"method post"},"stepLog":"14:15:00.105 request:\n1 > POST https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral\/finan\/transferencia\n1 > Content-Type: application\/json; charset=UTF-8\n1 > Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2dUJWTkN6VlViUFBlTFdReEM0WDAyYVM3UnM2UGRYV1dja1dfc0xZMHlFIn0.eyJleHAiOjE3NjExNjA3NTAsImlhdCI6MTc2MTE2MDQ1MCwianRpIjoidHJydGNjOjQ5Yjg0NDVjLTgzYTAtMjI4Ni02NDczLWE2ZGEzOTBhOWQ0YSIsImlzcyI6Imh0dHBzOi8vYXV0ZW50aWNhY2lvbnFhLmNvb25lY3RhLmNvbS5lYy9hdXRoL3JlYWxtcy9QQU5BUEFZIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6Ijk5OGMyZmUwLTJjOGYtNGQwNC1iZjExLWY1OWExZTM5ODg3MyIsInR5cCI6IkJlYXJlciIsImF6cCI6IjAyMDVjYiIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiLyoiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRlZmF1bHQtcm9sZXMtYWRtaW5wYW5hcGF5Iiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7IjAyMDVjYiI6eyJyb2xlcyI6WyJ1bWFfcHJvdGVjdGlvbiJdfSwiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJjbGllbnRIb3N0IjoiMTAuMTAuMTAuMTUxIiwicHJlZmVycmVkX3VzZXJuYW1lIjoic2VydmljZS1hY2NvdW50LTAyMDVjYiIsImNsaWVudEFkZHJlc3MiOiIxMC4xMC4xMC4xNTEiLCJjbGllbnRfaWQiOiIwMjA1Y2IifQ.bATUogohrEqy7Voa4mFnsBzOnGy6tnjZGh_lOYRn-0hWXMY_fz-280nTu2Vv68eO3HeoewtWlt45S_iLI2-ml3pqpAlt3DXWVmLvVHw6d7TICHBfQsa0jGXMexKnyar7EinrVhF3deSK25Ap_ajC_82EvVvXrVG-7p9F1dEdq39y2R72JympejF5uhY_z_jNmqJSsnLEZVOo3WMJn76u9tTcYVIldC5uWGFWbPGEhvWPx4ZGpsuq_wrPOGdRmyJDFJPJl7LnLGHK0DBhuVtJUq_NFQkMus2fTTf_mWhRnoqNU-wUCS-fxMs6QusGzIVd-C3O29J3rerHTrGg21LAsQ\n1 > Content-Length: 514\n1 > Host: apipanapayqa.coonecta.com.ec\n1 > Connection: Keep-Alive\n1 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/17.0.12)\n1 > Accept-Encoding: gzip,deflate\n{\"GrpHdr\":{\"msgId\":\"02052025102296620949532\",\"creDtTm\":\"2025-10-22T14:15:00\",\"nbOfTxs\":1,\"sttlmInf\":{\"sttlmMtd\":\"INGA\"},\"instgAgt\":{\"finInstnId\":\"0205\"},\"InstdAgt\":{\"FinInstnId\":\"0205\"},\"Mge\":{\"Type\":\"acmt.998.321.01\"},\"ChnlId\":\"APP\"},\"CdtTrfTxInf\":{\"PmtId\":{\"EndToEndId\":\"02052025102241597\"},\"IntrBkSttlmAmt\":{\"Amt\":3000.0,\"Ccy\":\"USD\"},\"DbtrAcctId\":{\"IBAN\":\"EC5002051000000000020501052673\"},\"CdtrAcctId\":{\"IBAN\":\"EC0402051000000000020101002318\"},\"Prtry\":{\"CustRef\":\"QA22\",\"ChanRef\":\"TERM001\",\"AgtRef\":\"AGT0002\"}}}\n\n14:15:02.541 response time in milliseconds: 2431\n1 < 400\n1 < Date: Wed, 22 Oct 2025 19:14:54 GMT\n1 < Content-Type: application\/json; charset=utf-8\n1 < Transfer-Encoding: chunked\n1 < Connection: keep-alive\n1 < Server: Kestrel\n1 < Set-Cookie: ARRAffinity=135f536e0d078a815c3b83fda3468ab8a3a2abc604a35eefb28648d3961cfa9b;Path=\/;HttpOnly;Secure;Domain=app-apipanapay-qa.azurewebsites.net\n1 < Set-Cookie: ARRAffinitySameSite=135f536e0d078a815c3b83fda3468ab8a3a2abc604a35eefb28648d3961cfa9b;Path=\/;HttpOnly;SameSite=None;Secure;Domain=app-apipanapay-qa.azurewebsites.net\n1 < Request-Context: appId=cid-v1:a7a77847-2713-450f-9030-b350a2d54a28\n1 < X-Powered-By: ASP.NET\n1 < X-ARR-ClientCert: -----BEGIN%20CERTIFICATE-----%0AMIIEHDCCAgSgAwIBAgIUZIZBO0fb7VZ4KXrs01S4RYbWyJ8wDQYJKoZIhvcNAQEL%0ABQAwJTEjMCEGA1UEAwwacm9vdGNlcnQuY2JpYmxpYW4uaW50ZXJuYWwwHhcNMjUw%0AODEzMTMyNTU5WhcNMjgwODEyMTMyNTU5WjAnMSUwIwYDVQQDDBxjbGllbnRjZXJ0%0ALmNiaWJsaWFuLmludGVybmFsMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKC%0AAQEAskUDap6NmyYq8RT6F7z3DpZGQiflNQTvUT84TmxsKXEBRAkgINnkJqgKkd7f%0ASEybzqglQTbr4s41lCiPsy3X66qYjU2L%2Bojhni%2BOCVOX7n3JBYovL%2FqfMP3%2FkhZP%0AQIlK%2FQWPcrnl39fYkGOQv%2BYqoCGEPzGkib2m1Ma5Q1HOCKh1ErMjqTLGy%2ByJj6JY%0AiZvMx3YrJSvjUS0uKpNwxPtGyiexRfKsmR%2FHqPzRHa0iY%2B752KSgUedwJPv1Wod%2B%0AY9BMAMIdU25UtkUEsaOYtorGWDaZSn2Bl0LYmP87kjcYypnHx0jtPtUCXfVHrE6u%0AZnDRFYsZbeXylY3mJkyOL2DzZwIDAQABo0IwQDAdBgNVHQ4EFgQURPhJwTAcUWUp%0ArOqQO68P%2FbJoqjMwHwYDVR0jBBgwFoAU7GdlxoSeEXucEXhjadHRC9xzS0UwDQYJ%0AKoZIhvcNAQELBQADggIBAGTnlyF2n%2F6s9phYbO8V17niO0BXB62ToX6gPhcw9f3y%0AhMui6RnrM1oiHlBWqZquCqYJ5ETvYJE1RqvoqtGysxCnIj0OTJHV4WtF3SHsd1Tu%0ATg%2B%2FUnGivtBTDQxj9sbAtCaSYRBqPByP8jvSTDgXR1mgOrEGjr2PZdZSoKLj4OHi%0A9UCMJw7pJsyA4lbroKshQTYv5Ks5SqtJpdp0%2BUX0UUlbPJqXiadfbKdoXvEgcwbP%0ACqR9v7kGYmNxfaGLNGVrV%2BnLawIDmdYXJE%2F4WJh6sHfiZxEsE%2BB4PoKADrb1Eapt%0AnSdHUgRfc0i5f2lcmErnU8nCMO5TWdHFOgpYwTS8w17FhNFZpaSmyZKM7uHcUs7y%0AUbuiQtdXocfSSMf%2FeycBEU%2FHAVIWQEqY%2BbJdC0q%2FR%2BsESeBtXd4IEIxR0QfgscGk%0AJyCSFC8z%2FvCgrRsH5rePqKO7%2FLAsDTP4GIQNFNfF4Wh6bsPXuJmvvoMcnmy%2F58Wo%0AE0XaG8UPHVAeyEmhncdM32E7SJbR91aRr2CkV23OoUz%2BwKG2%2FuObHmAkuMkCbbcz%0AJQoC7DZg5FGw%2BZR7v1DIBct5QNJQ8bG%2FXGRxjWC6dU7jrGhOF1X%2B2YYcdx9XnwyM%0A9YPxUy5bVfMhIiKP2wEso5fjOZ4RTvnB5R6zD3maJK%2FtZAXVhtyqXSkBYFi4MvEs%0A-----END%20CERTIFICATE-----%0A\n{\"GrpHdr\":{\"MsgId\":\"000020251022020369\",\"CreDtTm\":\"2025-10-22T14:14:53\",\"NbOfTxs\":1,\"SttlmInf\":{\"SttlmMtd\":\"INGA\"},\"InstgAgt\":{\"FinInstnId\":\"0205\"},\"InstdAgt\":{\"FinInstnId\":\"0205\"},\"Mge\":{\"Type\":\"acmt.998.322.001\"},\"ChnlId\":\"APP\"},\"CdtTrfTxInf\":{\"OrgnGrpInf\":{\"OrgnlMsgId\":\"02052025102296620949532\",\"OrgnlMgeType\":\"acmt.998.321.01\",\"OrgnlCreDtTm\":\"2025-10-22T14:15:00\"},\"TxSts\":\"ERR\",\"Rsn\":{\"RsnCd\":\"AM02\",\"AddtlInf\":\"El monto excede el máximo permitido.\"},\"SttlmDt\":\"2025-10-22\"}}\n\n"},{"result":{"nanos":0,"errorMessage":"no step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:351","millis":0.0,"status":"failed"},"step":{"line":351,"prefix":"Then","index":7,"text":"match responseStatus in normalizedStatus"},"stepLog":"14:15:02.543 classpath:Transferencia.feature:351\nThen match responseStatus in normalizedStatus\nno step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:351\n"},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":352,"prefix":"*","index":8,"text":"eval verifyTransferOutcome(response, expectation)"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":353,"prefix":"*","index":9,"text":"eval logTransferSummary('Exito limite diario actualizado', payload, response, responseStatus)"}}],"line":343,"description":"","durationMillis":2457.4314,"failed":true,"error":"no step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:351","tags":["transferencia"],"executorName":"main","name":"Transferencia exitosa, monto total diario permitido despues de modificar el parametro","startTime":1761160500073,"refId":"[16:343]","endTime":1761160502543,"exampleIndex":-1},{"sectionIndex":16,"stepResults":[{"result":{"nanos":5378500,"millis":5.3785,"status":"passed"},"step":{"background":true,"line":5,"prefix":"*","index":0,"text":"def tokenContext = callonce read('classpath:helpers\/generate-token.feature')"},"stepLog":"14:15:02.559 key store key count for classpath:certificado\/clientcert.cbiblian.internal 1.pfx: 1\n"},{"result":{"nanos":373400,"millis":0.3734,"status":"passed"},"step":{"background":true,"line":6,"prefix":"*","index":1,"text":"def tokenData = tokenContext.tokenInfo"}},{"result":{"nanos":492800,"millis":0.4928,"status":"passed"},"step":{"background":true,"line":7,"prefix":"*","index":2,"text":"def transferenciaBaseUrl = karate.properties['transfer.baseUrl'] || 'https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral'"}},{"result":{"nanos":61200,"millis":0.0612,"status":"passed"},"step":{"background":true,"line":8,"prefix":"*","index":3,"text":"url transferenciaBaseUrl"}},{"result":{"nanos":439400,"millis":0.4394,"status":"passed"},"step":{"background":true,"line":9,"prefix":"*","index":4,"text":"def authHeaders = { 'Content-Type': 'application\/json' }"}},{"result":{"nanos":1712700,"millis":1.7127,"status":"passed"},"step":{"background":true,"line":10,"prefix":"*","index":5,"text":"set authHeaders.Authorization = 'Bearer ' + tokenData.auth_tokencb"}},{"result":{"nanos":204900,"millis":0.2049,"status":"passed"},"step":{"background":true,"line":11,"prefix":"*","index":6,"text":"configure headers = authHeaders"}},{"result":{"nanos":413800,"millis":0.4138,"status":"passed"},"step":{"endLine":24,"background":true,"line":12,"prefix":"*","docString":"{\n  \"0205\": {\n    \"CTA_AHORROS\": \"EC5002051000000000020501052673\",\n    \"CTA_CORRIENTE\": \"EC0402051000000000020101002318\"\n  },\n  \"0303\": {\n    \"CTA_AHORROS\": \"EC5003031000000000030301051111\",\n    \"CTA_CORRIENTE\": \"EC0403031000000000030101002222\"\n  }\n}","index":7,"text":"def accountCatalog ="}},{"result":{"nanos":698200,"millis":0.6982,"status":"passed"},"step":{"endLine":39,"background":true,"line":25,"prefix":"*","docString":"function(value){\n  var list;\n  if (!value && value !== 0){\n    list = [200];\n  } else {\n    list = Array.isArray(value) ? value.slice(0) : [value];\n  }\n  if (list.indexOf(200) === -1){\n    list.push(200);\n  }\n  return list;\n}","index":8,"text":"def normalizeStatus ="}},{"result":{"nanos":933300,"millis":0.9333,"status":"passed"},"step":{"endLine":110,"background":true,"line":40,"prefix":"*","docString":"function(overrides){\n  overrides = overrides || {};\n  var token = karate.get('tokenData');\n  var catalog = karate.get('accountCatalog');\n  var LocalDateTime = Java.type('java.time.LocalDateTime');\n  var DateTimeFormatter = Java.type('java.time.format.DateTimeFormatter');\n  var timestamp = LocalDateTime.now().format(DateTimeFormatter.ofPattern(\"yyyy-MM-dd'T'HH:mm:ss\"));\n  var randomDigits = function(length){\n    var digits = '';\n    for (var i = 0; i < length; i++){\n      digits += Math.floor(Math.random() * 10);\n    }\n    return digits;\n  };\n  var coopCode = overrides.instgAgtFinInstId || token.coop_codecb || '0205';\n  var debtorType = overrides.debtorAccountType || 'CTA_AHORROS';\n  var creditorType = overrides.creditorAccountType || 'CTA_CORRIENTE';\n  var creditorEntity = overrides.creditorEntity || overrides.instdAgtFinInstId || coopCode;\n  var debtorAccounts = catalog[coopCode] || catalog['0205'];\n  var creditorAccounts = catalog[creditorEntity] || catalog['0303'];\n  var debtorIban = overrides.debtorIban || (debtorAccounts ? (debtorAccounts[debtorType] || debtorAccounts['CTA_AHORROS']) : 'EC5002051000000000020501052673');\n  var creditorIban = overrides.creditorIban || (creditorAccounts ? (creditorAccounts[creditorType] || creditorAccounts['CTA_CORRIENTE']) : 'EC0403031000000000030101002222');\n  if (overrides.sameIban){\n    creditorIban = debtorIban;\n  }\n  var msgId = overrides.msgId || (coopCode + token.currentDate + randomDigits(11));\n  var endToEndId = overrides.endToEndId || (coopCode + token.currentDate + randomDigits(5));\n  var amountValue = overrides.amount != null ? overrides.amount : 1.00;\n  var payload = {\n    GrpHdr: {\n      msgId: msgId,\n      creDtTm: timestamp,\n      nbOfTxs: overrides.nbOfTxs || 1,\n      sttlmInf: { sttlmMtd: overrides.settlementMethod || 'INGA' },\n      instgAgt: { finInstnId: coopCode },\n      InstdAgt: { FinInstnId: overrides.instdAgtFinInstId || creditorEntity },\n      Mge: { Type: overrides.messageType || 'acmt.998.321.01' },\n      ChnlId: overrides.channel || 'APP'\n    },\n    CdtTrfTxInf: {\n      PmtId: { EndToEndId: endToEndId },\n      IntrBkSttlmAmt: { Amt: amountValue, Ccy: overrides.currency || 'USD' },\n      DbtrAcctId: { IBAN: debtorIban },\n      CdtrAcctId: { IBAN: creditorIban },\n      Prtry: {\n        CustRef: overrides.customerReference || 'QA22',\n        ChanRef: overrides.channelReference || (overrides.channel === 'QR' ? 'QRPANAPAY' : 'TERM001'),\n        AgtRef: overrides.agentReference || 'AGT0002'\n      }\n    }\n  };\n  if (overrides.prtryOverrides){\n    Object.keys(overrides.prtryOverrides).forEach(function(key){\n      payload.CdtTrfTxInf.Prtry[key] = overrides.prtryOverrides[key];\n    });\n  }\n  if (overrides.overrideHeaders){\n    payload.GrpHdr.instgAgt = overrides.overrideHeaders.instgAgt || payload.GrpHdr.instgAgt;\n    payload.GrpHdr.InstdAgt = overrides.overrideHeaders.instdAgt || payload.GrpHdr.InstdAgt;\n  }\n  return payload;\n}","index":9,"text":"def buildPayload ="}},{"result":{"nanos":467300,"millis":0.4673,"status":"passed"},"step":{"endLine":150,"background":true,"line":111,"prefix":"*","docString":"function(body, expectation){\n  expectation = expectation || {};\n  var txInfo = (body && body.CdtTrfTxInf) ? body.CdtTrfTxInf : {};\n  var outcome = expectation.outcome || 'success';\n  var requireTxOk = expectation.requireTxOk === true;\n  var requireTxReject = expectation.requireTxReject === true;\n  var expectedTxStatus = expectation.expectedTxStatus;\n  if (expectedTxStatus != null){\n    karate.match(txInfo.TxSts, expectedTxStatus);\n  } else if (outcome === 'success' && requireTxOk){\n    karate.match(txInfo.TxSts, 'Ok');\n  } else if (outcome === 'reject' && requireTxReject){\n    karate.match(txInfo.TxSts, '#? _ && _ != \"Ok\"');\n  } else {\n    if (txInfo && txInfo.TxSts){\n      karate.log('TxSts recibido:', txInfo.TxSts, '- no se valida estrictamente.');\n    } else {\n      karate.log('Sin TxSts en la respuesta, continuando sin validacion.');\n    }\n  }\n  if (outcome === 'pending'){\n    karate.match(txInfo.TxSts, '#? _ == \"PENDING\" || _ == \"PROC\"');\n  }\n  if (expectation.reasonCode){\n    var reasonNode = txInfo.Rsn || {};\n    karate.match(reasonNode.RsnCd, expectation.reasonCode);\n  }\n  if (expectation.expectedEndToEndId){\n    karate.match(txInfo.PmtId.EndToEndId, expectation.expectedEndToEndId);\n  }\n  if (expectation.expectedMsgId){\n    var grpHdr = (body && body.GrpHdr) ? body.GrpHdr : {};\n    karate.match(grpHdr.msgId, expectation.expectedMsgId);\n  }\n}","index":10,"text":"def verifyTransferOutcome ="}},{"result":{"nanos":313600,"millis":0.3136,"status":"passed"},"step":{"endLine":156,"background":true,"line":151,"prefix":"*","docString":"function(name, payload, responseBody, status){\n  karate.log('[Transfer]', name, '| status:', status, '| msgId:', payload.GrpHdr.msgId, '| endToEnd:', payload.CdtTrfTxInf.PmtId.EndToEndId);\n}","index":11,"text":"def logTransferSummary ="}},{"result":{"nanos":1829100,"millis":1.8291,"status":"passed"},"step":{"line":356,"prefix":"*","index":0,"text":"eval karate.log('Asegurar que el parametro de limite mensual haya sido actualizado antes de ejecutar este escenario.')"},"stepLog":"14:15:02.577 Asegurar que el parametro de limite mensual haya sido actualizado antes de ejecutar este escenario. \n"},{"result":{"nanos":3505100,"millis":3.5051,"status":"passed"},"step":{"line":357,"prefix":"*","index":1,"text":"def payload = buildPayload({ amount: 15000.00 })"}},{"result":{"nanos":375100,"millis":0.3751,"status":"passed"},"step":{"line":358,"prefix":"*","index":2,"text":"def expectation = { httpStatus: 200, outcome: 'success', expectedEndToEndId: payload.CdtTrfTxInf.PmtId.EndToEndId }"}},{"result":{"nanos":566800,"millis":0.5668,"status":"passed"},"step":{"line":359,"prefix":"*","index":3,"text":"def normalizedStatus = normalizeStatus(expectation.httpStatus)"}},{"result":{"nanos":163100,"millis":0.1631,"status":"passed"},"step":{"line":360,"prefix":"Given","index":4,"text":"path 'finan', 'transferencia'"}},{"result":{"nanos":52900,"millis":0.0529,"status":"passed"},"step":{"line":361,"prefix":"And","index":5,"text":"request payload"}},{"result":{"nanos":1570023800,"millis":1570.0238,"status":"passed"},"step":{"line":362,"prefix":"When","index":6,"text":"method post"},"stepLog":"14:15:02.587 request:\n1 > POST https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral\/finan\/transferencia\n1 > Content-Type: application\/json; charset=UTF-8\n1 > Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2dUJWTkN6VlViUFBlTFdReEM0WDAyYVM3UnM2UGRYV1dja1dfc0xZMHlFIn0.eyJleHAiOjE3NjExNjA3NTAsImlhdCI6MTc2MTE2MDQ1MCwianRpIjoidHJydGNjOjQ5Yjg0NDVjLTgzYTAtMjI4Ni02NDczLWE2ZGEzOTBhOWQ0YSIsImlzcyI6Imh0dHBzOi8vYXV0ZW50aWNhY2lvbnFhLmNvb25lY3RhLmNvbS5lYy9hdXRoL3JlYWxtcy9QQU5BUEFZIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6Ijk5OGMyZmUwLTJjOGYtNGQwNC1iZjExLWY1OWExZTM5ODg3MyIsInR5cCI6IkJlYXJlciIsImF6cCI6IjAyMDVjYiIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiLyoiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRlZmF1bHQtcm9sZXMtYWRtaW5wYW5hcGF5Iiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7IjAyMDVjYiI6eyJyb2xlcyI6WyJ1bWFfcHJvdGVjdGlvbiJdfSwiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJjbGllbnRIb3N0IjoiMTAuMTAuMTAuMTUxIiwicHJlZmVycmVkX3VzZXJuYW1lIjoic2VydmljZS1hY2NvdW50LTAyMDVjYiIsImNsaWVudEFkZHJlc3MiOiIxMC4xMC4xMC4xNTEiLCJjbGllbnRfaWQiOiIwMjA1Y2IifQ.bATUogohrEqy7Voa4mFnsBzOnGy6tnjZGh_lOYRn-0hWXMY_fz-280nTu2Vv68eO3HeoewtWlt45S_iLI2-ml3pqpAlt3DXWVmLvVHw6d7TICHBfQsa0jGXMexKnyar7EinrVhF3deSK25Ap_ajC_82EvVvXrVG-7p9F1dEdq39y2R72JympejF5uhY_z_jNmqJSsnLEZVOo3WMJn76u9tTcYVIldC5uWGFWbPGEhvWPx4ZGpsuq_wrPOGdRmyJDFJPJl7LnLGHK0DBhuVtJUq_NFQkMus2fTTf_mWhRnoqNU-wUCS-fxMs6QusGzIVd-C3O29J3rerHTrGg21LAsQ\n1 > Content-Length: 515\n1 > Host: apipanapayqa.coonecta.com.ec\n1 > Connection: Keep-Alive\n1 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/17.0.12)\n1 > Accept-Encoding: gzip,deflate\n{\"GrpHdr\":{\"msgId\":\"02052025102245431330268\",\"creDtTm\":\"2025-10-22T14:15:02\",\"nbOfTxs\":1,\"sttlmInf\":{\"sttlmMtd\":\"INGA\"},\"instgAgt\":{\"finInstnId\":\"0205\"},\"InstdAgt\":{\"FinInstnId\":\"0205\"},\"Mge\":{\"Type\":\"acmt.998.321.01\"},\"ChnlId\":\"APP\"},\"CdtTrfTxInf\":{\"PmtId\":{\"EndToEndId\":\"02052025102273504\"},\"IntrBkSttlmAmt\":{\"Amt\":15000.0,\"Ccy\":\"USD\"},\"DbtrAcctId\":{\"IBAN\":\"EC5002051000000000020501052673\"},\"CdtrAcctId\":{\"IBAN\":\"EC0402051000000000020101002318\"},\"Prtry\":{\"CustRef\":\"QA22\",\"ChanRef\":\"TERM001\",\"AgtRef\":\"AGT0002\"}}}\n\n14:15:04.152 response time in milliseconds: 1565\n1 < 400\n1 < Date: Wed, 22 Oct 2025 19:14:55 GMT\n1 < Content-Type: application\/json; charset=utf-8\n1 < Transfer-Encoding: chunked\n1 < Connection: keep-alive\n1 < Server: Kestrel\n1 < Set-Cookie: ARRAffinity=135f536e0d078a815c3b83fda3468ab8a3a2abc604a35eefb28648d3961cfa9b;Path=\/;HttpOnly;Secure;Domain=app-apipanapay-qa.azurewebsites.net\n1 < Set-Cookie: ARRAffinitySameSite=135f536e0d078a815c3b83fda3468ab8a3a2abc604a35eefb28648d3961cfa9b;Path=\/;HttpOnly;SameSite=None;Secure;Domain=app-apipanapay-qa.azurewebsites.net\n1 < Request-Context: appId=cid-v1:a7a77847-2713-450f-9030-b350a2d54a28\n1 < X-Powered-By: ASP.NET\n1 < X-ARR-ClientCert: -----BEGIN%20CERTIFICATE-----%0AMIIEHDCCAgSgAwIBAgIUZIZBO0fb7VZ4KXrs01S4RYbWyJ8wDQYJKoZIhvcNAQEL%0ABQAwJTEjMCEGA1UEAwwacm9vdGNlcnQuY2JpYmxpYW4uaW50ZXJuYWwwHhcNMjUw%0AODEzMTMyNTU5WhcNMjgwODEyMTMyNTU5WjAnMSUwIwYDVQQDDBxjbGllbnRjZXJ0%0ALmNiaWJsaWFuLmludGVybmFsMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKC%0AAQEAskUDap6NmyYq8RT6F7z3DpZGQiflNQTvUT84TmxsKXEBRAkgINnkJqgKkd7f%0ASEybzqglQTbr4s41lCiPsy3X66qYjU2L%2Bojhni%2BOCVOX7n3JBYovL%2FqfMP3%2FkhZP%0AQIlK%2FQWPcrnl39fYkGOQv%2BYqoCGEPzGkib2m1Ma5Q1HOCKh1ErMjqTLGy%2ByJj6JY%0AiZvMx3YrJSvjUS0uKpNwxPtGyiexRfKsmR%2FHqPzRHa0iY%2B752KSgUedwJPv1Wod%2B%0AY9BMAMIdU25UtkUEsaOYtorGWDaZSn2Bl0LYmP87kjcYypnHx0jtPtUCXfVHrE6u%0AZnDRFYsZbeXylY3mJkyOL2DzZwIDAQABo0IwQDAdBgNVHQ4EFgQURPhJwTAcUWUp%0ArOqQO68P%2FbJoqjMwHwYDVR0jBBgwFoAU7GdlxoSeEXucEXhjadHRC9xzS0UwDQYJ%0AKoZIhvcNAQELBQADggIBAGTnlyF2n%2F6s9phYbO8V17niO0BXB62ToX6gPhcw9f3y%0AhMui6RnrM1oiHlBWqZquCqYJ5ETvYJE1RqvoqtGysxCnIj0OTJHV4WtF3SHsd1Tu%0ATg%2B%2FUnGivtBTDQxj9sbAtCaSYRBqPByP8jvSTDgXR1mgOrEGjr2PZdZSoKLj4OHi%0A9UCMJw7pJsyA4lbroKshQTYv5Ks5SqtJpdp0%2BUX0UUlbPJqXiadfbKdoXvEgcwbP%0ACqR9v7kGYmNxfaGLNGVrV%2BnLawIDmdYXJE%2F4WJh6sHfiZxEsE%2BB4PoKADrb1Eapt%0AnSdHUgRfc0i5f2lcmErnU8nCMO5TWdHFOgpYwTS8w17FhNFZpaSmyZKM7uHcUs7y%0AUbuiQtdXocfSSMf%2FeycBEU%2FHAVIWQEqY%2BbJdC0q%2FR%2BsESeBtXd4IEIxR0QfgscGk%0AJyCSFC8z%2FvCgrRsH5rePqKO7%2FLAsDTP4GIQNFNfF4Wh6bsPXuJmvvoMcnmy%2F58Wo%0AE0XaG8UPHVAeyEmhncdM32E7SJbR91aRr2CkV23OoUz%2BwKG2%2FuObHmAkuMkCbbcz%0AJQoC7DZg5FGw%2BZR7v1DIBct5QNJQ8bG%2FXGRxjWC6dU7jrGhOF1X%2B2YYcdx9XnwyM%0A9YPxUy5bVfMhIiKP2wEso5fjOZ4RTvnB5R6zD3maJK%2FtZAXVhtyqXSkBYFi4MvEs%0A-----END%20CERTIFICATE-----%0A\n{\"GrpHdr\":{\"MsgId\":\"000020251022020370\",\"CreDtTm\":\"2025-10-22T14:14:56\",\"NbOfTxs\":1,\"SttlmInf\":{\"SttlmMtd\":\"INGA\"},\"InstgAgt\":{\"FinInstnId\":\"0205\"},\"InstdAgt\":{\"FinInstnId\":\"0205\"},\"Mge\":{\"Type\":\"acmt.998.322.001\"},\"ChnlId\":\"APP\"},\"CdtTrfTxInf\":{\"OrgnGrpInf\":{\"OrgnlMsgId\":\"02052025102245431330268\",\"OrgnlMgeType\":\"acmt.998.321.01\",\"OrgnlCreDtTm\":\"2025-10-22T14:15:02\"},\"TxSts\":\"ERR\",\"Rsn\":{\"RsnCd\":\"AM02\",\"AddtlInf\":\"El monto excede el máximo permitido.\"},\"SttlmDt\":\"2025-10-22\"}}\n\n"},{"result":{"nanos":0,"errorMessage":"no step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:363","millis":0.0,"status":"failed"},"step":{"line":363,"prefix":"Then","index":7,"text":"match responseStatus in normalizedStatus"},"stepLog":"14:15:04.155 classpath:Transferencia.feature:363\nThen match responseStatus in normalizedStatus\nno step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:363\n"},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":364,"prefix":"*","index":8,"text":"eval verifyTransferOutcome(response, expectation)"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":365,"prefix":"*","index":9,"text":"eval logTransferSummary('Exito limite mensual actualizado', payload, response, responseStatus)"}}],"line":355,"description":"","durationMillis":1588.005,"failed":true,"error":"no step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:363","tags":["transferencia"],"executorName":"main","name":"Transferencia exitosa, monto total mensual permitido despues de modificar el parametro","startTime":1761160502553,"refId":"[17:355]","endTime":1761160504155,"exampleIndex":-1},{"sectionIndex":17,"stepResults":[{"result":{"nanos":4376400,"millis":4.3764,"status":"passed"},"step":{"background":true,"line":5,"prefix":"*","index":0,"text":"def tokenContext = callonce read('classpath:helpers\/generate-token.feature')"},"stepLog":"14:15:04.171 key store key count for classpath:certificado\/clientcert.cbiblian.internal 1.pfx: 1\n"},{"result":{"nanos":572400,"millis":0.5724,"status":"passed"},"step":{"background":true,"line":6,"prefix":"*","index":1,"text":"def tokenData = tokenContext.tokenInfo"}},{"result":{"nanos":783600,"millis":0.7836,"status":"passed"},"step":{"background":true,"line":7,"prefix":"*","index":2,"text":"def transferenciaBaseUrl = karate.properties['transfer.baseUrl'] || 'https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral'"}},{"result":{"nanos":121200,"millis":0.1212,"status":"passed"},"step":{"background":true,"line":8,"prefix":"*","index":3,"text":"url transferenciaBaseUrl"}},{"result":{"nanos":591300,"millis":0.5913,"status":"passed"},"step":{"background":true,"line":9,"prefix":"*","index":4,"text":"def authHeaders = { 'Content-Type': 'application\/json' }"}},{"result":{"nanos":1682800,"millis":1.6828,"status":"passed"},"step":{"background":true,"line":10,"prefix":"*","index":5,"text":"set authHeaders.Authorization = 'Bearer ' + tokenData.auth_tokencb"}},{"result":{"nanos":204200,"millis":0.2042,"status":"passed"},"step":{"background":true,"line":11,"prefix":"*","index":6,"text":"configure headers = authHeaders"}},{"result":{"nanos":470500,"millis":0.4705,"status":"passed"},"step":{"endLine":24,"background":true,"line":12,"prefix":"*","docString":"{\n  \"0205\": {\n    \"CTA_AHORROS\": \"EC5002051000000000020501052673\",\n    \"CTA_CORRIENTE\": \"EC0402051000000000020101002318\"\n  },\n  \"0303\": {\n    \"CTA_AHORROS\": \"EC5003031000000000030301051111\",\n    \"CTA_CORRIENTE\": \"EC0403031000000000030101002222\"\n  }\n}","index":7,"text":"def accountCatalog ="}},{"result":{"nanos":707500,"millis":0.7075,"status":"passed"},"step":{"endLine":39,"background":true,"line":25,"prefix":"*","docString":"function(value){\n  var list;\n  if (!value && value !== 0){\n    list = [200];\n  } else {\n    list = Array.isArray(value) ? value.slice(0) : [value];\n  }\n  if (list.indexOf(200) === -1){\n    list.push(200);\n  }\n  return list;\n}","index":8,"text":"def normalizeStatus ="}},{"result":{"nanos":374000,"millis":0.374,"status":"passed"},"step":{"endLine":110,"background":true,"line":40,"prefix":"*","docString":"function(overrides){\n  overrides = overrides || {};\n  var token = karate.get('tokenData');\n  var catalog = karate.get('accountCatalog');\n  var LocalDateTime = Java.type('java.time.LocalDateTime');\n  var DateTimeFormatter = Java.type('java.time.format.DateTimeFormatter');\n  var timestamp = LocalDateTime.now().format(DateTimeFormatter.ofPattern(\"yyyy-MM-dd'T'HH:mm:ss\"));\n  var randomDigits = function(length){\n    var digits = '';\n    for (var i = 0; i < length; i++){\n      digits += Math.floor(Math.random() * 10);\n    }\n    return digits;\n  };\n  var coopCode = overrides.instgAgtFinInstId || token.coop_codecb || '0205';\n  var debtorType = overrides.debtorAccountType || 'CTA_AHORROS';\n  var creditorType = overrides.creditorAccountType || 'CTA_CORRIENTE';\n  var creditorEntity = overrides.creditorEntity || overrides.instdAgtFinInstId || coopCode;\n  var debtorAccounts = catalog[coopCode] || catalog['0205'];\n  var creditorAccounts = catalog[creditorEntity] || catalog['0303'];\n  var debtorIban = overrides.debtorIban || (debtorAccounts ? (debtorAccounts[debtorType] || debtorAccounts['CTA_AHORROS']) : 'EC5002051000000000020501052673');\n  var creditorIban = overrides.creditorIban || (creditorAccounts ? (creditorAccounts[creditorType] || creditorAccounts['CTA_CORRIENTE']) : 'EC0403031000000000030101002222');\n  if (overrides.sameIban){\n    creditorIban = debtorIban;\n  }\n  var msgId = overrides.msgId || (coopCode + token.currentDate + randomDigits(11));\n  var endToEndId = overrides.endToEndId || (coopCode + token.currentDate + randomDigits(5));\n  var amountValue = overrides.amount != null ? overrides.amount : 1.00;\n  var payload = {\n    GrpHdr: {\n      msgId: msgId,\n      creDtTm: timestamp,\n      nbOfTxs: overrides.nbOfTxs || 1,\n      sttlmInf: { sttlmMtd: overrides.settlementMethod || 'INGA' },\n      instgAgt: { finInstnId: coopCode },\n      InstdAgt: { FinInstnId: overrides.instdAgtFinInstId || creditorEntity },\n      Mge: { Type: overrides.messageType || 'acmt.998.321.01' },\n      ChnlId: overrides.channel || 'APP'\n    },\n    CdtTrfTxInf: {\n      PmtId: { EndToEndId: endToEndId },\n      IntrBkSttlmAmt: { Amt: amountValue, Ccy: overrides.currency || 'USD' },\n      DbtrAcctId: { IBAN: debtorIban },\n      CdtrAcctId: { IBAN: creditorIban },\n      Prtry: {\n        CustRef: overrides.customerReference || 'QA22',\n        ChanRef: overrides.channelReference || (overrides.channel === 'QR' ? 'QRPANAPAY' : 'TERM001'),\n        AgtRef: overrides.agentReference || 'AGT0002'\n      }\n    }\n  };\n  if (overrides.prtryOverrides){\n    Object.keys(overrides.prtryOverrides).forEach(function(key){\n      payload.CdtTrfTxInf.Prtry[key] = overrides.prtryOverrides[key];\n    });\n  }\n  if (overrides.overrideHeaders){\n    payload.GrpHdr.instgAgt = overrides.overrideHeaders.instgAgt || payload.GrpHdr.instgAgt;\n    payload.GrpHdr.InstdAgt = overrides.overrideHeaders.instdAgt || payload.GrpHdr.InstdAgt;\n  }\n  return payload;\n}","index":9,"text":"def buildPayload ="}},{"result":{"nanos":162100,"millis":0.1621,"status":"passed"},"step":{"endLine":150,"background":true,"line":111,"prefix":"*","docString":"function(body, expectation){\n  expectation = expectation || {};\n  var txInfo = (body && body.CdtTrfTxInf) ? body.CdtTrfTxInf : {};\n  var outcome = expectation.outcome || 'success';\n  var requireTxOk = expectation.requireTxOk === true;\n  var requireTxReject = expectation.requireTxReject === true;\n  var expectedTxStatus = expectation.expectedTxStatus;\n  if (expectedTxStatus != null){\n    karate.match(txInfo.TxSts, expectedTxStatus);\n  } else if (outcome === 'success' && requireTxOk){\n    karate.match(txInfo.TxSts, 'Ok');\n  } else if (outcome === 'reject' && requireTxReject){\n    karate.match(txInfo.TxSts, '#? _ && _ != \"Ok\"');\n  } else {\n    if (txInfo && txInfo.TxSts){\n      karate.log('TxSts recibido:', txInfo.TxSts, '- no se valida estrictamente.');\n    } else {\n      karate.log('Sin TxSts en la respuesta, continuando sin validacion.');\n    }\n  }\n  if (outcome === 'pending'){\n    karate.match(txInfo.TxSts, '#? _ == \"PENDING\" || _ == \"PROC\"');\n  }\n  if (expectation.reasonCode){\n    var reasonNode = txInfo.Rsn || {};\n    karate.match(reasonNode.RsnCd, expectation.reasonCode);\n  }\n  if (expectation.expectedEndToEndId){\n    karate.match(txInfo.PmtId.EndToEndId, expectation.expectedEndToEndId);\n  }\n  if (expectation.expectedMsgId){\n    var grpHdr = (body && body.GrpHdr) ? body.GrpHdr : {};\n    karate.match(grpHdr.msgId, expectation.expectedMsgId);\n  }\n}","index":10,"text":"def verifyTransferOutcome ="}},{"result":{"nanos":111500,"millis":0.1115,"status":"passed"},"step":{"endLine":156,"background":true,"line":151,"prefix":"*","docString":"function(name, payload, responseBody, status){\n  karate.log('[Transfer]', name, '| status:', status, '| msgId:', payload.GrpHdr.msgId, '| endToEnd:', payload.CdtTrfTxInf.PmtId.EndToEndId);\n}","index":11,"text":"def logTransferSummary ="}},{"result":{"nanos":29099800,"millis":29.0998,"status":"passed"},"step":{"line":368,"prefix":"*","index":0,"text":"def payload = buildPayload({ amount: 7500.00, prtryOverrides: { CustRef: 'FONDOS_INSUF' } })"}},{"result":{"nanos":991800,"millis":0.9918,"status":"passed"},"step":{"line":369,"prefix":"*","index":1,"text":"def expectation = { httpStatus: [409, 402, 400], outcome: 'reject' }"}},{"result":{"nanos":1849900,"millis":1.8499,"status":"passed"},"step":{"line":370,"prefix":"*","index":2,"text":"def normalizedStatus = normalizeStatus(expectation.httpStatus)"}},{"result":{"nanos":465200,"millis":0.4652,"status":"passed"},"step":{"line":371,"prefix":"Given","index":3,"text":"path 'finan', 'transferencia'"}},{"result":{"nanos":129300,"millis":0.1293,"status":"passed"},"step":{"line":372,"prefix":"And","index":4,"text":"request payload"}},{"result":{"nanos":2189802300,"millis":2189.8023,"status":"passed"},"step":{"line":373,"prefix":"When","index":5,"text":"method post"},"stepLog":"14:15:04.225 request:\n1 > POST https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral\/finan\/transferencia\n1 > Content-Type: application\/json; charset=UTF-8\n1 > Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2dUJWTkN6VlViUFBlTFdReEM0WDAyYVM3UnM2UGRYV1dja1dfc0xZMHlFIn0.eyJleHAiOjE3NjExNjA3NTAsImlhdCI6MTc2MTE2MDQ1MCwianRpIjoidHJydGNjOjQ5Yjg0NDVjLTgzYTAtMjI4Ni02NDczLWE2ZGEzOTBhOWQ0YSIsImlzcyI6Imh0dHBzOi8vYXV0ZW50aWNhY2lvbnFhLmNvb25lY3RhLmNvbS5lYy9hdXRoL3JlYWxtcy9QQU5BUEFZIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6Ijk5OGMyZmUwLTJjOGYtNGQwNC1iZjExLWY1OWExZTM5ODg3MyIsInR5cCI6IkJlYXJlciIsImF6cCI6IjAyMDVjYiIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiLyoiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRlZmF1bHQtcm9sZXMtYWRtaW5wYW5hcGF5Iiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7IjAyMDVjYiI6eyJyb2xlcyI6WyJ1bWFfcHJvdGVjdGlvbiJdfSwiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJjbGllbnRIb3N0IjoiMTAuMTAuMTAuMTUxIiwicHJlZmVycmVkX3VzZXJuYW1lIjoic2VydmljZS1hY2NvdW50LTAyMDVjYiIsImNsaWVudEFkZHJlc3MiOiIxMC4xMC4xMC4xNTEiLCJjbGllbnRfaWQiOiIwMjA1Y2IifQ.bATUogohrEqy7Voa4mFnsBzOnGy6tnjZGh_lOYRn-0hWXMY_fz-280nTu2Vv68eO3HeoewtWlt45S_iLI2-ml3pqpAlt3DXWVmLvVHw6d7TICHBfQsa0jGXMexKnyar7EinrVhF3deSK25Ap_ajC_82EvVvXrVG-7p9F1dEdq39y2R72JympejF5uhY_z_jNmqJSsnLEZVOo3WMJn76u9tTcYVIldC5uWGFWbPGEhvWPx4ZGpsuq_wrPOGdRmyJDFJPJl7LnLGHK0DBhuVtJUq_NFQkMus2fTTf_mWhRnoqNU-wUCS-fxMs6QusGzIVd-C3O29J3rerHTrGg21LAsQ\n1 > Content-Length: 522\n1 > Host: apipanapayqa.coonecta.com.ec\n1 > Connection: Keep-Alive\n1 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/17.0.12)\n1 > Accept-Encoding: gzip,deflate\n{\"GrpHdr\":{\"msgId\":\"02052025102278671249079\",\"creDtTm\":\"2025-10-22T14:15:04\",\"nbOfTxs\":1,\"sttlmInf\":{\"sttlmMtd\":\"INGA\"},\"instgAgt\":{\"finInstnId\":\"0205\"},\"InstdAgt\":{\"FinInstnId\":\"0205\"},\"Mge\":{\"Type\":\"acmt.998.321.01\"},\"ChnlId\":\"APP\"},\"CdtTrfTxInf\":{\"PmtId\":{\"EndToEndId\":\"02052025102207042\"},\"IntrBkSttlmAmt\":{\"Amt\":7500.0,\"Ccy\":\"USD\"},\"DbtrAcctId\":{\"IBAN\":\"EC5002051000000000020501052673\"},\"CdtrAcctId\":{\"IBAN\":\"EC0402051000000000020101002318\"},\"Prtry\":{\"CustRef\":\"FONDOS_INSUF\",\"ChanRef\":\"TERM001\",\"AgtRef\":\"AGT0002\"}}}\n\n14:15:06.408 response time in milliseconds: 2183\n1 < 400\n1 < Date: Wed, 22 Oct 2025 19:14:58 GMT\n1 < Content-Type: application\/json; charset=utf-8\n1 < Transfer-Encoding: chunked\n1 < Connection: keep-alive\n1 < Server: Kestrel\n1 < Set-Cookie: ARRAffinity=135f536e0d078a815c3b83fda3468ab8a3a2abc604a35eefb28648d3961cfa9b;Path=\/;HttpOnly;Secure;Domain=app-apipanapay-qa.azurewebsites.net\n1 < Set-Cookie: ARRAffinitySameSite=135f536e0d078a815c3b83fda3468ab8a3a2abc604a35eefb28648d3961cfa9b;Path=\/;HttpOnly;SameSite=None;Secure;Domain=app-apipanapay-qa.azurewebsites.net\n1 < Request-Context: appId=cid-v1:a7a77847-2713-450f-9030-b350a2d54a28\n1 < X-Powered-By: ASP.NET\n1 < X-ARR-ClientCert: -----BEGIN%20CERTIFICATE-----%0AMIIEHDCCAgSgAwIBAgIUZIZBO0fb7VZ4KXrs01S4RYbWyJ8wDQYJKoZIhvcNAQEL%0ABQAwJTEjMCEGA1UEAwwacm9vdGNlcnQuY2JpYmxpYW4uaW50ZXJuYWwwHhcNMjUw%0AODEzMTMyNTU5WhcNMjgwODEyMTMyNTU5WjAnMSUwIwYDVQQDDBxjbGllbnRjZXJ0%0ALmNiaWJsaWFuLmludGVybmFsMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKC%0AAQEAskUDap6NmyYq8RT6F7z3DpZGQiflNQTvUT84TmxsKXEBRAkgINnkJqgKkd7f%0ASEybzqglQTbr4s41lCiPsy3X66qYjU2L%2Bojhni%2BOCVOX7n3JBYovL%2FqfMP3%2FkhZP%0AQIlK%2FQWPcrnl39fYkGOQv%2BYqoCGEPzGkib2m1Ma5Q1HOCKh1ErMjqTLGy%2ByJj6JY%0AiZvMx3YrJSvjUS0uKpNwxPtGyiexRfKsmR%2FHqPzRHa0iY%2B752KSgUedwJPv1Wod%2B%0AY9BMAMIdU25UtkUEsaOYtorGWDaZSn2Bl0LYmP87kjcYypnHx0jtPtUCXfVHrE6u%0AZnDRFYsZbeXylY3mJkyOL2DzZwIDAQABo0IwQDAdBgNVHQ4EFgQURPhJwTAcUWUp%0ArOqQO68P%2FbJoqjMwHwYDVR0jBBgwFoAU7GdlxoSeEXucEXhjadHRC9xzS0UwDQYJ%0AKoZIhvcNAQELBQADggIBAGTnlyF2n%2F6s9phYbO8V17niO0BXB62ToX6gPhcw9f3y%0AhMui6RnrM1oiHlBWqZquCqYJ5ETvYJE1RqvoqtGysxCnIj0OTJHV4WtF3SHsd1Tu%0ATg%2B%2FUnGivtBTDQxj9sbAtCaSYRBqPByP8jvSTDgXR1mgOrEGjr2PZdZSoKLj4OHi%0A9UCMJw7pJsyA4lbroKshQTYv5Ks5SqtJpdp0%2BUX0UUlbPJqXiadfbKdoXvEgcwbP%0ACqR9v7kGYmNxfaGLNGVrV%2BnLawIDmdYXJE%2F4WJh6sHfiZxEsE%2BB4PoKADrb1Eapt%0AnSdHUgRfc0i5f2lcmErnU8nCMO5TWdHFOgpYwTS8w17FhNFZpaSmyZKM7uHcUs7y%0AUbuiQtdXocfSSMf%2FeycBEU%2FHAVIWQEqY%2BbJdC0q%2FR%2BsESeBtXd4IEIxR0QfgscGk%0AJyCSFC8z%2FvCgrRsH5rePqKO7%2FLAsDTP4GIQNFNfF4Wh6bsPXuJmvvoMcnmy%2F58Wo%0AE0XaG8UPHVAeyEmhncdM32E7SJbR91aRr2CkV23OoUz%2BwKG2%2FuObHmAkuMkCbbcz%0AJQoC7DZg5FGw%2BZR7v1DIBct5QNJQ8bG%2FXGRxjWC6dU7jrGhOF1X%2B2YYcdx9XnwyM%0A9YPxUy5bVfMhIiKP2wEso5fjOZ4RTvnB5R6zD3maJK%2FtZAXVhtyqXSkBYFi4MvEs%0A-----END%20CERTIFICATE-----%0A\n{\"GrpHdr\":{\"MsgId\":\"000020251022020371\",\"CreDtTm\":\"2025-10-22T14:14:57\",\"NbOfTxs\":1,\"SttlmInf\":{\"SttlmMtd\":\"INGA\"},\"InstgAgt\":{\"FinInstnId\":\"0205\"},\"InstdAgt\":{\"FinInstnId\":\"0205\"},\"Mge\":{\"Type\":\"acmt.998.322.001\"},\"ChnlId\":\"APP\"},\"CdtTrfTxInf\":{\"OrgnGrpInf\":{\"OrgnlMsgId\":\"02052025102278671249079\",\"OrgnlMgeType\":\"acmt.998.321.01\",\"OrgnlCreDtTm\":\"2025-10-22T14:15:04\"},\"TxSts\":\"ERR\",\"Rsn\":{\"RsnCd\":\"AM02\",\"AddtlInf\":\"El monto excede el máximo permitido.\"},\"SttlmDt\":\"2025-10-22\"}}\n\n"},{"result":{"nanos":0,"errorMessage":"no step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:374","millis":0.0,"status":"failed"},"step":{"line":374,"prefix":"Then","index":6,"text":"match responseStatus in normalizedStatus"},"stepLog":"14:15:06.408 classpath:Transferencia.feature:374\nThen match responseStatus in normalizedStatus\nno step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:374\n"},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":375,"prefix":"*","index":7,"text":"eval verifyTransferOutcome(response, expectation)"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":376,"prefix":"*","index":8,"text":"eval logTransferSummary('Fondos insuficientes', payload, response, responseStatus)"}}],"line":367,"description":"","durationMillis":2232.4958,"failed":true,"error":"no step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:374","tags":["transferencia"],"executorName":"main","name":"Transferencia no exitosa, fondos insuficientes","startTime":1761160504163,"refId":"[18:367]","endTime":1761160506408,"exampleIndex":-1},{"sectionIndex":18,"stepResults":[{"result":{"nanos":3270800,"millis":3.2708,"status":"passed"},"step":{"background":true,"line":5,"prefix":"*","index":0,"text":"def tokenContext = callonce read('classpath:helpers\/generate-token.feature')"},"stepLog":"14:15:06.428 key store key count for classpath:certificado\/clientcert.cbiblian.internal 1.pfx: 1\n"},{"result":{"nanos":262700,"millis":0.2627,"status":"passed"},"step":{"background":true,"line":6,"prefix":"*","index":1,"text":"def tokenData = tokenContext.tokenInfo"}},{"result":{"nanos":382700,"millis":0.3827,"status":"passed"},"step":{"background":true,"line":7,"prefix":"*","index":2,"text":"def transferenciaBaseUrl = karate.properties['transfer.baseUrl'] || 'https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral'"}},{"result":{"nanos":59300,"millis":0.0593,"status":"passed"},"step":{"background":true,"line":8,"prefix":"*","index":3,"text":"url transferenciaBaseUrl"}},{"result":{"nanos":347900,"millis":0.3479,"status":"passed"},"step":{"background":true,"line":9,"prefix":"*","index":4,"text":"def authHeaders = { 'Content-Type': 'application\/json' }"}},{"result":{"nanos":596900,"millis":0.5969,"status":"passed"},"step":{"background":true,"line":10,"prefix":"*","index":5,"text":"set authHeaders.Authorization = 'Bearer ' + tokenData.auth_tokencb"}},{"result":{"nanos":41100,"millis":0.0411,"status":"passed"},"step":{"background":true,"line":11,"prefix":"*","index":6,"text":"configure headers = authHeaders"}},{"result":{"nanos":188000,"millis":0.188,"status":"passed"},"step":{"endLine":24,"background":true,"line":12,"prefix":"*","docString":"{\n  \"0205\": {\n    \"CTA_AHORROS\": \"EC5002051000000000020501052673\",\n    \"CTA_CORRIENTE\": \"EC0402051000000000020101002318\"\n  },\n  \"0303\": {\n    \"CTA_AHORROS\": \"EC5003031000000000030301051111\",\n    \"CTA_CORRIENTE\": \"EC0403031000000000030101002222\"\n  }\n}","index":7,"text":"def accountCatalog ="}},{"result":{"nanos":163600,"millis":0.1636,"status":"passed"},"step":{"endLine":39,"background":true,"line":25,"prefix":"*","docString":"function(value){\n  var list;\n  if (!value && value !== 0){\n    list = [200];\n  } else {\n    list = Array.isArray(value) ? value.slice(0) : [value];\n  }\n  if (list.indexOf(200) === -1){\n    list.push(200);\n  }\n  return list;\n}","index":8,"text":"def normalizeStatus ="}},{"result":{"nanos":206500,"millis":0.2065,"status":"passed"},"step":{"endLine":110,"background":true,"line":40,"prefix":"*","docString":"function(overrides){\n  overrides = overrides || {};\n  var token = karate.get('tokenData');\n  var catalog = karate.get('accountCatalog');\n  var LocalDateTime = Java.type('java.time.LocalDateTime');\n  var DateTimeFormatter = Java.type('java.time.format.DateTimeFormatter');\n  var timestamp = LocalDateTime.now().format(DateTimeFormatter.ofPattern(\"yyyy-MM-dd'T'HH:mm:ss\"));\n  var randomDigits = function(length){\n    var digits = '';\n    for (var i = 0; i < length; i++){\n      digits += Math.floor(Math.random() * 10);\n    }\n    return digits;\n  };\n  var coopCode = overrides.instgAgtFinInstId || token.coop_codecb || '0205';\n  var debtorType = overrides.debtorAccountType || 'CTA_AHORROS';\n  var creditorType = overrides.creditorAccountType || 'CTA_CORRIENTE';\n  var creditorEntity = overrides.creditorEntity || overrides.instdAgtFinInstId || coopCode;\n  var debtorAccounts = catalog[coopCode] || catalog['0205'];\n  var creditorAccounts = catalog[creditorEntity] || catalog['0303'];\n  var debtorIban = overrides.debtorIban || (debtorAccounts ? (debtorAccounts[debtorType] || debtorAccounts['CTA_AHORROS']) : 'EC5002051000000000020501052673');\n  var creditorIban = overrides.creditorIban || (creditorAccounts ? (creditorAccounts[creditorType] || creditorAccounts['CTA_CORRIENTE']) : 'EC0403031000000000030101002222');\n  if (overrides.sameIban){\n    creditorIban = debtorIban;\n  }\n  var msgId = overrides.msgId || (coopCode + token.currentDate + randomDigits(11));\n  var endToEndId = overrides.endToEndId || (coopCode + token.currentDate + randomDigits(5));\n  var amountValue = overrides.amount != null ? overrides.amount : 1.00;\n  var payload = {\n    GrpHdr: {\n      msgId: msgId,\n      creDtTm: timestamp,\n      nbOfTxs: overrides.nbOfTxs || 1,\n      sttlmInf: { sttlmMtd: overrides.settlementMethod || 'INGA' },\n      instgAgt: { finInstnId: coopCode },\n      InstdAgt: { FinInstnId: overrides.instdAgtFinInstId || creditorEntity },\n      Mge: { Type: overrides.messageType || 'acmt.998.321.01' },\n      ChnlId: overrides.channel || 'APP'\n    },\n    CdtTrfTxInf: {\n      PmtId: { EndToEndId: endToEndId },\n      IntrBkSttlmAmt: { Amt: amountValue, Ccy: overrides.currency || 'USD' },\n      DbtrAcctId: { IBAN: debtorIban },\n      CdtrAcctId: { IBAN: creditorIban },\n      Prtry: {\n        CustRef: overrides.customerReference || 'QA22',\n        ChanRef: overrides.channelReference || (overrides.channel === 'QR' ? 'QRPANAPAY' : 'TERM001'),\n        AgtRef: overrides.agentReference || 'AGT0002'\n      }\n    }\n  };\n  if (overrides.prtryOverrides){\n    Object.keys(overrides.prtryOverrides).forEach(function(key){\n      payload.CdtTrfTxInf.Prtry[key] = overrides.prtryOverrides[key];\n    });\n  }\n  if (overrides.overrideHeaders){\n    payload.GrpHdr.instgAgt = overrides.overrideHeaders.instgAgt || payload.GrpHdr.instgAgt;\n    payload.GrpHdr.InstdAgt = overrides.overrideHeaders.instdAgt || payload.GrpHdr.InstdAgt;\n  }\n  return payload;\n}","index":9,"text":"def buildPayload ="}},{"result":{"nanos":197200,"millis":0.1972,"status":"passed"},"step":{"endLine":150,"background":true,"line":111,"prefix":"*","docString":"function(body, expectation){\n  expectation = expectation || {};\n  var txInfo = (body && body.CdtTrfTxInf) ? body.CdtTrfTxInf : {};\n  var outcome = expectation.outcome || 'success';\n  var requireTxOk = expectation.requireTxOk === true;\n  var requireTxReject = expectation.requireTxReject === true;\n  var expectedTxStatus = expectation.expectedTxStatus;\n  if (expectedTxStatus != null){\n    karate.match(txInfo.TxSts, expectedTxStatus);\n  } else if (outcome === 'success' && requireTxOk){\n    karate.match(txInfo.TxSts, 'Ok');\n  } else if (outcome === 'reject' && requireTxReject){\n    karate.match(txInfo.TxSts, '#? _ && _ != \"Ok\"');\n  } else {\n    if (txInfo && txInfo.TxSts){\n      karate.log('TxSts recibido:', txInfo.TxSts, '- no se valida estrictamente.');\n    } else {\n      karate.log('Sin TxSts en la respuesta, continuando sin validacion.');\n    }\n  }\n  if (outcome === 'pending'){\n    karate.match(txInfo.TxSts, '#? _ == \"PENDING\" || _ == \"PROC\"');\n  }\n  if (expectation.reasonCode){\n    var reasonNode = txInfo.Rsn || {};\n    karate.match(reasonNode.RsnCd, expectation.reasonCode);\n  }\n  if (expectation.expectedEndToEndId){\n    karate.match(txInfo.PmtId.EndToEndId, expectation.expectedEndToEndId);\n  }\n  if (expectation.expectedMsgId){\n    var grpHdr = (body && body.GrpHdr) ? body.GrpHdr : {};\n    karate.match(grpHdr.msgId, expectation.expectedMsgId);\n  }\n}","index":10,"text":"def verifyTransferOutcome ="}},{"result":{"nanos":2130200,"millis":2.1302,"status":"passed"},"step":{"endLine":156,"background":true,"line":151,"prefix":"*","docString":"function(name, payload, responseBody, status){\n  karate.log('[Transfer]', name, '| status:', status, '| msgId:', payload.GrpHdr.msgId, '| endToEnd:', payload.CdtTrfTxInf.PmtId.EndToEndId);\n}","index":11,"text":"def logTransferSummary ="}},{"result":{"nanos":1797700,"millis":1.7977,"status":"passed"},"step":{"line":379,"prefix":"*","index":0,"text":"eval karate.log('Preparar la cuenta ordenante en estado BLOQUEADO antes de la prueba.')"},"stepLog":"14:15:06.442 Preparar la cuenta ordenante en estado BLOQUEADO antes de la prueba. \n"},{"result":{"nanos":7319300,"millis":7.3193,"status":"passed"},"step":{"line":380,"prefix":"*","index":1,"text":"def payload = buildPayload({ debtorAccountType: 'CTA_AHORROS', prtryOverrides: { CustRef: 'LOCKED-ORD' } })"}},{"result":{"nanos":572600,"millis":0.5726,"status":"passed"},"step":{"line":381,"prefix":"*","index":2,"text":"def expectation = { httpStatus: [423, 409, 403], outcome: 'reject' }"}},{"result":{"nanos":1429200,"millis":1.4292,"status":"passed"},"step":{"line":382,"prefix":"*","index":3,"text":"def normalizedStatus = normalizeStatus(expectation.httpStatus)"}},{"result":{"nanos":182200,"millis":0.1822,"status":"passed"},"step":{"line":383,"prefix":"Given","index":4,"text":"path 'finan', 'transferencia'"}},{"result":{"nanos":62400,"millis":0.0624,"status":"passed"},"step":{"line":384,"prefix":"And","index":5,"text":"request payload"}},{"result":{"nanos":4153539500,"millis":4153.5395,"status":"passed"},"step":{"line":385,"prefix":"When","index":6,"text":"method post"},"stepLog":"14:15:06.456 request:\n1 > POST https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral\/finan\/transferencia\n1 > Content-Type: application\/json; charset=UTF-8\n1 > Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2dUJWTkN6VlViUFBlTFdReEM0WDAyYVM3UnM2UGRYV1dja1dfc0xZMHlFIn0.eyJleHAiOjE3NjExNjA3NTAsImlhdCI6MTc2MTE2MDQ1MCwianRpIjoidHJydGNjOjQ5Yjg0NDVjLTgzYTAtMjI4Ni02NDczLWE2ZGEzOTBhOWQ0YSIsImlzcyI6Imh0dHBzOi8vYXV0ZW50aWNhY2lvbnFhLmNvb25lY3RhLmNvbS5lYy9hdXRoL3JlYWxtcy9QQU5BUEFZIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6Ijk5OGMyZmUwLTJjOGYtNGQwNC1iZjExLWY1OWExZTM5ODg3MyIsInR5cCI6IkJlYXJlciIsImF6cCI6IjAyMDVjYiIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiLyoiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRlZmF1bHQtcm9sZXMtYWRtaW5wYW5hcGF5Iiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7IjAyMDVjYiI6eyJyb2xlcyI6WyJ1bWFfcHJvdGVjdGlvbiJdfSwiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJjbGllbnRIb3N0IjoiMTAuMTAuMTAuMTUxIiwicHJlZmVycmVkX3VzZXJuYW1lIjoic2VydmljZS1hY2NvdW50LTAyMDVjYiIsImNsaWVudEFkZHJlc3MiOiIxMC4xMC4xMC4xNTEiLCJjbGllbnRfaWQiOiIwMjA1Y2IifQ.bATUogohrEqy7Voa4mFnsBzOnGy6tnjZGh_lOYRn-0hWXMY_fz-280nTu2Vv68eO3HeoewtWlt45S_iLI2-ml3pqpAlt3DXWVmLvVHw6d7TICHBfQsa0jGXMexKnyar7EinrVhF3deSK25Ap_ajC_82EvVvXrVG-7p9F1dEdq39y2R72JympejF5uhY_z_jNmqJSsnLEZVOo3WMJn76u9tTcYVIldC5uWGFWbPGEhvWPx4ZGpsuq_wrPOGdRmyJDFJPJl7LnLGHK0DBhuVtJUq_NFQkMus2fTTf_mWhRnoqNU-wUCS-fxMs6QusGzIVd-C3O29J3rerHTrGg21LAsQ\n1 > Content-Length: 517\n1 > Host: apipanapayqa.coonecta.com.ec\n1 > Connection: Keep-Alive\n1 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/17.0.12)\n1 > Accept-Encoding: gzip,deflate\n{\"GrpHdr\":{\"msgId\":\"02052025102295333963656\",\"creDtTm\":\"2025-10-22T14:15:06\",\"nbOfTxs\":1,\"sttlmInf\":{\"sttlmMtd\":\"INGA\"},\"instgAgt\":{\"finInstnId\":\"0205\"},\"InstdAgt\":{\"FinInstnId\":\"0205\"},\"Mge\":{\"Type\":\"acmt.998.321.01\"},\"ChnlId\":\"APP\"},\"CdtTrfTxInf\":{\"PmtId\":{\"EndToEndId\":\"02052025102214975\"},\"IntrBkSttlmAmt\":{\"Amt\":1.0,\"Ccy\":\"USD\"},\"DbtrAcctId\":{\"IBAN\":\"EC5002051000000000020501052673\"},\"CdtrAcctId\":{\"IBAN\":\"EC0402051000000000020101002318\"},\"Prtry\":{\"CustRef\":\"LOCKED-ORD\",\"ChanRef\":\"TERM001\",\"AgtRef\":\"AGT0002\"}}}\n\n14:15:10.604 response time in milliseconds: 4048\n1 < 200\n1 < Date: Wed, 22 Oct 2025 19:15:01 GMT\n1 < Content-Type: application\/json; charset=utf-8\n1 < Transfer-Encoding: chunked\n1 < Connection: keep-alive\n1 < Server: Kestrel\n1 < Set-Cookie: ARRAffinity=135f536e0d078a815c3b83fda3468ab8a3a2abc604a35eefb28648d3961cfa9b;Path=\/;HttpOnly;Secure;Domain=app-apipanapay-qa.azurewebsites.net\n1 < Set-Cookie: ARRAffinitySameSite=135f536e0d078a815c3b83fda3468ab8a3a2abc604a35eefb28648d3961cfa9b;Path=\/;HttpOnly;SameSite=None;Secure;Domain=app-apipanapay-qa.azurewebsites.net\n1 < Vary: Accept-Encoding\n1 < Request-Context: appId=cid-v1:a7a77847-2713-450f-9030-b350a2d54a28\n1 < X-Powered-By: ASP.NET\n1 < X-ARR-ClientCert: -----BEGIN%20CERTIFICATE-----%0AMIIEHDCCAgSgAwIBAgIUZIZBO0fb7VZ4KXrs01S4RYbWyJ8wDQYJKoZIhvcNAQEL%0ABQAwJTEjMCEGA1UEAwwacm9vdGNlcnQuY2JpYmxpYW4uaW50ZXJuYWwwHhcNMjUw%0AODEzMTMyNTU5WhcNMjgwODEyMTMyNTU5WjAnMSUwIwYDVQQDDBxjbGllbnRjZXJ0%0ALmNiaWJsaWFuLmludGVybmFsMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKC%0AAQEAskUDap6NmyYq8RT6F7z3DpZGQiflNQTvUT84TmxsKXEBRAkgINnkJqgKkd7f%0ASEybzqglQTbr4s41lCiPsy3X66qYjU2L%2Bojhni%2BOCVOX7n3JBYovL%2FqfMP3%2FkhZP%0AQIlK%2FQWPcrnl39fYkGOQv%2BYqoCGEPzGkib2m1Ma5Q1HOCKh1ErMjqTLGy%2ByJj6JY%0AiZvMx3YrJSvjUS0uKpNwxPtGyiexRfKsmR%2FHqPzRHa0iY%2B752KSgUedwJPv1Wod%2B%0AY9BMAMIdU25UtkUEsaOYtorGWDaZSn2Bl0LYmP87kjcYypnHx0jtPtUCXfVHrE6u%0AZnDRFYsZbeXylY3mJkyOL2DzZwIDAQABo0IwQDAdBgNVHQ4EFgQURPhJwTAcUWUp%0ArOqQO68P%2FbJoqjMwHwYDVR0jBBgwFoAU7GdlxoSeEXucEXhjadHRC9xzS0UwDQYJ%0AKoZIhvcNAQELBQADggIBAGTnlyF2n%2F6s9phYbO8V17niO0BXB62ToX6gPhcw9f3y%0AhMui6RnrM1oiHlBWqZquCqYJ5ETvYJE1RqvoqtGysxCnIj0OTJHV4WtF3SHsd1Tu%0ATg%2B%2FUnGivtBTDQxj9sbAtCaSYRBqPByP8jvSTDgXR1mgOrEGjr2PZdZSoKLj4OHi%0A9UCMJw7pJsyA4lbroKshQTYv5Ks5SqtJpdp0%2BUX0UUlbPJqXiadfbKdoXvEgcwbP%0ACqR9v7kGYmNxfaGLNGVrV%2BnLawIDmdYXJE%2F4WJh6sHfiZxEsE%2BB4PoKADrb1Eapt%0AnSdHUgRfc0i5f2lcmErnU8nCMO5TWdHFOgpYwTS8w17FhNFZpaSmyZKM7uHcUs7y%0AUbuiQtdXocfSSMf%2FeycBEU%2FHAVIWQEqY%2BbJdC0q%2FR%2BsESeBtXd4IEIxR0QfgscGk%0AJyCSFC8z%2FvCgrRsH5rePqKO7%2FLAsDTP4GIQNFNfF4Wh6bsPXuJmvvoMcnmy%2F58Wo%0AE0XaG8UPHVAeyEmhncdM32E7SJbR91aRr2CkV23OoUz%2BwKG2%2FuObHmAkuMkCbbcz%0AJQoC7DZg5FGw%2BZR7v1DIBct5QNJQ8bG%2FXGRxjWC6dU7jrGhOF1X%2B2YYcdx9XnwyM%0A9YPxUy5bVfMhIiKP2wEso5fjOZ4RTvnB5R6zD3maJK%2FtZAXVhtyqXSkBYFi4MvEs%0A-----END%20CERTIFICATE-----%0A\n{\"GrpHdr\":{\"MsgId\":\"000020251022020372\",\"CreDtTm\":\"2025-10-22T14:15:00\",\"NbOfTxs\":1,\"SttlmInf\":{\"SttlmMtd\":\"INGA\"},\"InstgAgt\":{\"FinInstnId\":\"0205\"},\"InstdAgt\":{\"FinInstnId\":\"0205\"},\"Mge\":{\"Type\":\"acmt.998.322.001\"},\"ChnlId\":\"APP\"},\"CdtTrfTxInf\":{\"OrgnGrpInf\":{\"OrgnlMsgId\":\"02052025102295333963656\",\"OrgnlMgeType\":\"acmt.998.321.01\",\"OrgnlCreDtTm\":\"2025-10-22T14:15:06\"},\"PmtId\":{\"EndToEndId\":\"02052025102214975\",\"TxId\":\"18540\"},\"TxSts\":\"Ok\",\"Rsn\":{\"RsnCd\":\"0000\",\"AddtlInf\":\"Transacción Exitosa\"},\"Dbtr\":{\"AuthCode\":\"020520251022141501016931\"},\"Cdtr\":{\"AuthCode\":\"020520251022141501453772\"},\"SttlmDt\":\"2025-10-22\"}}\n\n"},{"result":{"nanos":0,"errorMessage":"no step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:386","millis":0.0,"status":"failed"},"step":{"line":386,"prefix":"Then","index":7,"text":"match responseStatus in normalizedStatus"},"stepLog":"14:15:10.605 classpath:Transferencia.feature:386\nThen match responseStatus in normalizedStatus\nno step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:386\n"},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":387,"prefix":"*","index":8,"text":"eval verifyTransferOutcome(response, expectation)"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":388,"prefix":"*","index":9,"text":"eval logTransferSummary('Ordenante bloqueado', payload, response, responseStatus)"}}],"line":378,"description":"","durationMillis":4172.7498,"failed":true,"error":"no step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:386","tags":["transferencia"],"executorName":"main","name":"Transferencia no exitosa, cuenta ordenante bloqueada en el directorio","startTime":1761160506420,"refId":"[19:378]","endTime":1761160510605,"exampleIndex":-1},{"sectionIndex":19,"stepResults":[{"result":{"nanos":3107600,"millis":3.1076,"status":"passed"},"step":{"background":true,"line":5,"prefix":"*","index":0,"text":"def tokenContext = callonce read('classpath:helpers\/generate-token.feature')"},"stepLog":"14:15:10.625 key store key count for classpath:certificado\/clientcert.cbiblian.internal 1.pfx: 1\n"},{"result":{"nanos":283900,"millis":0.2839,"status":"passed"},"step":{"background":true,"line":6,"prefix":"*","index":1,"text":"def tokenData = tokenContext.tokenInfo"}},{"result":{"nanos":331800,"millis":0.3318,"status":"passed"},"step":{"background":true,"line":7,"prefix":"*","index":2,"text":"def transferenciaBaseUrl = karate.properties['transfer.baseUrl'] || 'https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral'"}},{"result":{"nanos":110700,"millis":0.1107,"status":"passed"},"step":{"background":true,"line":8,"prefix":"*","index":3,"text":"url transferenciaBaseUrl"}},{"result":{"nanos":602800,"millis":0.6028,"status":"passed"},"step":{"background":true,"line":9,"prefix":"*","index":4,"text":"def authHeaders = { 'Content-Type': 'application\/json' }"}},{"result":{"nanos":1688300,"millis":1.6883,"status":"passed"},"step":{"background":true,"line":10,"prefix":"*","index":5,"text":"set authHeaders.Authorization = 'Bearer ' + tokenData.auth_tokencb"}},{"result":{"nanos":151400,"millis":0.1514,"status":"passed"},"step":{"background":true,"line":11,"prefix":"*","index":6,"text":"configure headers = authHeaders"}},{"result":{"nanos":277400,"millis":0.2774,"status":"passed"},"step":{"endLine":24,"background":true,"line":12,"prefix":"*","docString":"{\n  \"0205\": {\n    \"CTA_AHORROS\": \"EC5002051000000000020501052673\",\n    \"CTA_CORRIENTE\": \"EC0402051000000000020101002318\"\n  },\n  \"0303\": {\n    \"CTA_AHORROS\": \"EC5003031000000000030301051111\",\n    \"CTA_CORRIENTE\": \"EC0403031000000000030101002222\"\n  }\n}","index":7,"text":"def accountCatalog ="}},{"result":{"nanos":884200,"millis":0.8842,"status":"passed"},"step":{"endLine":39,"background":true,"line":25,"prefix":"*","docString":"function(value){\n  var list;\n  if (!value && value !== 0){\n    list = [200];\n  } else {\n    list = Array.isArray(value) ? value.slice(0) : [value];\n  }\n  if (list.indexOf(200) === -1){\n    list.push(200);\n  }\n  return list;\n}","index":8,"text":"def normalizeStatus ="}},{"result":{"nanos":572400,"millis":0.5724,"status":"passed"},"step":{"endLine":110,"background":true,"line":40,"prefix":"*","docString":"function(overrides){\n  overrides = overrides || {};\n  var token = karate.get('tokenData');\n  var catalog = karate.get('accountCatalog');\n  var LocalDateTime = Java.type('java.time.LocalDateTime');\n  var DateTimeFormatter = Java.type('java.time.format.DateTimeFormatter');\n  var timestamp = LocalDateTime.now().format(DateTimeFormatter.ofPattern(\"yyyy-MM-dd'T'HH:mm:ss\"));\n  var randomDigits = function(length){\n    var digits = '';\n    for (var i = 0; i < length; i++){\n      digits += Math.floor(Math.random() * 10);\n    }\n    return digits;\n  };\n  var coopCode = overrides.instgAgtFinInstId || token.coop_codecb || '0205';\n  var debtorType = overrides.debtorAccountType || 'CTA_AHORROS';\n  var creditorType = overrides.creditorAccountType || 'CTA_CORRIENTE';\n  var creditorEntity = overrides.creditorEntity || overrides.instdAgtFinInstId || coopCode;\n  var debtorAccounts = catalog[coopCode] || catalog['0205'];\n  var creditorAccounts = catalog[creditorEntity] || catalog['0303'];\n  var debtorIban = overrides.debtorIban || (debtorAccounts ? (debtorAccounts[debtorType] || debtorAccounts['CTA_AHORROS']) : 'EC5002051000000000020501052673');\n  var creditorIban = overrides.creditorIban || (creditorAccounts ? (creditorAccounts[creditorType] || creditorAccounts['CTA_CORRIENTE']) : 'EC0403031000000000030101002222');\n  if (overrides.sameIban){\n    creditorIban = debtorIban;\n  }\n  var msgId = overrides.msgId || (coopCode + token.currentDate + randomDigits(11));\n  var endToEndId = overrides.endToEndId || (coopCode + token.currentDate + randomDigits(5));\n  var amountValue = overrides.amount != null ? overrides.amount : 1.00;\n  var payload = {\n    GrpHdr: {\n      msgId: msgId,\n      creDtTm: timestamp,\n      nbOfTxs: overrides.nbOfTxs || 1,\n      sttlmInf: { sttlmMtd: overrides.settlementMethod || 'INGA' },\n      instgAgt: { finInstnId: coopCode },\n      InstdAgt: { FinInstnId: overrides.instdAgtFinInstId || creditorEntity },\n      Mge: { Type: overrides.messageType || 'acmt.998.321.01' },\n      ChnlId: overrides.channel || 'APP'\n    },\n    CdtTrfTxInf: {\n      PmtId: { EndToEndId: endToEndId },\n      IntrBkSttlmAmt: { Amt: amountValue, Ccy: overrides.currency || 'USD' },\n      DbtrAcctId: { IBAN: debtorIban },\n      CdtrAcctId: { IBAN: creditorIban },\n      Prtry: {\n        CustRef: overrides.customerReference || 'QA22',\n        ChanRef: overrides.channelReference || (overrides.channel === 'QR' ? 'QRPANAPAY' : 'TERM001'),\n        AgtRef: overrides.agentReference || 'AGT0002'\n      }\n    }\n  };\n  if (overrides.prtryOverrides){\n    Object.keys(overrides.prtryOverrides).forEach(function(key){\n      payload.CdtTrfTxInf.Prtry[key] = overrides.prtryOverrides[key];\n    });\n  }\n  if (overrides.overrideHeaders){\n    payload.GrpHdr.instgAgt = overrides.overrideHeaders.instgAgt || payload.GrpHdr.instgAgt;\n    payload.GrpHdr.InstdAgt = overrides.overrideHeaders.instdAgt || payload.GrpHdr.InstdAgt;\n  }\n  return payload;\n}","index":9,"text":"def buildPayload ="}},{"result":{"nanos":362000,"millis":0.362,"status":"passed"},"step":{"endLine":150,"background":true,"line":111,"prefix":"*","docString":"function(body, expectation){\n  expectation = expectation || {};\n  var txInfo = (body && body.CdtTrfTxInf) ? body.CdtTrfTxInf : {};\n  var outcome = expectation.outcome || 'success';\n  var requireTxOk = expectation.requireTxOk === true;\n  var requireTxReject = expectation.requireTxReject === true;\n  var expectedTxStatus = expectation.expectedTxStatus;\n  if (expectedTxStatus != null){\n    karate.match(txInfo.TxSts, expectedTxStatus);\n  } else if (outcome === 'success' && requireTxOk){\n    karate.match(txInfo.TxSts, 'Ok');\n  } else if (outcome === 'reject' && requireTxReject){\n    karate.match(txInfo.TxSts, '#? _ && _ != \"Ok\"');\n  } else {\n    if (txInfo && txInfo.TxSts){\n      karate.log('TxSts recibido:', txInfo.TxSts, '- no se valida estrictamente.');\n    } else {\n      karate.log('Sin TxSts en la respuesta, continuando sin validacion.');\n    }\n  }\n  if (outcome === 'pending'){\n    karate.match(txInfo.TxSts, '#? _ == \"PENDING\" || _ == \"PROC\"');\n  }\n  if (expectation.reasonCode){\n    var reasonNode = txInfo.Rsn || {};\n    karate.match(reasonNode.RsnCd, expectation.reasonCode);\n  }\n  if (expectation.expectedEndToEndId){\n    karate.match(txInfo.PmtId.EndToEndId, expectation.expectedEndToEndId);\n  }\n  if (expectation.expectedMsgId){\n    var grpHdr = (body && body.GrpHdr) ? body.GrpHdr : {};\n    karate.match(grpHdr.msgId, expectation.expectedMsgId);\n  }\n}","index":10,"text":"def verifyTransferOutcome ="}},{"result":{"nanos":199800,"millis":0.1998,"status":"passed"},"step":{"endLine":156,"background":true,"line":151,"prefix":"*","docString":"function(name, payload, responseBody, status){\n  karate.log('[Transfer]', name, '| status:', status, '| msgId:', payload.GrpHdr.msgId, '| endToEnd:', payload.CdtTrfTxInf.PmtId.EndToEndId);\n}","index":11,"text":"def logTransferSummary ="}},{"result":{"nanos":2083600,"millis":2.0836,"status":"passed"},"step":{"line":391,"prefix":"*","index":0,"text":"eval karate.log('Asegurar que la cuenta ordenante esta DESBLOQUEADA antes de la prueba.')"},"stepLog":"14:15:10.638 Asegurar que la cuenta ordenante esta DESBLOQUEADA antes de la prueba. \n"},{"result":{"nanos":6864600,"millis":6.8646,"status":"passed"},"step":{"line":392,"prefix":"*","index":1,"text":"def payload = buildPayload({ debtorAccountType: 'CTA_AHORROS', prtryOverrides: { CustRef: 'UNLOCK-ORD' } })"}},{"result":{"nanos":417400,"millis":0.4174,"status":"passed"},"step":{"line":393,"prefix":"*","index":2,"text":"def expectation = { httpStatus: 200, outcome: 'success', expectedEndToEndId: payload.CdtTrfTxInf.PmtId.EndToEndId }"}},{"result":{"nanos":599000,"millis":0.599,"status":"passed"},"step":{"line":394,"prefix":"*","index":3,"text":"def normalizedStatus = normalizeStatus(expectation.httpStatus)"}},{"result":{"nanos":170500,"millis":0.1705,"status":"passed"},"step":{"line":395,"prefix":"Given","index":4,"text":"path 'finan', 'transferencia'"}},{"result":{"nanos":58800,"millis":0.0588,"status":"passed"},"step":{"line":396,"prefix":"And","index":5,"text":"request payload"}},{"result":{"nanos":4759017100,"millis":4759.0171,"status":"passed"},"step":{"line":397,"prefix":"When","index":6,"text":"method post"},"stepLog":"14:15:10.653 request:\n1 > POST https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral\/finan\/transferencia\n1 > Content-Type: application\/json; charset=UTF-8\n1 > Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2dUJWTkN6VlViUFBlTFdReEM0WDAyYVM3UnM2UGRYV1dja1dfc0xZMHlFIn0.eyJleHAiOjE3NjExNjA3NTAsImlhdCI6MTc2MTE2MDQ1MCwianRpIjoidHJydGNjOjQ5Yjg0NDVjLTgzYTAtMjI4Ni02NDczLWE2ZGEzOTBhOWQ0YSIsImlzcyI6Imh0dHBzOi8vYXV0ZW50aWNhY2lvbnFhLmNvb25lY3RhLmNvbS5lYy9hdXRoL3JlYWxtcy9QQU5BUEFZIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6Ijk5OGMyZmUwLTJjOGYtNGQwNC1iZjExLWY1OWExZTM5ODg3MyIsInR5cCI6IkJlYXJlciIsImF6cCI6IjAyMDVjYiIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiLyoiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRlZmF1bHQtcm9sZXMtYWRtaW5wYW5hcGF5Iiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7IjAyMDVjYiI6eyJyb2xlcyI6WyJ1bWFfcHJvdGVjdGlvbiJdfSwiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJjbGllbnRIb3N0IjoiMTAuMTAuMTAuMTUxIiwicHJlZmVycmVkX3VzZXJuYW1lIjoic2VydmljZS1hY2NvdW50LTAyMDVjYiIsImNsaWVudEFkZHJlc3MiOiIxMC4xMC4xMC4xNTEiLCJjbGllbnRfaWQiOiIwMjA1Y2IifQ.bATUogohrEqy7Voa4mFnsBzOnGy6tnjZGh_lOYRn-0hWXMY_fz-280nTu2Vv68eO3HeoewtWlt45S_iLI2-ml3pqpAlt3DXWVmLvVHw6d7TICHBfQsa0jGXMexKnyar7EinrVhF3deSK25Ap_ajC_82EvVvXrVG-7p9F1dEdq39y2R72JympejF5uhY_z_jNmqJSsnLEZVOo3WMJn76u9tTcYVIldC5uWGFWbPGEhvWPx4ZGpsuq_wrPOGdRmyJDFJPJl7LnLGHK0DBhuVtJUq_NFQkMus2fTTf_mWhRnoqNU-wUCS-fxMs6QusGzIVd-C3O29J3rerHTrGg21LAsQ\n1 > Content-Length: 517\n1 > Host: apipanapayqa.coonecta.com.ec\n1 > Connection: Keep-Alive\n1 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/17.0.12)\n1 > Accept-Encoding: gzip,deflate\n{\"GrpHdr\":{\"msgId\":\"02052025102215092595510\",\"creDtTm\":\"2025-10-22T14:15:10\",\"nbOfTxs\":1,\"sttlmInf\":{\"sttlmMtd\":\"INGA\"},\"instgAgt\":{\"finInstnId\":\"0205\"},\"InstdAgt\":{\"FinInstnId\":\"0205\"},\"Mge\":{\"Type\":\"acmt.998.321.01\"},\"ChnlId\":\"APP\"},\"CdtTrfTxInf\":{\"PmtId\":{\"EndToEndId\":\"02052025102238936\"},\"IntrBkSttlmAmt\":{\"Amt\":1.0,\"Ccy\":\"USD\"},\"DbtrAcctId\":{\"IBAN\":\"EC5002051000000000020501052673\"},\"CdtrAcctId\":{\"IBAN\":\"EC0402051000000000020101002318\"},\"Prtry\":{\"CustRef\":\"UNLOCK-ORD\",\"ChanRef\":\"TERM001\",\"AgtRef\":\"AGT0002\"}}}\n\n14:15:15.405 response time in milliseconds: 4664\n1 < 200\n1 < Date: Wed, 22 Oct 2025 19:15:07 GMT\n1 < Content-Type: application\/json; charset=utf-8\n1 < Transfer-Encoding: chunked\n1 < Connection: keep-alive\n1 < Server: Kestrel\n1 < Set-Cookie: ARRAffinity=135f536e0d078a815c3b83fda3468ab8a3a2abc604a35eefb28648d3961cfa9b;Path=\/;HttpOnly;Secure;Domain=app-apipanapay-qa.azurewebsites.net\n1 < Set-Cookie: ARRAffinitySameSite=135f536e0d078a815c3b83fda3468ab8a3a2abc604a35eefb28648d3961cfa9b;Path=\/;HttpOnly;SameSite=None;Secure;Domain=app-apipanapay-qa.azurewebsites.net\n1 < Vary: Accept-Encoding\n1 < Request-Context: appId=cid-v1:a7a77847-2713-450f-9030-b350a2d54a28\n1 < X-Powered-By: ASP.NET\n1 < X-ARR-ClientCert: -----BEGIN%20CERTIFICATE-----%0AMIIEHDCCAgSgAwIBAgIUZIZBO0fb7VZ4KXrs01S4RYbWyJ8wDQYJKoZIhvcNAQEL%0ABQAwJTEjMCEGA1UEAwwacm9vdGNlcnQuY2JpYmxpYW4uaW50ZXJuYWwwHhcNMjUw%0AODEzMTMyNTU5WhcNMjgwODEyMTMyNTU5WjAnMSUwIwYDVQQDDBxjbGllbnRjZXJ0%0ALmNiaWJsaWFuLmludGVybmFsMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKC%0AAQEAskUDap6NmyYq8RT6F7z3DpZGQiflNQTvUT84TmxsKXEBRAkgINnkJqgKkd7f%0ASEybzqglQTbr4s41lCiPsy3X66qYjU2L%2Bojhni%2BOCVOX7n3JBYovL%2FqfMP3%2FkhZP%0AQIlK%2FQWPcrnl39fYkGOQv%2BYqoCGEPzGkib2m1Ma5Q1HOCKh1ErMjqTLGy%2ByJj6JY%0AiZvMx3YrJSvjUS0uKpNwxPtGyiexRfKsmR%2FHqPzRHa0iY%2B752KSgUedwJPv1Wod%2B%0AY9BMAMIdU25UtkUEsaOYtorGWDaZSn2Bl0LYmP87kjcYypnHx0jtPtUCXfVHrE6u%0AZnDRFYsZbeXylY3mJkyOL2DzZwIDAQABo0IwQDAdBgNVHQ4EFgQURPhJwTAcUWUp%0ArOqQO68P%2FbJoqjMwHwYDVR0jBBgwFoAU7GdlxoSeEXucEXhjadHRC9xzS0UwDQYJ%0AKoZIhvcNAQELBQADggIBAGTnlyF2n%2F6s9phYbO8V17niO0BXB62ToX6gPhcw9f3y%0AhMui6RnrM1oiHlBWqZquCqYJ5ETvYJE1RqvoqtGysxCnIj0OTJHV4WtF3SHsd1Tu%0ATg%2B%2FUnGivtBTDQxj9sbAtCaSYRBqPByP8jvSTDgXR1mgOrEGjr2PZdZSoKLj4OHi%0A9UCMJw7pJsyA4lbroKshQTYv5Ks5SqtJpdp0%2BUX0UUlbPJqXiadfbKdoXvEgcwbP%0ACqR9v7kGYmNxfaGLNGVrV%2BnLawIDmdYXJE%2F4WJh6sHfiZxEsE%2BB4PoKADrb1Eapt%0AnSdHUgRfc0i5f2lcmErnU8nCMO5TWdHFOgpYwTS8w17FhNFZpaSmyZKM7uHcUs7y%0AUbuiQtdXocfSSMf%2FeycBEU%2FHAVIWQEqY%2BbJdC0q%2FR%2BsESeBtXd4IEIxR0QfgscGk%0AJyCSFC8z%2FvCgrRsH5rePqKO7%2FLAsDTP4GIQNFNfF4Wh6bsPXuJmvvoMcnmy%2F58Wo%0AE0XaG8UPHVAeyEmhncdM32E7SJbR91aRr2CkV23OoUz%2BwKG2%2FuObHmAkuMkCbbcz%0AJQoC7DZg5FGw%2BZR7v1DIBct5QNJQ8bG%2FXGRxjWC6dU7jrGhOF1X%2B2YYcdx9XnwyM%0A9YPxUy5bVfMhIiKP2wEso5fjOZ4RTvnB5R6zD3maJK%2FtZAXVhtyqXSkBYFi4MvEs%0A-----END%20CERTIFICATE-----%0A\n{\"GrpHdr\":{\"MsgId\":\"000020251022020373\",\"CreDtTm\":\"2025-10-22T14:15:04\",\"NbOfTxs\":1,\"SttlmInf\":{\"SttlmMtd\":\"INGA\"},\"InstgAgt\":{\"FinInstnId\":\"0205\"},\"InstdAgt\":{\"FinInstnId\":\"0205\"},\"Mge\":{\"Type\":\"acmt.998.322.001\"},\"ChnlId\":\"APP\"},\"CdtTrfTxInf\":{\"OrgnGrpInf\":{\"OrgnlMsgId\":\"02052025102215092595510\",\"OrgnlMgeType\":\"acmt.998.321.01\",\"OrgnlCreDtTm\":\"2025-10-22T14:15:10\"},\"PmtId\":{\"EndToEndId\":\"02052025102238936\",\"TxId\":\"18541\"},\"TxSts\":\"Ok\",\"Rsn\":{\"RsnCd\":\"0000\",\"AddtlInf\":\"Transacción Exitosa\"},\"Dbtr\":{\"AuthCode\":\"020520251022141506141419\"},\"Cdtr\":{\"AuthCode\":\"020520251022141506610434\"},\"SttlmDt\":\"2025-10-22\"}}\n\n"},{"result":{"nanos":0,"errorMessage":"no step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:398","millis":0.0,"status":"failed"},"step":{"line":398,"prefix":"Then","index":7,"text":"match responseStatus in normalizedStatus"},"stepLog":"14:15:15.405 classpath:Transferencia.feature:398\nThen match responseStatus in normalizedStatus\nno step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:398\n"},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":399,"prefix":"*","index":8,"text":"eval verifyTransferOutcome(response, expectation)"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":400,"prefix":"*","index":9,"text":"eval logTransferSummary('Ordenante desbloqueado', payload, response, responseStatus)"}}],"line":390,"description":"","durationMillis":4777.7833,"failed":true,"error":"no step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:398","tags":["transferencia"],"executorName":"main","name":"Transferencia exitosa, cuenta ordenante desbloqueada en el directorio","startTime":1761160510619,"refId":"[20:390]","endTime":1761160515405,"exampleIndex":-1},{"sectionIndex":20,"stepResults":[{"result":{"nanos":4260600,"millis":4.2606,"status":"passed"},"step":{"background":true,"line":5,"prefix":"*","index":0,"text":"def tokenContext = callonce read('classpath:helpers\/generate-token.feature')"},"stepLog":"14:15:15.430 key store key count for classpath:certificado\/clientcert.cbiblian.internal 1.pfx: 1\n"},{"result":{"nanos":308900,"millis":0.3089,"status":"passed"},"step":{"background":true,"line":6,"prefix":"*","index":1,"text":"def tokenData = tokenContext.tokenInfo"}},{"result":{"nanos":523000,"millis":0.523,"status":"passed"},"step":{"background":true,"line":7,"prefix":"*","index":2,"text":"def transferenciaBaseUrl = karate.properties['transfer.baseUrl'] || 'https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral'"}},{"result":{"nanos":68100,"millis":0.0681,"status":"passed"},"step":{"background":true,"line":8,"prefix":"*","index":3,"text":"url transferenciaBaseUrl"}},{"result":{"nanos":339700,"millis":0.3397,"status":"passed"},"step":{"background":true,"line":9,"prefix":"*","index":4,"text":"def authHeaders = { 'Content-Type': 'application\/json' }"}},{"result":{"nanos":1069200,"millis":1.0692,"status":"passed"},"step":{"background":true,"line":10,"prefix":"*","index":5,"text":"set authHeaders.Authorization = 'Bearer ' + tokenData.auth_tokencb"}},{"result":{"nanos":70800,"millis":0.0708,"status":"passed"},"step":{"background":true,"line":11,"prefix":"*","index":6,"text":"configure headers = authHeaders"}},{"result":{"nanos":189000,"millis":0.189,"status":"passed"},"step":{"endLine":24,"background":true,"line":12,"prefix":"*","docString":"{\n  \"0205\": {\n    \"CTA_AHORROS\": \"EC5002051000000000020501052673\",\n    \"CTA_CORRIENTE\": \"EC0402051000000000020101002318\"\n  },\n  \"0303\": {\n    \"CTA_AHORROS\": \"EC5003031000000000030301051111\",\n    \"CTA_CORRIENTE\": \"EC0403031000000000030101002222\"\n  }\n}","index":7,"text":"def accountCatalog ="}},{"result":{"nanos":221100,"millis":0.2211,"status":"passed"},"step":{"endLine":39,"background":true,"line":25,"prefix":"*","docString":"function(value){\n  var list;\n  if (!value && value !== 0){\n    list = [200];\n  } else {\n    list = Array.isArray(value) ? value.slice(0) : [value];\n  }\n  if (list.indexOf(200) === -1){\n    list.push(200);\n  }\n  return list;\n}","index":8,"text":"def normalizeStatus ="}},{"result":{"nanos":227300,"millis":0.2273,"status":"passed"},"step":{"endLine":110,"background":true,"line":40,"prefix":"*","docString":"function(overrides){\n  overrides = overrides || {};\n  var token = karate.get('tokenData');\n  var catalog = karate.get('accountCatalog');\n  var LocalDateTime = Java.type('java.time.LocalDateTime');\n  var DateTimeFormatter = Java.type('java.time.format.DateTimeFormatter');\n  var timestamp = LocalDateTime.now().format(DateTimeFormatter.ofPattern(\"yyyy-MM-dd'T'HH:mm:ss\"));\n  var randomDigits = function(length){\n    var digits = '';\n    for (var i = 0; i < length; i++){\n      digits += Math.floor(Math.random() * 10);\n    }\n    return digits;\n  };\n  var coopCode = overrides.instgAgtFinInstId || token.coop_codecb || '0205';\n  var debtorType = overrides.debtorAccountType || 'CTA_AHORROS';\n  var creditorType = overrides.creditorAccountType || 'CTA_CORRIENTE';\n  var creditorEntity = overrides.creditorEntity || overrides.instdAgtFinInstId || coopCode;\n  var debtorAccounts = catalog[coopCode] || catalog['0205'];\n  var creditorAccounts = catalog[creditorEntity] || catalog['0303'];\n  var debtorIban = overrides.debtorIban || (debtorAccounts ? (debtorAccounts[debtorType] || debtorAccounts['CTA_AHORROS']) : 'EC5002051000000000020501052673');\n  var creditorIban = overrides.creditorIban || (creditorAccounts ? (creditorAccounts[creditorType] || creditorAccounts['CTA_CORRIENTE']) : 'EC0403031000000000030101002222');\n  if (overrides.sameIban){\n    creditorIban = debtorIban;\n  }\n  var msgId = overrides.msgId || (coopCode + token.currentDate + randomDigits(11));\n  var endToEndId = overrides.endToEndId || (coopCode + token.currentDate + randomDigits(5));\n  var amountValue = overrides.amount != null ? overrides.amount : 1.00;\n  var payload = {\n    GrpHdr: {\n      msgId: msgId,\n      creDtTm: timestamp,\n      nbOfTxs: overrides.nbOfTxs || 1,\n      sttlmInf: { sttlmMtd: overrides.settlementMethod || 'INGA' },\n      instgAgt: { finInstnId: coopCode },\n      InstdAgt: { FinInstnId: overrides.instdAgtFinInstId || creditorEntity },\n      Mge: { Type: overrides.messageType || 'acmt.998.321.01' },\n      ChnlId: overrides.channel || 'APP'\n    },\n    CdtTrfTxInf: {\n      PmtId: { EndToEndId: endToEndId },\n      IntrBkSttlmAmt: { Amt: amountValue, Ccy: overrides.currency || 'USD' },\n      DbtrAcctId: { IBAN: debtorIban },\n      CdtrAcctId: { IBAN: creditorIban },\n      Prtry: {\n        CustRef: overrides.customerReference || 'QA22',\n        ChanRef: overrides.channelReference || (overrides.channel === 'QR' ? 'QRPANAPAY' : 'TERM001'),\n        AgtRef: overrides.agentReference || 'AGT0002'\n      }\n    }\n  };\n  if (overrides.prtryOverrides){\n    Object.keys(overrides.prtryOverrides).forEach(function(key){\n      payload.CdtTrfTxInf.Prtry[key] = overrides.prtryOverrides[key];\n    });\n  }\n  if (overrides.overrideHeaders){\n    payload.GrpHdr.instgAgt = overrides.overrideHeaders.instgAgt || payload.GrpHdr.instgAgt;\n    payload.GrpHdr.InstdAgt = overrides.overrideHeaders.instdAgt || payload.GrpHdr.InstdAgt;\n  }\n  return payload;\n}","index":9,"text":"def buildPayload ="}},{"result":{"nanos":152300,"millis":0.1523,"status":"passed"},"step":{"endLine":150,"background":true,"line":111,"prefix":"*","docString":"function(body, expectation){\n  expectation = expectation || {};\n  var txInfo = (body && body.CdtTrfTxInf) ? body.CdtTrfTxInf : {};\n  var outcome = expectation.outcome || 'success';\n  var requireTxOk = expectation.requireTxOk === true;\n  var requireTxReject = expectation.requireTxReject === true;\n  var expectedTxStatus = expectation.expectedTxStatus;\n  if (expectedTxStatus != null){\n    karate.match(txInfo.TxSts, expectedTxStatus);\n  } else if (outcome === 'success' && requireTxOk){\n    karate.match(txInfo.TxSts, 'Ok');\n  } else if (outcome === 'reject' && requireTxReject){\n    karate.match(txInfo.TxSts, '#? _ && _ != \"Ok\"');\n  } else {\n    if (txInfo && txInfo.TxSts){\n      karate.log('TxSts recibido:', txInfo.TxSts, '- no se valida estrictamente.');\n    } else {\n      karate.log('Sin TxSts en la respuesta, continuando sin validacion.');\n    }\n  }\n  if (outcome === 'pending'){\n    karate.match(txInfo.TxSts, '#? _ == \"PENDING\" || _ == \"PROC\"');\n  }\n  if (expectation.reasonCode){\n    var reasonNode = txInfo.Rsn || {};\n    karate.match(reasonNode.RsnCd, expectation.reasonCode);\n  }\n  if (expectation.expectedEndToEndId){\n    karate.match(txInfo.PmtId.EndToEndId, expectation.expectedEndToEndId);\n  }\n  if (expectation.expectedMsgId){\n    var grpHdr = (body && body.GrpHdr) ? body.GrpHdr : {};\n    karate.match(grpHdr.msgId, expectation.expectedMsgId);\n  }\n}","index":10,"text":"def verifyTransferOutcome ="}},{"result":{"nanos":101900,"millis":0.1019,"status":"passed"},"step":{"endLine":156,"background":true,"line":151,"prefix":"*","docString":"function(name, payload, responseBody, status){\n  karate.log('[Transfer]', name, '| status:', status, '| msgId:', payload.GrpHdr.msgId, '| endToEnd:', payload.CdtTrfTxInf.PmtId.EndToEndId);\n}","index":11,"text":"def logTransferSummary ="}},{"result":{"nanos":1332900,"millis":1.3329,"status":"passed"},"step":{"line":403,"prefix":"*","index":0,"text":"eval karate.log('Configurar la cuenta receptora como DESAFILIADA antes de la prueba.')"},"stepLog":"14:15:15.441 Configurar la cuenta receptora como DESAFILIADA antes de la prueba. \n"},{"result":{"nanos":6293600,"millis":6.2936,"status":"passed"},"step":{"line":404,"prefix":"*","index":1,"text":"def payload = buildPayload({ channel: 'QR', creditorAccountType: 'CTA_CORRIENTE', prtryOverrides: { CustRef: 'QR-DESAF', ChanRef: 'QR-DESA' } })"}},{"result":{"nanos":590200,"millis":0.5902,"status":"passed"},"step":{"line":405,"prefix":"*","index":2,"text":"def expectation = { httpStatus: [404, 409, 403], outcome: 'reject' }"}},{"result":{"nanos":1288800,"millis":1.2888,"status":"passed"},"step":{"line":406,"prefix":"*","index":3,"text":"def normalizedStatus = normalizeStatus(expectation.httpStatus)"}},{"result":{"nanos":249300,"millis":0.2493,"status":"passed"},"step":{"line":407,"prefix":"Given","index":4,"text":"path 'finan', 'transferencia'"}},{"result":{"nanos":68200,"millis":0.0682,"status":"passed"},"step":{"line":408,"prefix":"And","index":5,"text":"request payload"}},{"result":{"nanos":1935291600,"millis":1935.2916,"status":"passed"},"step":{"line":409,"prefix":"When","index":6,"text":"method post"},"stepLog":"14:15:15.454 request:\n1 > POST https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral\/finan\/transferencia\n1 > Content-Type: application\/json; charset=UTF-8\n1 > Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2dUJWTkN6VlViUFBlTFdReEM0WDAyYVM3UnM2UGRYV1dja1dfc0xZMHlFIn0.eyJleHAiOjE3NjExNjA3NTAsImlhdCI6MTc2MTE2MDQ1MCwianRpIjoidHJydGNjOjQ5Yjg0NDVjLTgzYTAtMjI4Ni02NDczLWE2ZGEzOTBhOWQ0YSIsImlzcyI6Imh0dHBzOi8vYXV0ZW50aWNhY2lvbnFhLmNvb25lY3RhLmNvbS5lYy9hdXRoL3JlYWxtcy9QQU5BUEFZIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6Ijk5OGMyZmUwLTJjOGYtNGQwNC1iZjExLWY1OWExZTM5ODg3MyIsInR5cCI6IkJlYXJlciIsImF6cCI6IjAyMDVjYiIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiLyoiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRlZmF1bHQtcm9sZXMtYWRtaW5wYW5hcGF5Iiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7IjAyMDVjYiI6eyJyb2xlcyI6WyJ1bWFfcHJvdGVjdGlvbiJdfSwiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJjbGllbnRIb3N0IjoiMTAuMTAuMTAuMTUxIiwicHJlZmVycmVkX3VzZXJuYW1lIjoic2VydmljZS1hY2NvdW50LTAyMDVjYiIsImNsaWVudEFkZHJlc3MiOiIxMC4xMC4xMC4xNTEiLCJjbGllbnRfaWQiOiIwMjA1Y2IifQ.bATUogohrEqy7Voa4mFnsBzOnGy6tnjZGh_lOYRn-0hWXMY_fz-280nTu2Vv68eO3HeoewtWlt45S_iLI2-ml3pqpAlt3DXWVmLvVHw6d7TICHBfQsa0jGXMexKnyar7EinrVhF3deSK25Ap_ajC_82EvVvXrVG-7p9F1dEdq39y2R72JympejF5uhY_z_jNmqJSsnLEZVOo3WMJn76u9tTcYVIldC5uWGFWbPGEhvWPx4ZGpsuq_wrPOGdRmyJDFJPJl7LnLGHK0DBhuVtJUq_NFQkMus2fTTf_mWhRnoqNU-wUCS-fxMs6QusGzIVd-C3O29J3rerHTrGg21LAsQ\n1 > Content-Length: 514\n1 > Host: apipanapayqa.coonecta.com.ec\n1 > Connection: Keep-Alive\n1 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/17.0.12)\n1 > Accept-Encoding: gzip,deflate\n{\"GrpHdr\":{\"msgId\":\"02052025102282355753137\",\"creDtTm\":\"2025-10-22T14:15:15\",\"nbOfTxs\":1,\"sttlmInf\":{\"sttlmMtd\":\"INGA\"},\"instgAgt\":{\"finInstnId\":\"0205\"},\"InstdAgt\":{\"FinInstnId\":\"0205\"},\"Mge\":{\"Type\":\"acmt.998.321.01\"},\"ChnlId\":\"QR\"},\"CdtTrfTxInf\":{\"PmtId\":{\"EndToEndId\":\"02052025102271721\"},\"IntrBkSttlmAmt\":{\"Amt\":1.0,\"Ccy\":\"USD\"},\"DbtrAcctId\":{\"IBAN\":\"EC5002051000000000020501052673\"},\"CdtrAcctId\":{\"IBAN\":\"EC0402051000000000020101002318\"},\"Prtry\":{\"CustRef\":\"QR-DESAF\",\"ChanRef\":\"QR-DESA\",\"AgtRef\":\"AGT0002\"}}}\n\n14:15:17.385 response time in milliseconds: 1928\n1 < 400\n1 < Date: Wed, 22 Oct 2025 19:15:08 GMT\n1 < Content-Type: application\/json; charset=utf-8\n1 < Transfer-Encoding: chunked\n1 < Connection: keep-alive\n1 < Server: Kestrel\n1 < Set-Cookie: ARRAffinity=135f536e0d078a815c3b83fda3468ab8a3a2abc604a35eefb28648d3961cfa9b;Path=\/;HttpOnly;Secure;Domain=app-apipanapay-qa.azurewebsites.net\n1 < Set-Cookie: ARRAffinitySameSite=135f536e0d078a815c3b83fda3468ab8a3a2abc604a35eefb28648d3961cfa9b;Path=\/;HttpOnly;SameSite=None;Secure;Domain=app-apipanapay-qa.azurewebsites.net\n1 < Request-Context: appId=cid-v1:a7a77847-2713-450f-9030-b350a2d54a28\n1 < X-Powered-By: ASP.NET\n1 < X-ARR-ClientCert: -----BEGIN%20CERTIFICATE-----%0AMIIEHDCCAgSgAwIBAgIUZIZBO0fb7VZ4KXrs01S4RYbWyJ8wDQYJKoZIhvcNAQEL%0ABQAwJTEjMCEGA1UEAwwacm9vdGNlcnQuY2JpYmxpYW4uaW50ZXJuYWwwHhcNMjUw%0AODEzMTMyNTU5WhcNMjgwODEyMTMyNTU5WjAnMSUwIwYDVQQDDBxjbGllbnRjZXJ0%0ALmNiaWJsaWFuLmludGVybmFsMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKC%0AAQEAskUDap6NmyYq8RT6F7z3DpZGQiflNQTvUT84TmxsKXEBRAkgINnkJqgKkd7f%0ASEybzqglQTbr4s41lCiPsy3X66qYjU2L%2Bojhni%2BOCVOX7n3JBYovL%2FqfMP3%2FkhZP%0AQIlK%2FQWPcrnl39fYkGOQv%2BYqoCGEPzGkib2m1Ma5Q1HOCKh1ErMjqTLGy%2ByJj6JY%0AiZvMx3YrJSvjUS0uKpNwxPtGyiexRfKsmR%2FHqPzRHa0iY%2B752KSgUedwJPv1Wod%2B%0AY9BMAMIdU25UtkUEsaOYtorGWDaZSn2Bl0LYmP87kjcYypnHx0jtPtUCXfVHrE6u%0AZnDRFYsZbeXylY3mJkyOL2DzZwIDAQABo0IwQDAdBgNVHQ4EFgQURPhJwTAcUWUp%0ArOqQO68P%2FbJoqjMwHwYDVR0jBBgwFoAU7GdlxoSeEXucEXhjadHRC9xzS0UwDQYJ%0AKoZIhvcNAQELBQADggIBAGTnlyF2n%2F6s9phYbO8V17niO0BXB62ToX6gPhcw9f3y%0AhMui6RnrM1oiHlBWqZquCqYJ5ETvYJE1RqvoqtGysxCnIj0OTJHV4WtF3SHsd1Tu%0ATg%2B%2FUnGivtBTDQxj9sbAtCaSYRBqPByP8jvSTDgXR1mgOrEGjr2PZdZSoKLj4OHi%0A9UCMJw7pJsyA4lbroKshQTYv5Ks5SqtJpdp0%2BUX0UUlbPJqXiadfbKdoXvEgcwbP%0ACqR9v7kGYmNxfaGLNGVrV%2BnLawIDmdYXJE%2F4WJh6sHfiZxEsE%2BB4PoKADrb1Eapt%0AnSdHUgRfc0i5f2lcmErnU8nCMO5TWdHFOgpYwTS8w17FhNFZpaSmyZKM7uHcUs7y%0AUbuiQtdXocfSSMf%2FeycBEU%2FHAVIWQEqY%2BbJdC0q%2FR%2BsESeBtXd4IEIxR0QfgscGk%0AJyCSFC8z%2FvCgrRsH5rePqKO7%2FLAsDTP4GIQNFNfF4Wh6bsPXuJmvvoMcnmy%2F58Wo%0AE0XaG8UPHVAeyEmhncdM32E7SJbR91aRr2CkV23OoUz%2BwKG2%2FuObHmAkuMkCbbcz%0AJQoC7DZg5FGw%2BZR7v1DIBct5QNJQ8bG%2FXGRxjWC6dU7jrGhOF1X%2B2YYcdx9XnwyM%0A9YPxUy5bVfMhIiKP2wEso5fjOZ4RTvnB5R6zD3maJK%2FtZAXVhtyqXSkBYFi4MvEs%0A-----END%20CERTIFICATE-----%0A\n{\"GrpHdr\":{\"MsgId\":\"000020251022020374\",\"CreDtTm\":\"2025-10-22T14:15:08\",\"NbOfTxs\":1,\"SttlmInf\":{\"SttlmMtd\":\"INGA\"},\"InstgAgt\":{\"FinInstnId\":\"0205\"},\"InstdAgt\":{\"FinInstnId\":\"0205\"},\"Mge\":{\"Type\":\"acmt.998.322.001\"},\"ChnlId\":\"QR\"},\"CdtTrfTxInf\":{\"OrgnGrpInf\":{\"OrgnlMsgId\":\"02052025102282355753137\",\"OrgnlMgeType\":\"acmt.998.321.01\",\"OrgnlCreDtTm\":\"2025-10-22T14:15:15\"},\"TxSts\":\"ERR\",\"Rsn\":{\"RsnCd\":\"9000\",\"AddtlInf\":\"El canal de origen de la transacción enviado no es correcto.\"},\"SttlmDt\":\"2025-10-22\"}}\n\n"},{"result":{"nanos":0,"errorMessage":"no step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:410","millis":0.0,"status":"failed"},"step":{"line":410,"prefix":"Then","index":7,"text":"match responseStatus in normalizedStatus"},"stepLog":"14:15:17.388 classpath:Transferencia.feature:410\nThen match responseStatus in normalizedStatus\nno step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:410\n"},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":411,"prefix":"*","index":8,"text":"eval verifyTransferOutcome(response, expectation)"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":412,"prefix":"*","index":9,"text":"eval logTransferSummary('Receptor desafiliado', payload, response, responseStatus)"}}],"line":402,"description":"","durationMillis":1952.6465,"failed":true,"error":"no step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:410","tags":["transferencia"],"executorName":"main","name":"Transferencia no exitosa mediante QR, cuenta receptora desafiliada en el directorio","startTime":1761160515425,"refId":"[21:402]","endTime":1761160517388,"exampleIndex":-1},{"sectionIndex":21,"stepResults":[{"result":{"nanos":3420500,"millis":3.4205,"status":"passed"},"step":{"background":true,"line":5,"prefix":"*","index":0,"text":"def tokenContext = callonce read('classpath:helpers\/generate-token.feature')"},"stepLog":"14:15:17.405 key store key count for classpath:certificado\/clientcert.cbiblian.internal 1.pfx: 1\n"},{"result":{"nanos":271300,"millis":0.2713,"status":"passed"},"step":{"background":true,"line":6,"prefix":"*","index":1,"text":"def tokenData = tokenContext.tokenInfo"}},{"result":{"nanos":397200,"millis":0.3972,"status":"passed"},"step":{"background":true,"line":7,"prefix":"*","index":2,"text":"def transferenciaBaseUrl = karate.properties['transfer.baseUrl'] || 'https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral'"}},{"result":{"nanos":60000,"millis":0.06,"status":"passed"},"step":{"background":true,"line":8,"prefix":"*","index":3,"text":"url transferenciaBaseUrl"}},{"result":{"nanos":292800,"millis":0.2928,"status":"passed"},"step":{"background":true,"line":9,"prefix":"*","index":4,"text":"def authHeaders = { 'Content-Type': 'application\/json' }"}},{"result":{"nanos":701100,"millis":0.7011,"status":"passed"},"step":{"background":true,"line":10,"prefix":"*","index":5,"text":"set authHeaders.Authorization = 'Bearer ' + tokenData.auth_tokencb"}},{"result":{"nanos":50200,"millis":0.0502,"status":"passed"},"step":{"background":true,"line":11,"prefix":"*","index":6,"text":"configure headers = authHeaders"}},{"result":{"nanos":156700,"millis":0.1567,"status":"passed"},"step":{"endLine":24,"background":true,"line":12,"prefix":"*","docString":"{\n  \"0205\": {\n    \"CTA_AHORROS\": \"EC5002051000000000020501052673\",\n    \"CTA_CORRIENTE\": \"EC0402051000000000020101002318\"\n  },\n  \"0303\": {\n    \"CTA_AHORROS\": \"EC5003031000000000030301051111\",\n    \"CTA_CORRIENTE\": \"EC0403031000000000030101002222\"\n  }\n}","index":7,"text":"def accountCatalog ="}},{"result":{"nanos":193900,"millis":0.1939,"status":"passed"},"step":{"endLine":39,"background":true,"line":25,"prefix":"*","docString":"function(value){\n  var list;\n  if (!value && value !== 0){\n    list = [200];\n  } else {\n    list = Array.isArray(value) ? value.slice(0) : [value];\n  }\n  if (list.indexOf(200) === -1){\n    list.push(200);\n  }\n  return list;\n}","index":8,"text":"def normalizeStatus ="}},{"result":{"nanos":199900,"millis":0.1999,"status":"passed"},"step":{"endLine":110,"background":true,"line":40,"prefix":"*","docString":"function(overrides){\n  overrides = overrides || {};\n  var token = karate.get('tokenData');\n  var catalog = karate.get('accountCatalog');\n  var LocalDateTime = Java.type('java.time.LocalDateTime');\n  var DateTimeFormatter = Java.type('java.time.format.DateTimeFormatter');\n  var timestamp = LocalDateTime.now().format(DateTimeFormatter.ofPattern(\"yyyy-MM-dd'T'HH:mm:ss\"));\n  var randomDigits = function(length){\n    var digits = '';\n    for (var i = 0; i < length; i++){\n      digits += Math.floor(Math.random() * 10);\n    }\n    return digits;\n  };\n  var coopCode = overrides.instgAgtFinInstId || token.coop_codecb || '0205';\n  var debtorType = overrides.debtorAccountType || 'CTA_AHORROS';\n  var creditorType = overrides.creditorAccountType || 'CTA_CORRIENTE';\n  var creditorEntity = overrides.creditorEntity || overrides.instdAgtFinInstId || coopCode;\n  var debtorAccounts = catalog[coopCode] || catalog['0205'];\n  var creditorAccounts = catalog[creditorEntity] || catalog['0303'];\n  var debtorIban = overrides.debtorIban || (debtorAccounts ? (debtorAccounts[debtorType] || debtorAccounts['CTA_AHORROS']) : 'EC5002051000000000020501052673');\n  var creditorIban = overrides.creditorIban || (creditorAccounts ? (creditorAccounts[creditorType] || creditorAccounts['CTA_CORRIENTE']) : 'EC0403031000000000030101002222');\n  if (overrides.sameIban){\n    creditorIban = debtorIban;\n  }\n  var msgId = overrides.msgId || (coopCode + token.currentDate + randomDigits(11));\n  var endToEndId = overrides.endToEndId || (coopCode + token.currentDate + randomDigits(5));\n  var amountValue = overrides.amount != null ? overrides.amount : 1.00;\n  var payload = {\n    GrpHdr: {\n      msgId: msgId,\n      creDtTm: timestamp,\n      nbOfTxs: overrides.nbOfTxs || 1,\n      sttlmInf: { sttlmMtd: overrides.settlementMethod || 'INGA' },\n      instgAgt: { finInstnId: coopCode },\n      InstdAgt: { FinInstnId: overrides.instdAgtFinInstId || creditorEntity },\n      Mge: { Type: overrides.messageType || 'acmt.998.321.01' },\n      ChnlId: overrides.channel || 'APP'\n    },\n    CdtTrfTxInf: {\n      PmtId: { EndToEndId: endToEndId },\n      IntrBkSttlmAmt: { Amt: amountValue, Ccy: overrides.currency || 'USD' },\n      DbtrAcctId: { IBAN: debtorIban },\n      CdtrAcctId: { IBAN: creditorIban },\n      Prtry: {\n        CustRef: overrides.customerReference || 'QA22',\n        ChanRef: overrides.channelReference || (overrides.channel === 'QR' ? 'QRPANAPAY' : 'TERM001'),\n        AgtRef: overrides.agentReference || 'AGT0002'\n      }\n    }\n  };\n  if (overrides.prtryOverrides){\n    Object.keys(overrides.prtryOverrides).forEach(function(key){\n      payload.CdtTrfTxInf.Prtry[key] = overrides.prtryOverrides[key];\n    });\n  }\n  if (overrides.overrideHeaders){\n    payload.GrpHdr.instgAgt = overrides.overrideHeaders.instgAgt || payload.GrpHdr.instgAgt;\n    payload.GrpHdr.InstdAgt = overrides.overrideHeaders.instdAgt || payload.GrpHdr.InstdAgt;\n  }\n  return payload;\n}","index":9,"text":"def buildPayload ="}},{"result":{"nanos":148400,"millis":0.1484,"status":"passed"},"step":{"endLine":150,"background":true,"line":111,"prefix":"*","docString":"function(body, expectation){\n  expectation = expectation || {};\n  var txInfo = (body && body.CdtTrfTxInf) ? body.CdtTrfTxInf : {};\n  var outcome = expectation.outcome || 'success';\n  var requireTxOk = expectation.requireTxOk === true;\n  var requireTxReject = expectation.requireTxReject === true;\n  var expectedTxStatus = expectation.expectedTxStatus;\n  if (expectedTxStatus != null){\n    karate.match(txInfo.TxSts, expectedTxStatus);\n  } else if (outcome === 'success' && requireTxOk){\n    karate.match(txInfo.TxSts, 'Ok');\n  } else if (outcome === 'reject' && requireTxReject){\n    karate.match(txInfo.TxSts, '#? _ && _ != \"Ok\"');\n  } else {\n    if (txInfo && txInfo.TxSts){\n      karate.log('TxSts recibido:', txInfo.TxSts, '- no se valida estrictamente.');\n    } else {\n      karate.log('Sin TxSts en la respuesta, continuando sin validacion.');\n    }\n  }\n  if (outcome === 'pending'){\n    karate.match(txInfo.TxSts, '#? _ == \"PENDING\" || _ == \"PROC\"');\n  }\n  if (expectation.reasonCode){\n    var reasonNode = txInfo.Rsn || {};\n    karate.match(reasonNode.RsnCd, expectation.reasonCode);\n  }\n  if (expectation.expectedEndToEndId){\n    karate.match(txInfo.PmtId.EndToEndId, expectation.expectedEndToEndId);\n  }\n  if (expectation.expectedMsgId){\n    var grpHdr = (body && body.GrpHdr) ? body.GrpHdr : {};\n    karate.match(grpHdr.msgId, expectation.expectedMsgId);\n  }\n}","index":10,"text":"def verifyTransferOutcome ="}},{"result":{"nanos":91100,"millis":0.0911,"status":"passed"},"step":{"endLine":156,"background":true,"line":151,"prefix":"*","docString":"function(name, payload, responseBody, status){\n  karate.log('[Transfer]', name, '| status:', status, '| msgId:', payload.GrpHdr.msgId, '| endToEnd:', payload.CdtTrfTxInf.PmtId.EndToEndId);\n}","index":11,"text":"def logTransferSummary ="}},{"result":{"nanos":1832300,"millis":1.8323,"status":"passed"},"step":{"line":415,"prefix":"*","index":0,"text":"eval karate.log('Configurar la cuenta receptora en estado BLOQUEADO antes de la prueba.')"},"stepLog":"14:15:17.416 Configurar la cuenta receptora en estado BLOQUEADO antes de la prueba. \n"},{"result":{"nanos":7375200,"millis":7.3752,"status":"passed"},"step":{"line":416,"prefix":"*","index":1,"text":"def payload = buildPayload({ creditorAccountType: 'CTA_CORRIENTE', prtryOverrides: { CustRef: 'LOCKED-REC' } })"}},{"result":{"nanos":471500,"millis":0.4715,"status":"passed"},"step":{"line":417,"prefix":"*","index":2,"text":"def expectation = { httpStatus: [423, 409, 403], outcome: 'reject' }"}},{"result":{"nanos":982500,"millis":0.9825,"status":"passed"},"step":{"line":418,"prefix":"*","index":3,"text":"def normalizedStatus = normalizeStatus(expectation.httpStatus)"}},{"result":{"nanos":171800,"millis":0.1718,"status":"passed"},"step":{"line":419,"prefix":"Given","index":4,"text":"path 'finan', 'transferencia'"}},{"result":{"nanos":411500,"millis":0.4115,"status":"passed"},"step":{"line":420,"prefix":"And","index":5,"text":"request payload"}},{"result":{"nanos":5220455100,"millis":5220.4551,"status":"passed"},"step":{"line":421,"prefix":"When","index":6,"text":"method post"},"stepLog":"14:15:17.429 request:\n1 > POST https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral\/finan\/transferencia\n1 > Content-Type: application\/json; charset=UTF-8\n1 > Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2dUJWTkN6VlViUFBlTFdReEM0WDAyYVM3UnM2UGRYV1dja1dfc0xZMHlFIn0.eyJleHAiOjE3NjExNjA3NTAsImlhdCI6MTc2MTE2MDQ1MCwianRpIjoidHJydGNjOjQ5Yjg0NDVjLTgzYTAtMjI4Ni02NDczLWE2ZGEzOTBhOWQ0YSIsImlzcyI6Imh0dHBzOi8vYXV0ZW50aWNhY2lvbnFhLmNvb25lY3RhLmNvbS5lYy9hdXRoL3JlYWxtcy9QQU5BUEFZIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6Ijk5OGMyZmUwLTJjOGYtNGQwNC1iZjExLWY1OWExZTM5ODg3MyIsInR5cCI6IkJlYXJlciIsImF6cCI6IjAyMDVjYiIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiLyoiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRlZmF1bHQtcm9sZXMtYWRtaW5wYW5hcGF5Iiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7IjAyMDVjYiI6eyJyb2xlcyI6WyJ1bWFfcHJvdGVjdGlvbiJdfSwiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJjbGllbnRIb3N0IjoiMTAuMTAuMTAuMTUxIiwicHJlZmVycmVkX3VzZXJuYW1lIjoic2VydmljZS1hY2NvdW50LTAyMDVjYiIsImNsaWVudEFkZHJlc3MiOiIxMC4xMC4xMC4xNTEiLCJjbGllbnRfaWQiOiIwMjA1Y2IifQ.bATUogohrEqy7Voa4mFnsBzOnGy6tnjZGh_lOYRn-0hWXMY_fz-280nTu2Vv68eO3HeoewtWlt45S_iLI2-ml3pqpAlt3DXWVmLvVHw6d7TICHBfQsa0jGXMexKnyar7EinrVhF3deSK25Ap_ajC_82EvVvXrVG-7p9F1dEdq39y2R72JympejF5uhY_z_jNmqJSsnLEZVOo3WMJn76u9tTcYVIldC5uWGFWbPGEhvWPx4ZGpsuq_wrPOGdRmyJDFJPJl7LnLGHK0DBhuVtJUq_NFQkMus2fTTf_mWhRnoqNU-wUCS-fxMs6QusGzIVd-C3O29J3rerHTrGg21LAsQ\n1 > Content-Length: 517\n1 > Host: apipanapayqa.coonecta.com.ec\n1 > Connection: Keep-Alive\n1 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/17.0.12)\n1 > Accept-Encoding: gzip,deflate\n{\"GrpHdr\":{\"msgId\":\"02052025102234215767818\",\"creDtTm\":\"2025-10-22T14:15:17\",\"nbOfTxs\":1,\"sttlmInf\":{\"sttlmMtd\":\"INGA\"},\"instgAgt\":{\"finInstnId\":\"0205\"},\"InstdAgt\":{\"FinInstnId\":\"0205\"},\"Mge\":{\"Type\":\"acmt.998.321.01\"},\"ChnlId\":\"APP\"},\"CdtTrfTxInf\":{\"PmtId\":{\"EndToEndId\":\"02052025102227331\"},\"IntrBkSttlmAmt\":{\"Amt\":1.0,\"Ccy\":\"USD\"},\"DbtrAcctId\":{\"IBAN\":\"EC5002051000000000020501052673\"},\"CdtrAcctId\":{\"IBAN\":\"EC0402051000000000020101002318\"},\"Prtry\":{\"CustRef\":\"LOCKED-REC\",\"ChanRef\":\"TERM001\",\"AgtRef\":\"AGT0002\"}}}\n\n14:15:22.644 response time in milliseconds: 5120\n1 < 200\n1 < Date: Wed, 22 Oct 2025 19:15:14 GMT\n1 < Content-Type: application\/json; charset=utf-8\n1 < Transfer-Encoding: chunked\n1 < Connection: keep-alive\n1 < Server: Kestrel\n1 < Set-Cookie: ARRAffinity=135f536e0d078a815c3b83fda3468ab8a3a2abc604a35eefb28648d3961cfa9b;Path=\/;HttpOnly;Secure;Domain=app-apipanapay-qa.azurewebsites.net\n1 < Set-Cookie: ARRAffinitySameSite=135f536e0d078a815c3b83fda3468ab8a3a2abc604a35eefb28648d3961cfa9b;Path=\/;HttpOnly;SameSite=None;Secure;Domain=app-apipanapay-qa.azurewebsites.net\n1 < Vary: Accept-Encoding\n1 < Request-Context: appId=cid-v1:a7a77847-2713-450f-9030-b350a2d54a28\n1 < X-Powered-By: ASP.NET\n1 < X-ARR-ClientCert: -----BEGIN%20CERTIFICATE-----%0AMIIEHDCCAgSgAwIBAgIUZIZBO0fb7VZ4KXrs01S4RYbWyJ8wDQYJKoZIhvcNAQEL%0ABQAwJTEjMCEGA1UEAwwacm9vdGNlcnQuY2JpYmxpYW4uaW50ZXJuYWwwHhcNMjUw%0AODEzMTMyNTU5WhcNMjgwODEyMTMyNTU5WjAnMSUwIwYDVQQDDBxjbGllbnRjZXJ0%0ALmNiaWJsaWFuLmludGVybmFsMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKC%0AAQEAskUDap6NmyYq8RT6F7z3DpZGQiflNQTvUT84TmxsKXEBRAkgINnkJqgKkd7f%0ASEybzqglQTbr4s41lCiPsy3X66qYjU2L%2Bojhni%2BOCVOX7n3JBYovL%2FqfMP3%2FkhZP%0AQIlK%2FQWPcrnl39fYkGOQv%2BYqoCGEPzGkib2m1Ma5Q1HOCKh1ErMjqTLGy%2ByJj6JY%0AiZvMx3YrJSvjUS0uKpNwxPtGyiexRfKsmR%2FHqPzRHa0iY%2B752KSgUedwJPv1Wod%2B%0AY9BMAMIdU25UtkUEsaOYtorGWDaZSn2Bl0LYmP87kjcYypnHx0jtPtUCXfVHrE6u%0AZnDRFYsZbeXylY3mJkyOL2DzZwIDAQABo0IwQDAdBgNVHQ4EFgQURPhJwTAcUWUp%0ArOqQO68P%2FbJoqjMwHwYDVR0jBBgwFoAU7GdlxoSeEXucEXhjadHRC9xzS0UwDQYJ%0AKoZIhvcNAQELBQADggIBAGTnlyF2n%2F6s9phYbO8V17niO0BXB62ToX6gPhcw9f3y%0AhMui6RnrM1oiHlBWqZquCqYJ5ETvYJE1RqvoqtGysxCnIj0OTJHV4WtF3SHsd1Tu%0ATg%2B%2FUnGivtBTDQxj9sbAtCaSYRBqPByP8jvSTDgXR1mgOrEGjr2PZdZSoKLj4OHi%0A9UCMJw7pJsyA4lbroKshQTYv5Ks5SqtJpdp0%2BUX0UUlbPJqXiadfbKdoXvEgcwbP%0ACqR9v7kGYmNxfaGLNGVrV%2BnLawIDmdYXJE%2F4WJh6sHfiZxEsE%2BB4PoKADrb1Eapt%0AnSdHUgRfc0i5f2lcmErnU8nCMO5TWdHFOgpYwTS8w17FhNFZpaSmyZKM7uHcUs7y%0AUbuiQtdXocfSSMf%2FeycBEU%2FHAVIWQEqY%2BbJdC0q%2FR%2BsESeBtXd4IEIxR0QfgscGk%0AJyCSFC8z%2FvCgrRsH5rePqKO7%2FLAsDTP4GIQNFNfF4Wh6bsPXuJmvvoMcnmy%2F58Wo%0AE0XaG8UPHVAeyEmhncdM32E7SJbR91aRr2CkV23OoUz%2BwKG2%2FuObHmAkuMkCbbcz%0AJQoC7DZg5FGw%2BZR7v1DIBct5QNJQ8bG%2FXGRxjWC6dU7jrGhOF1X%2B2YYcdx9XnwyM%0A9YPxUy5bVfMhIiKP2wEso5fjOZ4RTvnB5R6zD3maJK%2FtZAXVhtyqXSkBYFi4MvEs%0A-----END%20CERTIFICATE-----%0A\n{\"GrpHdr\":{\"MsgId\":\"000020251022020375\",\"CreDtTm\":\"2025-10-22T14:15:11\",\"NbOfTxs\":1,\"SttlmInf\":{\"SttlmMtd\":\"INGA\"},\"InstgAgt\":{\"FinInstnId\":\"0205\"},\"InstdAgt\":{\"FinInstnId\":\"0205\"},\"Mge\":{\"Type\":\"acmt.998.322.001\"},\"ChnlId\":\"APP\"},\"CdtTrfTxInf\":{\"OrgnGrpInf\":{\"OrgnlMsgId\":\"02052025102234215767818\",\"OrgnlMgeType\":\"acmt.998.321.01\",\"OrgnlCreDtTm\":\"2025-10-22T14:15:17\"},\"PmtId\":{\"EndToEndId\":\"02052025102227331\",\"TxId\":\"18542\"},\"TxSts\":\"Ok\",\"Rsn\":{\"RsnCd\":\"0000\",\"AddtlInf\":\"Transacción Exitosa\"},\"Dbtr\":{\"AuthCode\":\"020520251022141513626737\"},\"Cdtr\":{\"AuthCode\":\"020520251022141514063107\"},\"SttlmDt\":\"2025-10-22\"}}\n\n"},{"result":{"nanos":0,"errorMessage":"no step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:422","millis":0.0,"status":"failed"},"step":{"line":422,"prefix":"Then","index":7,"text":"match responseStatus in normalizedStatus"},"stepLog":"14:15:22.644 classpath:Transferencia.feature:422\nThen match responseStatus in normalizedStatus\nno step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:422\n"},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":423,"prefix":"*","index":8,"text":"eval verifyTransferOutcome(response, expectation)"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":424,"prefix":"*","index":9,"text":"eval logTransferSummary('Receptor bloqueado', payload, response, responseStatus)"}}],"line":414,"description":"","durationMillis":5237.683,"failed":true,"error":"no step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:422","tags":["transferencia"],"executorName":"main","name":"Transferencia no exitosa, cuenta receptora bloqueada en el directorio","startTime":1761160517399,"refId":"[22:414]","endTime":1761160522644,"exampleIndex":-1},{"sectionIndex":22,"stepResults":[{"result":{"nanos":4354600,"millis":4.3546,"status":"passed"},"step":{"background":true,"line":5,"prefix":"*","index":0,"text":"def tokenContext = callonce read('classpath:helpers\/generate-token.feature')"},"stepLog":"14:15:22.665 key store key count for classpath:certificado\/clientcert.cbiblian.internal 1.pfx: 1\n"},{"result":{"nanos":258700,"millis":0.2587,"status":"passed"},"step":{"background":true,"line":6,"prefix":"*","index":1,"text":"def tokenData = tokenContext.tokenInfo"}},{"result":{"nanos":405200,"millis":0.4052,"status":"passed"},"step":{"background":true,"line":7,"prefix":"*","index":2,"text":"def transferenciaBaseUrl = karate.properties['transfer.baseUrl'] || 'https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral'"}},{"result":{"nanos":68800,"millis":0.0688,"status":"passed"},"step":{"background":true,"line":8,"prefix":"*","index":3,"text":"url transferenciaBaseUrl"}},{"result":{"nanos":293900,"millis":0.2939,"status":"passed"},"step":{"background":true,"line":9,"prefix":"*","index":4,"text":"def authHeaders = { 'Content-Type': 'application\/json' }"}},{"result":{"nanos":686800,"millis":0.6868,"status":"passed"},"step":{"background":true,"line":10,"prefix":"*","index":5,"text":"set authHeaders.Authorization = 'Bearer ' + tokenData.auth_tokencb"}},{"result":{"nanos":158400,"millis":0.1584,"status":"passed"},"step":{"background":true,"line":11,"prefix":"*","index":6,"text":"configure headers = authHeaders"}},{"result":{"nanos":191800,"millis":0.1918,"status":"passed"},"step":{"endLine":24,"background":true,"line":12,"prefix":"*","docString":"{\n  \"0205\": {\n    \"CTA_AHORROS\": \"EC5002051000000000020501052673\",\n    \"CTA_CORRIENTE\": \"EC0402051000000000020101002318\"\n  },\n  \"0303\": {\n    \"CTA_AHORROS\": \"EC5003031000000000030301051111\",\n    \"CTA_CORRIENTE\": \"EC0403031000000000030101002222\"\n  }\n}","index":7,"text":"def accountCatalog ="}},{"result":{"nanos":197700,"millis":0.1977,"status":"passed"},"step":{"endLine":39,"background":true,"line":25,"prefix":"*","docString":"function(value){\n  var list;\n  if (!value && value !== 0){\n    list = [200];\n  } else {\n    list = Array.isArray(value) ? value.slice(0) : [value];\n  }\n  if (list.indexOf(200) === -1){\n    list.push(200);\n  }\n  return list;\n}","index":8,"text":"def normalizeStatus ="}},{"result":{"nanos":286000,"millis":0.286,"status":"passed"},"step":{"endLine":110,"background":true,"line":40,"prefix":"*","docString":"function(overrides){\n  overrides = overrides || {};\n  var token = karate.get('tokenData');\n  var catalog = karate.get('accountCatalog');\n  var LocalDateTime = Java.type('java.time.LocalDateTime');\n  var DateTimeFormatter = Java.type('java.time.format.DateTimeFormatter');\n  var timestamp = LocalDateTime.now().format(DateTimeFormatter.ofPattern(\"yyyy-MM-dd'T'HH:mm:ss\"));\n  var randomDigits = function(length){\n    var digits = '';\n    for (var i = 0; i < length; i++){\n      digits += Math.floor(Math.random() * 10);\n    }\n    return digits;\n  };\n  var coopCode = overrides.instgAgtFinInstId || token.coop_codecb || '0205';\n  var debtorType = overrides.debtorAccountType || 'CTA_AHORROS';\n  var creditorType = overrides.creditorAccountType || 'CTA_CORRIENTE';\n  var creditorEntity = overrides.creditorEntity || overrides.instdAgtFinInstId || coopCode;\n  var debtorAccounts = catalog[coopCode] || catalog['0205'];\n  var creditorAccounts = catalog[creditorEntity] || catalog['0303'];\n  var debtorIban = overrides.debtorIban || (debtorAccounts ? (debtorAccounts[debtorType] || debtorAccounts['CTA_AHORROS']) : 'EC5002051000000000020501052673');\n  var creditorIban = overrides.creditorIban || (creditorAccounts ? (creditorAccounts[creditorType] || creditorAccounts['CTA_CORRIENTE']) : 'EC0403031000000000030101002222');\n  if (overrides.sameIban){\n    creditorIban = debtorIban;\n  }\n  var msgId = overrides.msgId || (coopCode + token.currentDate + randomDigits(11));\n  var endToEndId = overrides.endToEndId || (coopCode + token.currentDate + randomDigits(5));\n  var amountValue = overrides.amount != null ? overrides.amount : 1.00;\n  var payload = {\n    GrpHdr: {\n      msgId: msgId,\n      creDtTm: timestamp,\n      nbOfTxs: overrides.nbOfTxs || 1,\n      sttlmInf: { sttlmMtd: overrides.settlementMethod || 'INGA' },\n      instgAgt: { finInstnId: coopCode },\n      InstdAgt: { FinInstnId: overrides.instdAgtFinInstId || creditorEntity },\n      Mge: { Type: overrides.messageType || 'acmt.998.321.01' },\n      ChnlId: overrides.channel || 'APP'\n    },\n    CdtTrfTxInf: {\n      PmtId: { EndToEndId: endToEndId },\n      IntrBkSttlmAmt: { Amt: amountValue, Ccy: overrides.currency || 'USD' },\n      DbtrAcctId: { IBAN: debtorIban },\n      CdtrAcctId: { IBAN: creditorIban },\n      Prtry: {\n        CustRef: overrides.customerReference || 'QA22',\n        ChanRef: overrides.channelReference || (overrides.channel === 'QR' ? 'QRPANAPAY' : 'TERM001'),\n        AgtRef: overrides.agentReference || 'AGT0002'\n      }\n    }\n  };\n  if (overrides.prtryOverrides){\n    Object.keys(overrides.prtryOverrides).forEach(function(key){\n      payload.CdtTrfTxInf.Prtry[key] = overrides.prtryOverrides[key];\n    });\n  }\n  if (overrides.overrideHeaders){\n    payload.GrpHdr.instgAgt = overrides.overrideHeaders.instgAgt || payload.GrpHdr.instgAgt;\n    payload.GrpHdr.InstdAgt = overrides.overrideHeaders.instdAgt || payload.GrpHdr.InstdAgt;\n  }\n  return payload;\n}","index":9,"text":"def buildPayload ="}},{"result":{"nanos":169800,"millis":0.1698,"status":"passed"},"step":{"endLine":150,"background":true,"line":111,"prefix":"*","docString":"function(body, expectation){\n  expectation = expectation || {};\n  var txInfo = (body && body.CdtTrfTxInf) ? body.CdtTrfTxInf : {};\n  var outcome = expectation.outcome || 'success';\n  var requireTxOk = expectation.requireTxOk === true;\n  var requireTxReject = expectation.requireTxReject === true;\n  var expectedTxStatus = expectation.expectedTxStatus;\n  if (expectedTxStatus != null){\n    karate.match(txInfo.TxSts, expectedTxStatus);\n  } else if (outcome === 'success' && requireTxOk){\n    karate.match(txInfo.TxSts, 'Ok');\n  } else if (outcome === 'reject' && requireTxReject){\n    karate.match(txInfo.TxSts, '#? _ && _ != \"Ok\"');\n  } else {\n    if (txInfo && txInfo.TxSts){\n      karate.log('TxSts recibido:', txInfo.TxSts, '- no se valida estrictamente.');\n    } else {\n      karate.log('Sin TxSts en la respuesta, continuando sin validacion.');\n    }\n  }\n  if (outcome === 'pending'){\n    karate.match(txInfo.TxSts, '#? _ == \"PENDING\" || _ == \"PROC\"');\n  }\n  if (expectation.reasonCode){\n    var reasonNode = txInfo.Rsn || {};\n    karate.match(reasonNode.RsnCd, expectation.reasonCode);\n  }\n  if (expectation.expectedEndToEndId){\n    karate.match(txInfo.PmtId.EndToEndId, expectation.expectedEndToEndId);\n  }\n  if (expectation.expectedMsgId){\n    var grpHdr = (body && body.GrpHdr) ? body.GrpHdr : {};\n    karate.match(grpHdr.msgId, expectation.expectedMsgId);\n  }\n}","index":10,"text":"def verifyTransferOutcome ="}},{"result":{"nanos":111900,"millis":0.1119,"status":"passed"},"step":{"endLine":156,"background":true,"line":151,"prefix":"*","docString":"function(name, payload, responseBody, status){\n  karate.log('[Transfer]', name, '| status:', status, '| msgId:', payload.GrpHdr.msgId, '| endToEnd:', payload.CdtTrfTxInf.PmtId.EndToEndId);\n}","index":11,"text":"def logTransferSummary ="}},{"result":{"nanos":1402500,"millis":1.4025,"status":"passed"},"step":{"line":427,"prefix":"*","index":0,"text":"eval karate.log('Asegurar que la cuenta receptora esta DESBLOQUEADA antes de la prueba.')"},"stepLog":"14:15:22.680 Asegurar que la cuenta receptora esta DESBLOQUEADA antes de la prueba. \n"},{"result":{"nanos":4249800,"millis":4.2498,"status":"passed"},"step":{"line":428,"prefix":"*","index":1,"text":"def payload = buildPayload({ creditorAccountType: 'CTA_CORRIENTE', prtryOverrides: { CustRef: 'UNLOCK-REC' } })"}},{"result":{"nanos":267600,"millis":0.2676,"status":"passed"},"step":{"line":429,"prefix":"*","index":2,"text":"def expectation = { httpStatus: 200, outcome: 'success', expectedEndToEndId: payload.CdtTrfTxInf.PmtId.EndToEndId }"}},{"result":{"nanos":1194700,"millis":1.1947,"status":"passed"},"step":{"line":430,"prefix":"*","index":3,"text":"def normalizedStatus = normalizeStatus(expectation.httpStatus)"}},{"result":{"nanos":243600,"millis":0.2436,"status":"passed"},"step":{"line":431,"prefix":"Given","index":4,"text":"path 'finan', 'transferencia'"}},{"result":{"nanos":83800,"millis":0.0838,"status":"passed"},"step":{"line":432,"prefix":"And","index":5,"text":"request payload"}},{"result":{"nanos":3461416900,"millis":3461.4169,"status":"passed"},"step":{"line":433,"prefix":"When","index":6,"text":"method post"},"stepLog":"14:15:22.687 request:\n1 > POST https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral\/finan\/transferencia\n1 > Content-Type: application\/json; charset=UTF-8\n1 > Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2dUJWTkN6VlViUFBlTFdReEM0WDAyYVM3UnM2UGRYV1dja1dfc0xZMHlFIn0.eyJleHAiOjE3NjExNjA3NTAsImlhdCI6MTc2MTE2MDQ1MCwianRpIjoidHJydGNjOjQ5Yjg0NDVjLTgzYTAtMjI4Ni02NDczLWE2ZGEzOTBhOWQ0YSIsImlzcyI6Imh0dHBzOi8vYXV0ZW50aWNhY2lvbnFhLmNvb25lY3RhLmNvbS5lYy9hdXRoL3JlYWxtcy9QQU5BUEFZIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6Ijk5OGMyZmUwLTJjOGYtNGQwNC1iZjExLWY1OWExZTM5ODg3MyIsInR5cCI6IkJlYXJlciIsImF6cCI6IjAyMDVjYiIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiLyoiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRlZmF1bHQtcm9sZXMtYWRtaW5wYW5hcGF5Iiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7IjAyMDVjYiI6eyJyb2xlcyI6WyJ1bWFfcHJvdGVjdGlvbiJdfSwiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJjbGllbnRIb3N0IjoiMTAuMTAuMTAuMTUxIiwicHJlZmVycmVkX3VzZXJuYW1lIjoic2VydmljZS1hY2NvdW50LTAyMDVjYiIsImNsaWVudEFkZHJlc3MiOiIxMC4xMC4xMC4xNTEiLCJjbGllbnRfaWQiOiIwMjA1Y2IifQ.bATUogohrEqy7Voa4mFnsBzOnGy6tnjZGh_lOYRn-0hWXMY_fz-280nTu2Vv68eO3HeoewtWlt45S_iLI2-ml3pqpAlt3DXWVmLvVHw6d7TICHBfQsa0jGXMexKnyar7EinrVhF3deSK25Ap_ajC_82EvVvXrVG-7p9F1dEdq39y2R72JympejF5uhY_z_jNmqJSsnLEZVOo3WMJn76u9tTcYVIldC5uWGFWbPGEhvWPx4ZGpsuq_wrPOGdRmyJDFJPJl7LnLGHK0DBhuVtJUq_NFQkMus2fTTf_mWhRnoqNU-wUCS-fxMs6QusGzIVd-C3O29J3rerHTrGg21LAsQ\n1 > Content-Length: 517\n1 > Host: apipanapayqa.coonecta.com.ec\n1 > Connection: Keep-Alive\n1 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/17.0.12)\n1 > Accept-Encoding: gzip,deflate\n{\"GrpHdr\":{\"msgId\":\"02052025102235748785005\",\"creDtTm\":\"2025-10-22T14:15:22\",\"nbOfTxs\":1,\"sttlmInf\":{\"sttlmMtd\":\"INGA\"},\"instgAgt\":{\"finInstnId\":\"0205\"},\"InstdAgt\":{\"FinInstnId\":\"0205\"},\"Mge\":{\"Type\":\"acmt.998.321.01\"},\"ChnlId\":\"APP\"},\"CdtTrfTxInf\":{\"PmtId\":{\"EndToEndId\":\"02052025102272793\"},\"IntrBkSttlmAmt\":{\"Amt\":1.0,\"Ccy\":\"USD\"},\"DbtrAcctId\":{\"IBAN\":\"EC5002051000000000020501052673\"},\"CdtrAcctId\":{\"IBAN\":\"EC0402051000000000020101002318\"},\"Prtry\":{\"CustRef\":\"UNLOCK-REC\",\"ChanRef\":\"TERM001\",\"AgtRef\":\"AGT0002\"}}}\n\n14:15:26.146 response time in milliseconds: 3368\n1 < 200\n1 < Date: Wed, 22 Oct 2025 19:15:17 GMT\n1 < Content-Type: application\/json; charset=utf-8\n1 < Transfer-Encoding: chunked\n1 < Connection: keep-alive\n1 < Server: Kestrel\n1 < Set-Cookie: ARRAffinity=135f536e0d078a815c3b83fda3468ab8a3a2abc604a35eefb28648d3961cfa9b;Path=\/;HttpOnly;Secure;Domain=app-apipanapay-qa.azurewebsites.net\n1 < Set-Cookie: ARRAffinitySameSite=135f536e0d078a815c3b83fda3468ab8a3a2abc604a35eefb28648d3961cfa9b;Path=\/;HttpOnly;SameSite=None;Secure;Domain=app-apipanapay-qa.azurewebsites.net\n1 < Vary: Accept-Encoding\n1 < Request-Context: appId=cid-v1:a7a77847-2713-450f-9030-b350a2d54a28\n1 < X-Powered-By: ASP.NET\n1 < X-ARR-ClientCert: -----BEGIN%20CERTIFICATE-----%0AMIIEHDCCAgSgAwIBAgIUZIZBO0fb7VZ4KXrs01S4RYbWyJ8wDQYJKoZIhvcNAQEL%0ABQAwJTEjMCEGA1UEAwwacm9vdGNlcnQuY2JpYmxpYW4uaW50ZXJuYWwwHhcNMjUw%0AODEzMTMyNTU5WhcNMjgwODEyMTMyNTU5WjAnMSUwIwYDVQQDDBxjbGllbnRjZXJ0%0ALmNiaWJsaWFuLmludGVybmFsMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKC%0AAQEAskUDap6NmyYq8RT6F7z3DpZGQiflNQTvUT84TmxsKXEBRAkgINnkJqgKkd7f%0ASEybzqglQTbr4s41lCiPsy3X66qYjU2L%2Bojhni%2BOCVOX7n3JBYovL%2FqfMP3%2FkhZP%0AQIlK%2FQWPcrnl39fYkGOQv%2BYqoCGEPzGkib2m1Ma5Q1HOCKh1ErMjqTLGy%2ByJj6JY%0AiZvMx3YrJSvjUS0uKpNwxPtGyiexRfKsmR%2FHqPzRHa0iY%2B752KSgUedwJPv1Wod%2B%0AY9BMAMIdU25UtkUEsaOYtorGWDaZSn2Bl0LYmP87kjcYypnHx0jtPtUCXfVHrE6u%0AZnDRFYsZbeXylY3mJkyOL2DzZwIDAQABo0IwQDAdBgNVHQ4EFgQURPhJwTAcUWUp%0ArOqQO68P%2FbJoqjMwHwYDVR0jBBgwFoAU7GdlxoSeEXucEXhjadHRC9xzS0UwDQYJ%0AKoZIhvcNAQELBQADggIBAGTnlyF2n%2F6s9phYbO8V17niO0BXB62ToX6gPhcw9f3y%0AhMui6RnrM1oiHlBWqZquCqYJ5ETvYJE1RqvoqtGysxCnIj0OTJHV4WtF3SHsd1Tu%0ATg%2B%2FUnGivtBTDQxj9sbAtCaSYRBqPByP8jvSTDgXR1mgOrEGjr2PZdZSoKLj4OHi%0A9UCMJw7pJsyA4lbroKshQTYv5Ks5SqtJpdp0%2BUX0UUlbPJqXiadfbKdoXvEgcwbP%0ACqR9v7kGYmNxfaGLNGVrV%2BnLawIDmdYXJE%2F4WJh6sHfiZxEsE%2BB4PoKADrb1Eapt%0AnSdHUgRfc0i5f2lcmErnU8nCMO5TWdHFOgpYwTS8w17FhNFZpaSmyZKM7uHcUs7y%0AUbuiQtdXocfSSMf%2FeycBEU%2FHAVIWQEqY%2BbJdC0q%2FR%2BsESeBtXd4IEIxR0QfgscGk%0AJyCSFC8z%2FvCgrRsH5rePqKO7%2FLAsDTP4GIQNFNfF4Wh6bsPXuJmvvoMcnmy%2F58Wo%0AE0XaG8UPHVAeyEmhncdM32E7SJbR91aRr2CkV23OoUz%2BwKG2%2FuObHmAkuMkCbbcz%0AJQoC7DZg5FGw%2BZR7v1DIBct5QNJQ8bG%2FXGRxjWC6dU7jrGhOF1X%2B2YYcdx9XnwyM%0A9YPxUy5bVfMhIiKP2wEso5fjOZ4RTvnB5R6zD3maJK%2FtZAXVhtyqXSkBYFi4MvEs%0A-----END%20CERTIFICATE-----%0A\n{\"GrpHdr\":{\"MsgId\":\"000020251022020376\",\"CreDtTm\":\"2025-10-22T14:15:16\",\"NbOfTxs\":1,\"SttlmInf\":{\"SttlmMtd\":\"INGA\"},\"InstgAgt\":{\"FinInstnId\":\"0205\"},\"InstdAgt\":{\"FinInstnId\":\"0205\"},\"Mge\":{\"Type\":\"acmt.998.322.001\"},\"ChnlId\":\"APP\"},\"CdtTrfTxInf\":{\"OrgnGrpInf\":{\"OrgnlMsgId\":\"02052025102235748785005\",\"OrgnlMgeType\":\"acmt.998.321.01\",\"OrgnlCreDtTm\":\"2025-10-22T14:15:22\"},\"PmtId\":{\"EndToEndId\":\"02052025102272793\",\"TxId\":\"18543\"},\"TxSts\":\"Ok\",\"Rsn\":{\"RsnCd\":\"0000\",\"AddtlInf\":\"Transacción Exitosa\"},\"Dbtr\":{\"AuthCode\":\"020520251022141517206950\"},\"Cdtr\":{\"AuthCode\":\"020520251022141517652321\"},\"SttlmDt\":\"2025-10-22\"}}\n\n"},{"result":{"nanos":0,"errorMessage":"no step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:434","millis":0.0,"status":"failed"},"step":{"line":434,"prefix":"Then","index":7,"text":"match responseStatus in normalizedStatus"},"stepLog":"14:15:26.146 classpath:Transferencia.feature:434\nThen match responseStatus in normalizedStatus\nno step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:434\n"},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":435,"prefix":"*","index":8,"text":"eval verifyTransferOutcome(response, expectation)"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":436,"prefix":"*","index":9,"text":"eval logTransferSummary('Receptor desbloqueado', payload, response, responseStatus)"}}],"line":426,"description":"","durationMillis":3476.0425,"failed":true,"error":"no step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:434","tags":["transferencia"],"executorName":"main","name":"Transferencia exitosa, cuenta receptora desbloqueada en el directorio","startTime":1761160522660,"refId":"[23:426]","endTime":1761160526146,"exampleIndex":-1},{"sectionIndex":23,"stepResults":[{"result":{"nanos":5211800,"millis":5.2118,"status":"passed"},"step":{"background":true,"line":5,"prefix":"*","index":0,"text":"def tokenContext = callonce read('classpath:helpers\/generate-token.feature')"},"stepLog":"14:15:26.170 key store key count for classpath:certificado\/clientcert.cbiblian.internal 1.pfx: 1\n"},{"result":{"nanos":1438800,"millis":1.4388,"status":"passed"},"step":{"background":true,"line":6,"prefix":"*","index":1,"text":"def tokenData = tokenContext.tokenInfo"}},{"result":{"nanos":2296700,"millis":2.2967,"status":"passed"},"step":{"background":true,"line":7,"prefix":"*","index":2,"text":"def transferenciaBaseUrl = karate.properties['transfer.baseUrl'] || 'https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral'"}},{"result":{"nanos":226500,"millis":0.2265,"status":"passed"},"step":{"background":true,"line":8,"prefix":"*","index":3,"text":"url transferenciaBaseUrl"}},{"result":{"nanos":401400,"millis":0.4014,"status":"passed"},"step":{"background":true,"line":9,"prefix":"*","index":4,"text":"def authHeaders = { 'Content-Type': 'application\/json' }"}},{"result":{"nanos":2007700,"millis":2.0077,"status":"passed"},"step":{"background":true,"line":10,"prefix":"*","index":5,"text":"set authHeaders.Authorization = 'Bearer ' + tokenData.auth_tokencb"}},{"result":{"nanos":81200,"millis":0.0812,"status":"passed"},"step":{"background":true,"line":11,"prefix":"*","index":6,"text":"configure headers = authHeaders"}},{"result":{"nanos":210400,"millis":0.2104,"status":"passed"},"step":{"endLine":24,"background":true,"line":12,"prefix":"*","docString":"{\n  \"0205\": {\n    \"CTA_AHORROS\": \"EC5002051000000000020501052673\",\n    \"CTA_CORRIENTE\": \"EC0402051000000000020101002318\"\n  },\n  \"0303\": {\n    \"CTA_AHORROS\": \"EC5003031000000000030301051111\",\n    \"CTA_CORRIENTE\": \"EC0403031000000000030101002222\"\n  }\n}","index":7,"text":"def accountCatalog ="}},{"result":{"nanos":1998100,"millis":1.9981,"status":"passed"},"step":{"endLine":39,"background":true,"line":25,"prefix":"*","docString":"function(value){\n  var list;\n  if (!value && value !== 0){\n    list = [200];\n  } else {\n    list = Array.isArray(value) ? value.slice(0) : [value];\n  }\n  if (list.indexOf(200) === -1){\n    list.push(200);\n  }\n  return list;\n}","index":8,"text":"def normalizeStatus ="}},{"result":{"nanos":1013200,"millis":1.0132,"status":"passed"},"step":{"endLine":110,"background":true,"line":40,"prefix":"*","docString":"function(overrides){\n  overrides = overrides || {};\n  var token = karate.get('tokenData');\n  var catalog = karate.get('accountCatalog');\n  var LocalDateTime = Java.type('java.time.LocalDateTime');\n  var DateTimeFormatter = Java.type('java.time.format.DateTimeFormatter');\n  var timestamp = LocalDateTime.now().format(DateTimeFormatter.ofPattern(\"yyyy-MM-dd'T'HH:mm:ss\"));\n  var randomDigits = function(length){\n    var digits = '';\n    for (var i = 0; i < length; i++){\n      digits += Math.floor(Math.random() * 10);\n    }\n    return digits;\n  };\n  var coopCode = overrides.instgAgtFinInstId || token.coop_codecb || '0205';\n  var debtorType = overrides.debtorAccountType || 'CTA_AHORROS';\n  var creditorType = overrides.creditorAccountType || 'CTA_CORRIENTE';\n  var creditorEntity = overrides.creditorEntity || overrides.instdAgtFinInstId || coopCode;\n  var debtorAccounts = catalog[coopCode] || catalog['0205'];\n  var creditorAccounts = catalog[creditorEntity] || catalog['0303'];\n  var debtorIban = overrides.debtorIban || (debtorAccounts ? (debtorAccounts[debtorType] || debtorAccounts['CTA_AHORROS']) : 'EC5002051000000000020501052673');\n  var creditorIban = overrides.creditorIban || (creditorAccounts ? (creditorAccounts[creditorType] || creditorAccounts['CTA_CORRIENTE']) : 'EC0403031000000000030101002222');\n  if (overrides.sameIban){\n    creditorIban = debtorIban;\n  }\n  var msgId = overrides.msgId || (coopCode + token.currentDate + randomDigits(11));\n  var endToEndId = overrides.endToEndId || (coopCode + token.currentDate + randomDigits(5));\n  var amountValue = overrides.amount != null ? overrides.amount : 1.00;\n  var payload = {\n    GrpHdr: {\n      msgId: msgId,\n      creDtTm: timestamp,\n      nbOfTxs: overrides.nbOfTxs || 1,\n      sttlmInf: { sttlmMtd: overrides.settlementMethod || 'INGA' },\n      instgAgt: { finInstnId: coopCode },\n      InstdAgt: { FinInstnId: overrides.instdAgtFinInstId || creditorEntity },\n      Mge: { Type: overrides.messageType || 'acmt.998.321.01' },\n      ChnlId: overrides.channel || 'APP'\n    },\n    CdtTrfTxInf: {\n      PmtId: { EndToEndId: endToEndId },\n      IntrBkSttlmAmt: { Amt: amountValue, Ccy: overrides.currency || 'USD' },\n      DbtrAcctId: { IBAN: debtorIban },\n      CdtrAcctId: { IBAN: creditorIban },\n      Prtry: {\n        CustRef: overrides.customerReference || 'QA22',\n        ChanRef: overrides.channelReference || (overrides.channel === 'QR' ? 'QRPANAPAY' : 'TERM001'),\n        AgtRef: overrides.agentReference || 'AGT0002'\n      }\n    }\n  };\n  if (overrides.prtryOverrides){\n    Object.keys(overrides.prtryOverrides).forEach(function(key){\n      payload.CdtTrfTxInf.Prtry[key] = overrides.prtryOverrides[key];\n    });\n  }\n  if (overrides.overrideHeaders){\n    payload.GrpHdr.instgAgt = overrides.overrideHeaders.instgAgt || payload.GrpHdr.instgAgt;\n    payload.GrpHdr.InstdAgt = overrides.overrideHeaders.instdAgt || payload.GrpHdr.InstdAgt;\n  }\n  return payload;\n}","index":9,"text":"def buildPayload ="}},{"result":{"nanos":4452000,"millis":4.452,"status":"passed"},"step":{"endLine":150,"background":true,"line":111,"prefix":"*","docString":"function(body, expectation){\n  expectation = expectation || {};\n  var txInfo = (body && body.CdtTrfTxInf) ? body.CdtTrfTxInf : {};\n  var outcome = expectation.outcome || 'success';\n  var requireTxOk = expectation.requireTxOk === true;\n  var requireTxReject = expectation.requireTxReject === true;\n  var expectedTxStatus = expectation.expectedTxStatus;\n  if (expectedTxStatus != null){\n    karate.match(txInfo.TxSts, expectedTxStatus);\n  } else if (outcome === 'success' && requireTxOk){\n    karate.match(txInfo.TxSts, 'Ok');\n  } else if (outcome === 'reject' && requireTxReject){\n    karate.match(txInfo.TxSts, '#? _ && _ != \"Ok\"');\n  } else {\n    if (txInfo && txInfo.TxSts){\n      karate.log('TxSts recibido:', txInfo.TxSts, '- no se valida estrictamente.');\n    } else {\n      karate.log('Sin TxSts en la respuesta, continuando sin validacion.');\n    }\n  }\n  if (outcome === 'pending'){\n    karate.match(txInfo.TxSts, '#? _ == \"PENDING\" || _ == \"PROC\"');\n  }\n  if (expectation.reasonCode){\n    var reasonNode = txInfo.Rsn || {};\n    karate.match(reasonNode.RsnCd, expectation.reasonCode);\n  }\n  if (expectation.expectedEndToEndId){\n    karate.match(txInfo.PmtId.EndToEndId, expectation.expectedEndToEndId);\n  }\n  if (expectation.expectedMsgId){\n    var grpHdr = (body && body.GrpHdr) ? body.GrpHdr : {};\n    karate.match(grpHdr.msgId, expectation.expectedMsgId);\n  }\n}","index":10,"text":"def verifyTransferOutcome ="}},{"result":{"nanos":1446800,"millis":1.4468,"status":"passed"},"step":{"endLine":156,"background":true,"line":151,"prefix":"*","docString":"function(name, payload, responseBody, status){\n  karate.log('[Transfer]', name, '| status:', status, '| msgId:', payload.GrpHdr.msgId, '| endToEnd:', payload.CdtTrfTxInf.PmtId.EndToEndId);\n}","index":11,"text":"def logTransferSummary ="}},{"result":{"nanos":944200,"millis":0.9442,"status":"passed"},"step":{"line":439,"prefix":"*","index":0,"text":"eval karate.log('Simular caida del switch despues del debito para validar reverso.')"},"stepLog":"14:15:26.192 Simular caida del switch despues del debito para validar reverso. \n"},{"result":{"nanos":4986700,"millis":4.9867,"status":"passed"},"step":{"line":440,"prefix":"*","index":1,"text":"def payload = buildPayload({ prtryOverrides: { CustRef: 'SWITCH-DOWN' } })"}},{"result":{"nanos":520300,"millis":0.5203,"status":"passed"},"step":{"line":441,"prefix":"*","index":2,"text":"def expectation = { httpStatus: [502, 500, 409], outcome: 'pending' }"}},{"result":{"nanos":2619500,"millis":2.6195,"status":"passed"},"step":{"line":442,"prefix":"*","index":3,"text":"def normalizedStatus = normalizeStatus(expectation.httpStatus)"}},{"result":{"nanos":685100,"millis":0.6851,"status":"passed"},"step":{"line":443,"prefix":"Given","index":4,"text":"path 'finan', 'transferencia'"}},{"result":{"nanos":72100,"millis":0.0721,"status":"passed"},"step":{"line":444,"prefix":"And","index":5,"text":"request payload"}},{"result":{"nanos":3857630700,"millis":3857.6307,"status":"passed"},"step":{"line":445,"prefix":"When","index":6,"text":"method post"},"stepLog":"14:15:26.206 request:\n1 > POST https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral\/finan\/transferencia\n1 > Content-Type: application\/json; charset=UTF-8\n1 > Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2dUJWTkN6VlViUFBlTFdReEM0WDAyYVM3UnM2UGRYV1dja1dfc0xZMHlFIn0.eyJleHAiOjE3NjExNjA3NTAsImlhdCI6MTc2MTE2MDQ1MCwianRpIjoidHJydGNjOjQ5Yjg0NDVjLTgzYTAtMjI4Ni02NDczLWE2ZGEzOTBhOWQ0YSIsImlzcyI6Imh0dHBzOi8vYXV0ZW50aWNhY2lvbnFhLmNvb25lY3RhLmNvbS5lYy9hdXRoL3JlYWxtcy9QQU5BUEFZIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6Ijk5OGMyZmUwLTJjOGYtNGQwNC1iZjExLWY1OWExZTM5ODg3MyIsInR5cCI6IkJlYXJlciIsImF6cCI6IjAyMDVjYiIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiLyoiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRlZmF1bHQtcm9sZXMtYWRtaW5wYW5hcGF5Iiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7IjAyMDVjYiI6eyJyb2xlcyI6WyJ1bWFfcHJvdGVjdGlvbiJdfSwiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJjbGllbnRIb3N0IjoiMTAuMTAuMTAuMTUxIiwicHJlZmVycmVkX3VzZXJuYW1lIjoic2VydmljZS1hY2NvdW50LTAyMDVjYiIsImNsaWVudEFkZHJlc3MiOiIxMC4xMC4xMC4xNTEiLCJjbGllbnRfaWQiOiIwMjA1Y2IifQ.bATUogohrEqy7Voa4mFnsBzOnGy6tnjZGh_lOYRn-0hWXMY_fz-280nTu2Vv68eO3HeoewtWlt45S_iLI2-ml3pqpAlt3DXWVmLvVHw6d7TICHBfQsa0jGXMexKnyar7EinrVhF3deSK25Ap_ajC_82EvVvXrVG-7p9F1dEdq39y2R72JympejF5uhY_z_jNmqJSsnLEZVOo3WMJn76u9tTcYVIldC5uWGFWbPGEhvWPx4ZGpsuq_wrPOGdRmyJDFJPJl7LnLGHK0DBhuVtJUq_NFQkMus2fTTf_mWhRnoqNU-wUCS-fxMs6QusGzIVd-C3O29J3rerHTrGg21LAsQ\n1 > Content-Length: 518\n1 > Host: apipanapayqa.coonecta.com.ec\n1 > Connection: Keep-Alive\n1 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/17.0.12)\n1 > Accept-Encoding: gzip,deflate\n{\"GrpHdr\":{\"msgId\":\"02052025102251904687427\",\"creDtTm\":\"2025-10-22T14:15:26\",\"nbOfTxs\":1,\"sttlmInf\":{\"sttlmMtd\":\"INGA\"},\"instgAgt\":{\"finInstnId\":\"0205\"},\"InstdAgt\":{\"FinInstnId\":\"0205\"},\"Mge\":{\"Type\":\"acmt.998.321.01\"},\"ChnlId\":\"APP\"},\"CdtTrfTxInf\":{\"PmtId\":{\"EndToEndId\":\"02052025102246781\"},\"IntrBkSttlmAmt\":{\"Amt\":1.0,\"Ccy\":\"USD\"},\"DbtrAcctId\":{\"IBAN\":\"EC5002051000000000020501052673\"},\"CdtrAcctId\":{\"IBAN\":\"EC0402051000000000020101002318\"},\"Prtry\":{\"CustRef\":\"SWITCH-DOWN\",\"ChanRef\":\"TERM001\",\"AgtRef\":\"AGT0002\"}}}\n\n14:15:30.063 response time in milliseconds: 3763\n1 < 200\n1 < Date: Wed, 22 Oct 2025 19:15:22 GMT\n1 < Content-Type: application\/json; charset=utf-8\n1 < Transfer-Encoding: chunked\n1 < Connection: keep-alive\n1 < Server: Kestrel\n1 < Set-Cookie: ARRAffinity=135f536e0d078a815c3b83fda3468ab8a3a2abc604a35eefb28648d3961cfa9b;Path=\/;HttpOnly;Secure;Domain=app-apipanapay-qa.azurewebsites.net\n1 < Set-Cookie: ARRAffinitySameSite=135f536e0d078a815c3b83fda3468ab8a3a2abc604a35eefb28648d3961cfa9b;Path=\/;HttpOnly;SameSite=None;Secure;Domain=app-apipanapay-qa.azurewebsites.net\n1 < Vary: Accept-Encoding\n1 < Request-Context: appId=cid-v1:a7a77847-2713-450f-9030-b350a2d54a28\n1 < X-Powered-By: ASP.NET\n1 < X-ARR-ClientCert: -----BEGIN%20CERTIFICATE-----%0AMIIEHDCCAgSgAwIBAgIUZIZBO0fb7VZ4KXrs01S4RYbWyJ8wDQYJKoZIhvcNAQEL%0ABQAwJTEjMCEGA1UEAwwacm9vdGNlcnQuY2JpYmxpYW4uaW50ZXJuYWwwHhcNMjUw%0AODEzMTMyNTU5WhcNMjgwODEyMTMyNTU5WjAnMSUwIwYDVQQDDBxjbGllbnRjZXJ0%0ALmNiaWJsaWFuLmludGVybmFsMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKC%0AAQEAskUDap6NmyYq8RT6F7z3DpZGQiflNQTvUT84TmxsKXEBRAkgINnkJqgKkd7f%0ASEybzqglQTbr4s41lCiPsy3X66qYjU2L%2Bojhni%2BOCVOX7n3JBYovL%2FqfMP3%2FkhZP%0AQIlK%2FQWPcrnl39fYkGOQv%2BYqoCGEPzGkib2m1Ma5Q1HOCKh1ErMjqTLGy%2ByJj6JY%0AiZvMx3YrJSvjUS0uKpNwxPtGyiexRfKsmR%2FHqPzRHa0iY%2B752KSgUedwJPv1Wod%2B%0AY9BMAMIdU25UtkUEsaOYtorGWDaZSn2Bl0LYmP87kjcYypnHx0jtPtUCXfVHrE6u%0AZnDRFYsZbeXylY3mJkyOL2DzZwIDAQABo0IwQDAdBgNVHQ4EFgQURPhJwTAcUWUp%0ArOqQO68P%2FbJoqjMwHwYDVR0jBBgwFoAU7GdlxoSeEXucEXhjadHRC9xzS0UwDQYJ%0AKoZIhvcNAQELBQADggIBAGTnlyF2n%2F6s9phYbO8V17niO0BXB62ToX6gPhcw9f3y%0AhMui6RnrM1oiHlBWqZquCqYJ5ETvYJE1RqvoqtGysxCnIj0OTJHV4WtF3SHsd1Tu%0ATg%2B%2FUnGivtBTDQxj9sbAtCaSYRBqPByP8jvSTDgXR1mgOrEGjr2PZdZSoKLj4OHi%0A9UCMJw7pJsyA4lbroKshQTYv5Ks5SqtJpdp0%2BUX0UUlbPJqXiadfbKdoXvEgcwbP%0ACqR9v7kGYmNxfaGLNGVrV%2BnLawIDmdYXJE%2F4WJh6sHfiZxEsE%2BB4PoKADrb1Eapt%0AnSdHUgRfc0i5f2lcmErnU8nCMO5TWdHFOgpYwTS8w17FhNFZpaSmyZKM7uHcUs7y%0AUbuiQtdXocfSSMf%2FeycBEU%2FHAVIWQEqY%2BbJdC0q%2FR%2BsESeBtXd4IEIxR0QfgscGk%0AJyCSFC8z%2FvCgrRsH5rePqKO7%2FLAsDTP4GIQNFNfF4Wh6bsPXuJmvvoMcnmy%2F58Wo%0AE0XaG8UPHVAeyEmhncdM32E7SJbR91aRr2CkV23OoUz%2BwKG2%2FuObHmAkuMkCbbcz%0AJQoC7DZg5FGw%2BZR7v1DIBct5QNJQ8bG%2FXGRxjWC6dU7jrGhOF1X%2B2YYcdx9XnwyM%0A9YPxUy5bVfMhIiKP2wEso5fjOZ4RTvnB5R6zD3maJK%2FtZAXVhtyqXSkBYFi4MvEs%0A-----END%20CERTIFICATE-----%0A\n{\"GrpHdr\":{\"MsgId\":\"000020251022020377\",\"CreDtTm\":\"2025-10-22T14:15:19\",\"NbOfTxs\":1,\"SttlmInf\":{\"SttlmMtd\":\"INGA\"},\"InstgAgt\":{\"FinInstnId\":\"0205\"},\"InstdAgt\":{\"FinInstnId\":\"0205\"},\"Mge\":{\"Type\":\"acmt.998.322.001\"},\"ChnlId\":\"APP\"},\"CdtTrfTxInf\":{\"OrgnGrpInf\":{\"OrgnlMsgId\":\"02052025102251904687427\",\"OrgnlMgeType\":\"acmt.998.321.01\",\"OrgnlCreDtTm\":\"2025-10-22T14:15:26\"},\"PmtId\":{\"EndToEndId\":\"02052025102246781\",\"TxId\":\"18544\"},\"TxSts\":\"Ok\",\"Rsn\":{\"RsnCd\":\"0000\",\"AddtlInf\":\"Transacción Exitosa\"},\"Dbtr\":{\"AuthCode\":\"020520251022141520949713\"},\"Cdtr\":{\"AuthCode\":\"020520251022141521387553\"},\"SttlmDt\":\"2025-10-22\"}}\n\n"},{"result":{"nanos":0,"errorMessage":"no step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:446","millis":0.0,"status":"failed"},"step":{"line":446,"prefix":"Then","index":7,"text":"match responseStatus in normalizedStatus"},"stepLog":"14:15:30.063 classpath:Transferencia.feature:446\nThen match responseStatus in normalizedStatus\nno step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:446\n"},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":447,"prefix":"*","index":8,"text":"eval verifyTransferOutcome(response, expectation)"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":448,"prefix":"*","index":9,"text":"eval logTransferSummary('Switch detenido', payload, response, responseStatus)"}}],"line":438,"description":"","durationMillis":3888.2432,"failed":true,"error":"no step-definition method match found for: match responseStatus in normalizedStatus\nclasspath:Transferencia.feature:446","tags":["transferencia"],"executorName":"main","name":"Transferencia no exitosa, debito aplicado y switch detenido","startTime":1761160526158,"refId":"[24:438]","endTime":1761160530063,"exampleIndex":-1},{"sectionIndex":24,"stepResults":[{"result":{"nanos":3620000,"millis":3.62,"status":"passed"},"step":{"background":true,"line":5,"prefix":"*","index":0,"text":"def tokenContext = callonce read('classpath:helpers\/generate-token.feature')"},"stepLog":"14:15:30.088 key store key count for classpath:certificado\/clientcert.cbiblian.internal 1.pfx: 1\n"},{"result":{"nanos":264400,"millis":0.2644,"status":"passed"},"step":{"background":true,"line":6,"prefix":"*","index":1,"text":"def tokenData = tokenContext.tokenInfo"}},{"result":{"nanos":391800,"millis":0.3918,"status":"passed"},"step":{"background":true,"line":7,"prefix":"*","index":2,"text":"def transferenciaBaseUrl = karate.properties['transfer.baseUrl'] || 'https:\/\/apipanapayqa.coonecta.com.ec\/api\/switchcentral'"}},{"result":{"nanos":408200,"millis":0.4082,"status":"passed"},"step":{"background":true,"line":8,"prefix":"*","index":3,"text":"url transferenciaBaseUrl"}},{"result":{"nanos":317600,"millis":0.3176,"status":"passed"},"step":{"background":true,"line":9,"prefix":"*","index":4,"text":"def authHeaders = { 'Content-Type': 'application\/json' }"}},{"result":{"nanos":591400,"millis":0.5914,"status":"passed"},"step":{"background":true,"line":10,"prefix":"*","index":5,"text":"set authHeaders.Authorization = 'Bearer ' + tokenData.auth_tokencb"}},{"result":{"nanos":44400,"millis":0.0444,"status":"passed"},"step":{"background":true,"line":11,"prefix":"*","index":6,"text":"configure headers = authHeaders"}},{"result":{"nanos":243200,"millis":0.2432,"status":"passed"},"step":{"endLine":24,"background":true,"line":12,"prefix":"*","docString":"{\n  \"0205\": {\n    \"CTA_AHORROS\": \"EC5002051000000000020501052673\",\n    \"CTA_CORRIENTE\": \"EC0402051000000000020101002318\"\n  },\n  \"0303\": {\n    \"CTA_AHORROS\": \"EC5003031000000000030301051111\",\n    \"CTA_CORRIENTE\": \"EC0403031000000000030101002222\"\n  }\n}","index":7,"text":"def accountCatalog ="}},{"result":{"nanos":164100,"millis":0.1641,"status":"passed"},"step":{"endLine":39,"background":true,"line":25,"prefix":"*","docString":"function(value){\n  var list;\n  if (!value && value !== 0){\n    list = [200];\n  } else {\n    list = Array.isArray(value) ? value.slice(0) : [value];\n  }\n  if (list.indexOf(200) === -1){\n    list.push(200);\n  }\n  return list;\n}","index":8,"text":"def normalizeStatus ="}},{"result":{"nanos":326000,"millis":0.326,"status":"passed"},"step":{"endLine":110,"background":true,"line":40,"prefix":"*","docString":"function(overrides){\n  overrides = overrides || {};\n  var token = karate.get('tokenData');\n  var catalog = karate.get('accountCatalog');\n  var LocalDateTime = Java.type('java.time.LocalDateTime');\n  var DateTimeFormatter = Java.type('java.time.format.DateTimeFormatter');\n  var timestamp = LocalDateTime.now().format(DateTimeFormatter.ofPattern(\"yyyy-MM-dd'T'HH:mm:ss\"));\n  var randomDigits = function(length){\n    var digits = '';\n    for (var i = 0; i < length; i++){\n      digits += Math.floor(Math.random() * 10);\n    }\n    return digits;\n  };\n  var coopCode = overrides.instgAgtFinInstId || token.coop_codecb || '0205';\n  var debtorType = overrides.debtorAccountType || 'CTA_AHORROS';\n  var creditorType = overrides.creditorAccountType || 'CTA_CORRIENTE';\n  var creditorEntity = overrides.creditorEntity || overrides.instdAgtFinInstId || coopCode;\n  var debtorAccounts = catalog[coopCode] || catalog['0205'];\n  var creditorAccounts = catalog[creditorEntity] || catalog['0303'];\n  var debtorIban = overrides.debtorIban || (debtorAccounts ? (debtorAccounts[debtorType] || debtorAccounts['CTA_AHORROS']) : 'EC5002051000000000020501052673');\n  var creditorIban = overrides.creditorIban || (creditorAccounts ? (creditorAccounts[creditorType] || creditorAccounts['CTA_CORRIENTE']) : 'EC0403031000000000030101002222');\n  if (overrides.sameIban){\n    creditorIban = debtorIban;\n  }\n  var msgId = overrides.msgId || (coopCode + token.currentDate + randomDigits(11));\n  var endToEndId = overrides.endToEndId || (coopCode + token.currentDate + randomDigits(5));\n  var amountValue = overrides.amount != null ? overrides.amount : 1.00;\n  var payload = {\n    GrpHdr: {\n      msgId: msgId,\n      creDtTm: timestamp,\n      nbOfTxs: overrides.nbOfTxs || 1,\n      sttlmInf: { sttlmMtd: overrides.settlementMethod || 'INGA' },\n      instgAgt: { finInstnId: coopCode },\n      InstdAgt: { FinInstnId: overrides.instdAgtFinInstId || creditorEntity },\n      Mge: { Type: overrides.messageType || 'acmt.998.321.01' },\n      ChnlId: overrides.channel || 'APP'\n    },\n    CdtTrfTxInf: {\n      PmtId: { EndToEndId: endToEndId },\n      IntrBkSttlmAmt: { Amt: amountValue, Ccy: overrides.currency || 'USD' },\n      DbtrAcctId: { IBAN: debtorIban },\n      CdtrAcctId: { IBAN: creditorIban },\n      Prtry: {\n        CustRef: overrides.customerReference || 'QA22',\n        ChanRef: overrides.channelReference || (overrides.channel === 'QR' ? 'QRPANAPAY' : 'TERM001'),\n        AgtRef: overrides.agentReference || 'AGT0002'\n      }\n    }\n  };\n  if (overrides.prtryOverrides){\n    Object.keys(overrides.prtryOverrides).forEach(function(key){\n      payload.CdtTrfTxInf.Prtry[key] = overrides.prtryOverrides[key];\n    });\n  }\n  if (overrides.overrideHeaders){\n    payload.GrpHdr.instgAgt = overrides.overrideHeaders.instgAgt || payload.GrpHdr.instgAgt;\n    payload.GrpHdr.InstdAgt = overrides.overrideHeaders.instdAgt || payload.GrpHdr.InstdAgt;\n  }\n  return payload;\n}","index":9,"text":"def buildPayload ="}},{"result":{"nanos":132700,"millis":0.1327,"status":"passed"},"step":{"endLine":150,"background":true,"line":111,"prefix":"*","docString":"function(body, expectation){\n  expectation = expectation || {};\n  var txInfo = (body && body.CdtTrfTxInf) ? body.CdtTrfTxInf : {};\n  var outcome = expectation.outcome || 'success';\n  var requireTxOk = expectation.requireTxOk === true;\n  var requireTxReject = expectation.requireTxReject === true;\n  var expectedTxStatus = expectation.expectedTxStatus;\n  if (expectedTxStatus != null){\n    karate.match(txInfo.TxSts, expectedTxStatus);\n  } else if (outcome === 'success' && requireTxOk){\n    karate.match(txInfo.TxSts, 'Ok');\n  } else if (outcome === 'reject' && requireTxReject){\n    karate.match(txInfo.TxSts, '#? _ && _ != \"Ok\"');\n  } else {\n    if (txInfo && txInfo.TxSts){\n      karate.log('TxSts recibido:', txInfo.TxSts, '- no se valida estrictamente.');\n    } else {\n      karate.log('Sin TxSts en la respuesta, continuando sin validacion.');\n    }\n  }\n  if (outcome === 'pending'){\n    karate.match(txInfo.TxSts, '#? _ == \"PENDING\" || _ == \"PROC\"');\n  }\n  if (expectation.reasonCode){\n    var reasonNode = txInfo.Rsn || {};\n    karate.match(reasonNode.RsnCd, expectation.reasonCode);\n  }\n  if (expectation.expectedEndToEndId){\n    karate.match(txInfo.PmtId.EndToEndId, expectation.expectedEndToEndId);\n  }\n  if (expectation.expectedMsgId){\n    var grpHdr = (body && body.GrpHdr) ? body.GrpHdr : {};\n    karate.match(grpHdr.msgId, expectation.expectedMsgId);\n  }\n}","index":10,"text":"def verifyTransferOutcome ="}},{"result":{"nanos":87600,"millis":0.0876,"status":"passed"},"step":{"endLine":156,"background":true,"line":151,"prefix":"*","docString":"function(name, payload, responseBody, status){\n  karate.log('[Transfer]', name, '| status:', status, '| msgId:', payload.GrpHdr.msgId, '| endToEnd:', payload.CdtTrfTxInf.PmtId.EndToEndId);\n}","index":11,"text":"def logTransferSummary ="}},{"result":{"nanos":44638700,"errorMessage":"js failed:\n>>>>\n01: karate.clone(authHeaders)\n<<<<\norg.graalvm.polyglot.PolyglotException: TypeError: invokeMember (clone) on com.intuit.karate.core.ScenarioBridge failed due to: Unknown identifier: clone\n- <js>.:program(Unnamed:1)\n\nclasspath:Transferencia.feature:451","millis":44.6387,"status":"failed"},"step":{"line":451,"prefix":"*","index":0,"text":"def expiredHeaders = karate.clone(authHeaders)"},"stepLog":"14:15:30.137 classpath:Transferencia.feature:451\n* def expiredHeaders = karate.clone(authHeaders)\njs failed:\n>>>>\n01: karate.clone(authHeaders)\n<<<<\norg.graalvm.polyglot.PolyglotException: TypeError: invokeMember (clone) on com.intuit.karate.core.ScenarioBridge failed due to: Unknown identifier: clone\n- <js>.:program(Unnamed:1)\n\nclasspath:Transferencia.feature:451\n"},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":452,"prefix":"*","index":1,"text":"set expiredHeaders.Authorization = 'Bearer EXPIRED-' + tokenData.auth_tokencb"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":453,"prefix":"*","index":2,"text":"configure headers = expiredHeaders"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":454,"prefix":"*","index":3,"text":"def payload = buildPayload()"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":455,"prefix":"*","index":4,"text":"def expectation = { httpStatus: [401, 403], outcome: 'reject' }"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":456,"prefix":"*","index":5,"text":"def normalizedStatus = normalizeStatus(expectation.httpStatus)"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":457,"prefix":"Given","index":6,"text":"path 'finan', 'transferencia'"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":458,"prefix":"And","index":7,"text":"request payload"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":459,"prefix":"When","index":8,"text":"method post"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":460,"prefix":"Then","index":9,"text":"match responseStatus in normalizedStatus"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":461,"prefix":"*","index":10,"text":"configure headers = authHeaders"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":462,"prefix":"*","index":11,"text":"eval verifyTransferOutcome(response, expectation)"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":463,"prefix":"*","index":12,"text":"eval logTransferSummary('Token expirado', payload, response, responseStatus)"}}],"line":450,"description":"","durationMillis":51.2301,"failed":true,"error":"js failed:\n>>>>\n01: karate.clone(authHeaders)\n<<<<\norg.graalvm.polyglot.PolyglotException: TypeError: invokeMember (clone) on com.intuit.karate.core.ScenarioBridge failed due to: Unknown identifier: clone\n- <js>.:program(Unnamed:1)\n\nclasspath:Transferencia.feature:451","tags":["transferencia"],"executorName":"main","name":"Transferencia no exitosa, token caducado o expirado","startTime":1761160530080,"refId":"[25:450]","endTime":1761160530137,"exampleIndex":-1}],"callDepth":0,"name":"Transferencias financieras PANAPAY","description":"","resultDate":"2025-10-22 02:15:30 p. m.","durationMillis":73039.667,"passedCount":0}